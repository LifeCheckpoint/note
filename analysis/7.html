<!DOCTYPE html>
<html lang="zh-cn">

<head>

<title>定积分</title>
<meta charset="utf-8" />

<link rel="stylesheet" type="text/css" href="../css/note.css" />

</head>

<body>

<h2>实用的定积分公式</h2>

<ul>
	设下面的各个 `f` 在积分区间上有定义且可积.
	<li>反向积分. 作变元替换 `x = a+b-t`, 有
		<span class="formula">
			`int_a^b f(x) dx = int_a^b f(a+b-t) dt`.
		</span>
		这个公式的一个推论是, 对任意使得 `f(sin x), f(cos x)` 可积的函数
		`f`,
		<span class="formula">
			`int_0^(pi/2) f(sin x) dx = int_0^(pi/2) f(cos x) dx`.
		</span>
	</li>
	<li>如果 `f` 有对称轴 `x = u`, 即 `f(x) = f(2u-x)`,
		那么
		<span class="formula">
			`int_(u-a)^u f(x) dx = int_u^(u+a) f(x) dx`.
		</span>
		特别若 `f` 是偶函数, 则
		<span class="formula">
			`int_(-a)^a f(x) dx = 2 int_0^a f(x) dx`.
		</span>
		如果 `f` 关于 `x = (a+b)//2` 对称, 利用反向积分有
		<span class="formula">
			`int_a^b x f(x) dx`
			`= int_a^b (a+b-x) f(x) dx`
			`= (a+b)/2 int_a^b f(x) dx`.
		</span>
		例如
		<span class="formula">
			`int_0^pi x f(sin x) dx = pi/2 int_0^pi f(sin x) dx`.
		</span>
	</li>
	<li>如果 `f` 有对称中心 `(u, v)`, 即 `f(x) = 2v - f(2u-x)`,
		那么
		<span class="formula">
			`int_(u-a)^u f(x) dx + int_u^(u+a) f(x) dx = 2va`.
		</span>
		特别若 `f` 是奇函数, 则
		<span class="formula">
			`int_(-a)^a f(x) dx = 0`.
		</span>
	</li>
	<li>如果 `f` 是以 `T` 为周期的周期函数, 则对任意常数 `a`,
		<span class="formula">
			`int_a^(a+T) f(x) dx = int_0^T f(x) dx`.
		</span>
		且 `int_a^x f(t) dt` 以 `T` 为周期当且仅当 `int_0^T f(t) dt = 0`.
	</li>
</ul>

<ol class="proof">
	<li></li>
	<li></li>
	<li></li>
	<li>结论一: 由周期性,
		<span class="formula">
			`int_T^(a+T) f(x) dx`
			`= int_0^a f(y+T) dy`
			`= int_0^a f(y) dy`.
		</span>
		因此
		<span class="formula">
			`int_a^(a+T) = int_a^0 + int_0^T + int_T^(a+T)`
			`= int_a^0 + int_0^T + int_0^a`
			`= int_0^T`.
		</span>
		事实上, 若 `f` 连续, 则
		<span class="formula">
			`"d"/("d"a) int_a^(a+T) f(x) dx`
			`= f(a+T) - f(a) = 0`,
		</span>
		这说明 `int_a^(a+T) f(x) dx` 与 `a` 的取值无关.
		下证结论二.
		<span class="formula">
			`int_a^(x+T) f(t) dt = int_a^x f(t) dt`
			`iff int_x^(x+T) f(t) dt = 0`
			`iff int_0^T f(t) dt = 0`.
		</span>
	</li>
</ol>

<h2>杂例</h2>

<p class="example">`I = int_0^(pi/2) ln sin x dx = -pi/2 ln 2`.</p>

<p class="solution">
	先说明瑕积分的收敛性. 由于 `x to 0` 时 `ln sin x ~ ln x`, 而
	`int_0^(pi/2) |ln x| dx` 收敛, 故 `int_0^(pi/2) ln sin x dx` 也收敛.
	<br/>
	现在计算积分.
	由反向积分知 `I = int_0^(pi/2) ln cos t dt`.
	注意到 `[0, pi]` 是 `sin x` 的对称区间,
	所以又有 `int_0^pi ln sin x = 2I`.
	于是
	<span class="formula">
		`2I = int_0^(pi/2) (ln sin x + ln cos x) dx`
		`= 1/2 int_0^(pi/2) (ln sin 2x - ln 2) "d" (2x)`
		`= 1/2 int_0^(pi) ln sin x "d" x - pi/2 ln 2`
		`= I - pi/2 ln 2`,
	</span>
	故 `I = -pi/2 ln2`.
</p>

<ol class="example">
	<li>`I_1 = int dx / sqrt((a+x)(b-x))`;</li>
	<li>`I_2 = int_h^(R sin phi)
			arccos{: (x cot phi) / sqrt(R^2-x^2) :} dx`,
		`0 lt h lt R sin phi`, `phi in [0, pi/2)`;
	</li>
	<li>`I_3 = int sqrt((a^2x-b^2) / (1-x)) dx/x`;</li>
	<li>`I_4 = int_(h_1)^(r_2) arccos{: (h_2)/sqrt(R^2-x^2) :} dx`,
		其中 `R = sqrt(h_1^2 + r_1^2) = sqrt(h_2^2 + r_2^2)`.
	</li>
</ol>

<ol class="solution">
	<li>令 `t = sqrt((a+x)/(b-x))`,
		则 `x = (bt^2-a) / (1+t^2)`,
		`dx = (2(a+b)t) / (1+t^2)^2 dt`.  于是
		<span class="formula">
			`I_1 = int (2(a+b)t dt)/( t|b-(bt^2-a)/(1+t^2)| (1+t^2)^2 )`
			`= 2 sgn(a+b) int dt / (1+t^2)`
			`= 2 sgn(a+b) * arctan sqrt((a+x)/(b-x)) + C`.
		</span>
	</li>
	<li>令 `u = (x cot phi) / sqrt(R^2-x^2)`,
		则 `x = (Ru) / sqrt(u^2 + cot^2 phi)`.
		记 `r = sqrt(R^2 - h^2)`, 于是
		<span class="formula">
			`I_2 = [(Ru arccos u)/sqrt(u^2+cot^2 phi)]_((h cot phi)//r)^1
			+ R/2 int_((h cot phi)//r)^1 ("d"(u^2))
			/ sqrt( (cot^2 phi + u^2)(1-u^2) )`.
		</span>
		由 1,
		<span class="formula">
			`I_2 = -h arccos{: (h cot phi)/r :}
				+ R[ arctan sqrt((cot^2 phi + u^2) / (1-u^2)) ]
				_((h cot phi)//r)^1`
			`= - h arccos{: (h cot phi)/r :}
				+ R(pi/2-arctan{:(R cot phi) / sqrt(r^2-h^2 cot^2 phi):})`
			`= R arccos{: (R cos phi)/r :} - h arccos{: (h cot phi)/r :}`.
		</span>
	</li>
	<li>令 `t = sqrt((a^2x-b^2)/(1-x))`,
		则 `x = (b^2+t^2)/(a^2+t^2)`,
		`dx = (2t(a^2-b^2)) / (a^2+t^2)^2 dt`.  于是
		<span class="formula">
			`I_3 = int t * (a^2+t^2) / (b^2+t^2)
				* (2t(a^2-b^2)) / (a^2+t^2)^2 dt`
			`= 2 int ( a^2/(a^2 + t^2) - b^2 / (b^2 + t^2) ) dt`
			`= 2 ( a arctan{:t/a:} - b arctan{:t/b:} ) + C`.
		</span>
		再将 `t` 代回, 即得最终结果.
	</li>
	<li>令 `u = h_2/sqrt(R^2-x^2)`,
		则 `x = sqrt( R^2 - (h_2/u)^2 )`.  于是
		<span class="formula">
			`I_4 = [ sqrt( R^2 - (h_2/u)^2 ) arccos u ]_(h_2//r_1)^1
				+ int_(h_2//r_1)^1 sqrt( R^2 - (h_2/u)^2 )
				("d"u) / sqrt(1-u^2)`
			`=	- h_1 arccos {:h_2/r_1:}
				+ 1/2 int_(h_2//r_1)^1 sqrt( (R^2u^2 - h_2^2) / (1-u^2) )
				( "d"(u^2) ) / u^2`.
		</span>
		由 3 知, 上式第二项等于
		<span class="formula">
			`[R arctan{:1/R:} sqrt((R^2u^2 - h_2^2)/(1-u^2))
				- h_2 arctan{:1/h_2:}
				sqrt((R^2u^2 - h_2^2)/(1-u^2)) ]_(h_2//r_1)^1`
			`= pi/2 (R-h_2)
				- (R arctan{:(h_1 h_2)/(R sqrt(r_1^2 - h_2^2)):}
				- h_2 arctan{:h_1/sqrt(r_1^2 - h_2^2):} )`
			`= R arccos{:(h_1 h_2)/(r_1 r_2):} - h_2 arccos{:h_1/r_2:}`.
		</span>
		故
		<span class="formula">
			` I_4 = R arccos{:(h_1 h_2)/(r_1 r_2):}
			- h_1 arccos{:h_2/r_1:}
			- h_2 arccos{:h_1/r_2:}`.
		</span>
	</li>
</ol>

<p class="example">
	`int_0^(2pi) (1-cos t)^2 (t-sin t) dt`.
</p>

<p class="solution">
	因为不定积分 `int (1-cos t)^2 sin t dt` 的结果是 `cos t` 的多项式,
	周期是 `2pi`, 所以这一项在 `[0, 2pi]` 上的积分等于零.
	<span class="formula">
		原式 `= int_0^(2pi) (1-cos t)^2 t dt`
		`= int_0^(2pi) (2 sin^2{:t/2:})^2 t dt`
		`= 16 int_0^pi u sin^4 u "d" u`
		`= 16 int_0^pi (pi-u) sin^4 u "d"u`
		`= 8 pi int_0^pi sin^4 u "d"u`
		`= pi int_0^pi (3 - 4 cos 2u + cos 4 u) "d"u`
		`= 3 pi^2`.
	</span>
</p>

<h2>重要广义积分</h2>

<p class="example">
	<b>Poission 积分 (或 Euler-Poission 积分, 又称概率积分)</b>
	`int_(-oo)^(+oo) "e"^(-x^2) dx = sqrt pi`.
</p>

<p class="solution">
	利用重积分.  设 `D` 是圆心在原点, 半径为 `R` 的圆域,
	<span class="formula">
		`iint_D "e"^(-x^2-y^2) dx dy`
		` = iint_D rho "e"^(-rho^2) "d"rho "d"theta`
		` = int_0^(2pi) "d"theta int_0^R rho "e"^(-rho^2) "d"rho`
		` = pi(1 - "e"^(-R^2))`.
	</span>
	
	另一方面,
	<span class="formula">
		`iint_([-R,R]xx[-R,R]) "e"^(-x^2-y^2) dx dy`
		` = int_(-R)^R "e"^(-x^2) dx int_(-R)^R "e"^(-y^2) dy`
		` = (int_(-R)^R "e"^(-x^2) dx)^2`.
	</span>
	令 `R to +oo`, 得 `int_(-oo)^(+oo) "e"^(-x^2) dx = sqrt pi`.
</p>

<p class="solution">
	利用积分号下求导.
	<span class="formula">
		`"d"/dt int_(-oo)^(+oo) "e"^(-tx^2) dx`
		`= int_(-oo)^(+oo) -x^2 "e"^(-tx^2) dx`
	</span>
</p>

<p class="example">
	<b>Dirichlet 积分</b>
	`int_(-oo)^(+oo) (sin x)/x dx = pi`.
</p>

<h3>Euler 积分</h3>

<h4>第一类 Euler 积分: Beta 函数</h4>

<span class="formula">
	`B(x+1, y+1) = int_0^1 t^x (1-t)^y dt`.
</span>

<p class="property">
	`0`, `1` 是 Beta 函数积分的瑕点; `B(x, y)` 在 `x, y gt 0` 时收敛.
</p>

<p class="property">
	<b>对称性</b>
	作变元替换 `s = 1-t` 可得, `B(x, y) = B(y, x)`.
</p>

<p class="property">
	<b>递推公式</b>
	`B(x+1, y) = x/(x+y) B(x, y)`.
</p>

<p class="proof">
	分部积分,
	<span class="formula">
		`B(x+1, y) = -1/y t^x (1-t)^y |_0^1
		+ x/y int_0^1 (1-t)^y t^(x-1) dt`
		`= x/y (int_0^1 (1-t)^(y-1) t^(x-1) dt
		- int_0^1 (1-t)^(y-1) t^x dt)`
		`= x/y (B(x, y) - B(x+1, y))`.
	</span>
	移项整理即得结论.
</p>

<p class="corollary">
	`B(m+1, n+1) = (m! n!)/((m+n+1)!)`, `m, n` 是非负整数.
</p>

<ol class="property">
	<b>Beta 函数的其它形式</b>
	<li>令 `t = sin^2 theta`, 则
		`B(x, y) = 2 int_0^(pi//2) sin^(2x-1) theta
		cos^(2y-1) theta "d"theta`.
	</li>
	<li>令 `t = u/(1+u)`, 则 `B(x, y) = int_0^oo u^(x-1)/(1+u)^(x+y)
		"d"u`. 特别 `B(x, 1-x) = int_0^oo u^(x-1)/(1+u) "d"u`.
	</li>
	<li>由上一式得 `B(x, y) = int_0^1 u^(x-1)/(1+u)^(x+y) "d"u`
		`+ int_1^oo u^(x-1)/(1+u)^(x+y) "d"u`.
		对第二项积分作变换 `u = 1/v` 得
		`B(x, y) = int_0^1 (u^(x-1) + u^(y-1))/(1+u)^(x+y) "d"u`.
	</li>
</ol>

<p class="example">
	`I_n = int_0^(pi/2) sin^n x dx = int_0^(pi/2) cos^n x dx`
	`= 1/2 B((n+1)/2, 1/2)`
	`= {
		(n-1)/n * (n-3)/(n-2) * cdots * 1/2 * pi/2, if n " is even";
		(n-1)/n * (n-3)/(n-2) * cdots * 2/3 * 1, if n " is odd";
	:}`
	由此得到 Beta 函数在一些半整数点的取值.
</p>

<p class="solution">
	化为 Beta 函数:
	<span class="formula">
		`I_n` (令 `x = arcsin u`)
		`= int_0^1 u^n/sqrt(1 - u^2) "d"u \ ("let " u=sqrt v)`
		`= 1/2 int_0^1 v^(n/2 - 1/2) / sqrt(1-v) "d"v`
		`= 1/2 int_0^1 v^((n+1)/2 - 1) (1-v)^(1/2 - 1) "d"v`
		`= 1/2 B((n+1)/2, 1/2)`.
	</span>
	现在利用第 6 章的 <a href="6.html#exp-int-sin-n-x">例题</a>, 容易得到
	<span class="formula">
		`I_n = (n-1)/n I_(n-2)`.
	</span>
	易求得 `I_0 = pi/2`, `I_1 = 1`. 由递推公式马上得到上面的结论.
</p>

<h4>第二类 Euler 积分: Gamma 函数</h4>

<span class="formula">
	`Gamma(x+1) = int_0^oo "e"^-t t^x dt`.
</span>

<p class="property">
	`Gamma(x)` 在 `x gt 0` 时收敛, 可在积分号下求任意阶导数:
	<span class="formula">
		`Gamma^((n))(x+1) = int_0^oo "e"^-t t^x ln^n t dt`.
	</span>
</p>

<p class="property">
	<b>递推公式</b>
	`Gamma(x+1) = x Gamma(x)`.
</p>

<p class="proof">
	分部积分,
	<span class="formula">
		`Gamma(x+1) = int_0^oo "e"^-t t^x dt`
		`= -"e"^-t t^x|_0^oo + x int_0^oo "e"^-t t^(x-1) dt`
		`= x Gamma(x)`.
	</span>
</p>

<p class="corollary">
	`Gamma(n+1) = n!`, `n` 为非负整数.
</p>

<p class="corollary">
	令 `t = u^2` 得到 Gamma 函数的另一重要形式:
	<span class="formula">
		`Gamma(x) = 2 int_0^oo "e"^(-u^2) u^(2x-1) "d"u`.
	</span>
	利用 Poisson 积分知 `Gamma(1/2) = sqrt pi`, 再由递推公式可得 Gamma
	函数在半整数点的取值:
	<span class="formula">
		`Gamma((2n+1)/2) = ((2n-1)!!)/2^n sqrt pi`
		`= ((2n)!)/(4^n * n!) sqrt pi`.
	</span>
</p>

<table class="col2">
	<tr>
		<td>`x`</td>
		<td>`1/2`</td>
		<td>`3/2`</td>
		<td>`5/2`</td>
		<td>`7/2`</td>
	</tr>
	<tr>
		<td>`Gamma(x)//sqrt pi`</td>
		<td>`1`</td>
		<td>`1/2`</td>
		<td>`1/2 * 3/2`</td>
		<td>`1/2 * 3/2 * 5/2`</td>
	</tr>
</table>

<p class="example">
	`I_n = int_(-oo)^(+oo) "e"^(-x^2) x^n dx`
	`= { 0, if n" is odd"; Gamma((n+1)/2), if n" is even" :}`
</p>

<p class="solution">
	`n` 是奇数时, 被积函数为奇函数, 积分为零;
	`n` 是偶数时, 被积函数为偶函数, 利用 Gamma 函数的变化形式知
	`I_n = Gamma((n+1)/2)`.
	(也可以利用第 6 章的<a href="6.html#exp-possion-integral">这个例题</a>).
</p>

<p class="property">
	<b>两类 Euler 积分的联系 (Dirichlet 公式)</b>
	`B(x, y) = (Gamma(x)Gamma(y))/(Gamma(x+y))`.
</p>

<p class="proof">
	应用 Gamma 函数与 Beta 函数的变化形式, 并在极坐标下积分:
	<span class="formula">
		`Gamma(x) Gamma(y)`
		`= 4 int_0^oo "e"^(-u^2) u^(2x-1) "d"u
		int_0^oo "e"^(-v^2) v^(2y-1) "d"v`
		`= 4 int_0^oo int_0^oo "e"^-(u^2+v^2) u^(2x-1) v^(2y-1) "d"u"d"v`
		(令 `u = r cos theta`, `v = r sin theta`)
		`= 4 int_0^(pi//2) cos^(2x-1) theta sin^(2y-1) theta "d"theta`
		`int_0^oo "e"^(-r^2) r^(2x+2y-1) "d"r`
		`= B(x, y) Gamma(x+y)`.
	</span>
</p>

<p class="property">
	<b>极限表达式 (Euler 公式)</b>
	`Gamma(x) = lim_(n to oo) n^x B(x, n+1)`
	`= lim_(n to oo) (n^x (n-1)!)/(x(x+1) cdots (x+n-1))`.
</p>

<p class="proof">
	<span class="formula">
		`Gamma(x) = int_0^oo "e"^-t t^(x-1) dt`
		`= lim_(n to oo) int_0^n (1-t/n)^n t^(x-1) dt`
		`= lim_(n to oo) n^x int_0^1 (1-u)^n u^(x-1) "d"u`
		`= lim_(n to oo) n^x B(x, n+1)`.
	</span>
</p>

<p class="property">
	<b>余元公式</b>
	`Gamma(x) Gamma(1-x) = pi/(sin pi x)`.
</p>

<p class="proof">
	利用 Gamma 函数的极限表达式,
	<span class="formula">
		`Gamma(x) Gamma(1-x)`
		`= lim_(n to oo) n B(x, n+1) B(1-x, n+1)`
		`= lim_(n to oo) n ((n-1)!)/(prod_(k=0)^(n-1) (x+k))`
		`((n-1)!)/(prod_(k=1)^n (k-x))`
		`= x^-1 lim_(n to oo) n(n-x) prod_(k=1)^(n-1) (1+x/k)^-1`
		`prod_(k=1)^(n-1) (1-x/k)^-1`
		`= x^-1 prod_(n=1)^oo (1-x^2/n^2)^-1`.
	</span>
	利用 Euler 发现的等式
	<span class="formula">
		`(sin pi x)/(pi x) = prod_(n=1)^oo (1-x^2/n^2)`,
	</span>
	即得结论.
</p>

<p class="proof">
	<span class="formula">
		`Gamma(x) Gamma(1-x)`
		`= B(x, 1-x) Gamma(1)`
		`= int_0^oo u^(x-1)/(1+u) "d"u`.
	</span>
	???
</p>

<p class="property">
	<b>Legendre 倍角公式</b>
	`Gamma(x) Gamma(x+1/2) = (sqrt(2pi)) 4^-x Gamma(2x)`,<br/>
	`prod_(k=0)^(n-1) Gamma(x+k/n)`
	`= (2pi)^((n-1)/2) n^(-n x) Gamma(n x)`.
</p>

<script src="../js/note.js?type=math"></script>

</body>

</html>
