<!DOCTYPE html>
<html lang="zh-cn">

<head>

<title>递推式与生成函数</title>
<meta charset="utf-8" />

<link rel="stylesheet" type="text/css" href="../css/note.css" />

</head>

<body>

<h2>求解递推式</h2>

<h3>等差数列与等比数列</h3>

<p class="example">
	`x_1 = 2`, `x_n = 1/((n-1)!) + 1/n x_(n-1)`, `n gt 1`. 求 `x_n`
	通项公式.
</p>

<p class="solution">
	两边同乘以 `n!`,
	<span class="formula">
		`n! x_n = (n-1)! x_(n-1) + n`
		`= 1! x_1 + sum_(k=2)^n k`
		`= 2 + (n(n+1))/2 - 1`.
	</span>
	所以
	<span class="formula">
		`x_n = 1/(n!) (1 + (n(n+1))/2)`.
	</span>
</p>

<p class="example">
	`x_1 = 1`, `x_n = 1 + 2/n^2 sum_(k=1)^(n-1) k x_k`, `n gt 1`. 求 `x_n`
	通项公式.
</p>

<p class="solution">
	记 `S_n = sum_(k=1)^n k x_k`. 从递推式中解出
	<span class="formula">
		`S_(n-1) = n^2/2 (x_n - 1)`,
	</span>
	相减得
	<span class="formula">
		`2(n-1) x_(n-1) = 2(S_(n-1) - S_(n-2))`
		`= n^2 x_n - (n-1)^2 x_(n-1) - (n^2 - (n-1)^2)`.
	</span>
	即
	<span class="formula">
		`n^2 x_n = (n+1)(n-1) x_(n-1) + 2n - 1`.
	</span>
	两边同加 `n^2`, 再同除以 `n(n+1)`,
	<span class="formula">
		`n/(n+1) (x_n + 1) = (n-1)/n (x_(n-1) + 1) + 2/(n+1)`
		`= 1/2 (x_1 + 1) + sum_(k=2)^n 2/(k+1)`
		`= 2 sum_(k=1)^n 1/(k+1)`.
	</span>
	即
	<span class="formula">
		`x_n = 2(1+1/n) sum_(k=1)^n 1/(k+1) - 1`.
	</span>
</p>

<p class="example">
	对于非负整数 `m, n`, Ackermann 函数定义为
	<span class="formula">`A(m, n) = {
		(n+1, if m = 0),
		(A(m-1, 1), if m gt 0 and n = 0),
		(A(m-1, A(m, n-1)), if "else")
	:}`</span>
	试计算 `A(0, n)`, `A(1, n)`, `A(2, n)`, `A(3, n)` 的通项公式, 并求
	`A(4, 2)`.
</p>

<ol class="solution">
	<li>`A(0, n) = n+1`.</li>
	<li>`A(1, n) = A(0, A(1, n-1))`
		`= A(1, n-1) + 1`; 故 `A(1, n)` 为等差数列.
		利用 `A(1, 0) = A(0, 1) = 2` 有:
		<span class="formula">
			`A(1, n) = n+2`.
		</span>
	</li>
	<li>`A(2, n) = A(1, A(2, n-1))`
		`= A(2, n-1) + 2`; 故 `A(2, n)` 也为等差数列.
		利用 `A(2, 0) = A(1, 1) = 3` 有:
		<span class="formula">
			`A(2, n) = 2n + 3`.
		</span>
	</li>
	<li>`A(3, n) = A(2, A(3, n-1))`
		`= 2A(3, n-1) + 3`.
		设 `A(3, n) + c = 2(A(3, n-1) + c)`, 解得 `c = 3`.
		利用等比数列通项公式和 `A(3, 0) = A(2, 1) = 5` 有:
		<span class="formula">
			`A(3, n) = 2^(n+3) - 3`.
		</span>
	</li>
	<li>`A(4, 2) = A(3, A(4, 1))`
		`= A(3, A(3, A(4, 0)))`
		`= A(3, A(3, A(3, 1)))`
		`= A(3, A(3, 16-3))`
		`= A(3, 65536-3)`
		`= 2^65536-3`.
	</li>
</ol>

<h3>Fibonacci 数列</h3>

<p class="example">
	求 Fibonacci 数列
	<span class="formula">`f_n = {
		(0, if n = 0),
		(1, if n = 1),
		(f_(n-1) + f_(n-2){::}, if n ge 2)
	:}`</span>
	的通项公式.
</p>

<p class="solution">
	<b>待定系数法化为等差/等比数列</b>
	设
	<span class="formula">
		`f_n = (varphi + psi) f_(n-1) - varphi psi f_(n-2)`,
	</span>
	则 `varphi, psi` 应是方程 `x^2 - x - 1` 的两根, 不妨令
	`varphi, psi = (1 +- sqrt 5)//2`.
	上式变形得到
	<span class="formula">`{
		(f_n - varphi f_(n-1) = psi(f_(n-1) - varphi f_(n-2))),
		(f_n - psi f_(n-1) = varphi(f_(n-1) - psi f_(n-2)))
	:}`</span>
	于是 `{f_n - varphi f_(n-1)}`, `{f_n - psi f_(n-1)}` 皆为等比数列.
	由等比数列的通项公式有:
	<span class="formula">
		`f_n - varphi f_(n-1) = psi^(n-1) (f_1 - varphi f_0) =
		psi^(n-1)`,<br/>
		`f_n - psi f_(n-1) = varphi^(n-1) (f_1 - psi f_0) = varphi^(n-1)`.
	</span>
	注意 `varphi psi = -1`, 由上式得到
	<span class="formula">`{
		(psi f_n + f_(n-1) = psi^n),
		(varphi f_n + f_(n-1) = varphi^n)
	:}`</span>
	解得
	<span class="formula">
		`f_n = 1/sqrt 5 (varphi^n - psi^n)`.
	</span>
</p>

<p class="solution">
	<b>生成函数法</b>
	记 `F(x) = sum_(n=0)^oo f_n x^n`, 于是
	<span class="formula">
		`F(x) = 0 + x + sum_(n=2)^oo (f_(n-1) + f_(n-2)) x^n`
		`= x + sum_(n=1)^oo f_n x^(n+1) + sum_(n=0)^oo f_n x^(n+2)`
		`= x + x F(x) + x^2 F(x)`.
	</span>
	解得
	<span class="formula">
		`F(x) = x/(1-x-x^2)`.
	</span>
	记上式分母的两个零点的相反数为 `varphi, psi = (1 +- sqrt 5)//2`,
	则 `varphi psi = -1`.  通过分解分式,
	<span class="formula">
		`F(x) = 1/sqrt 5(psi/(x + psi) - varphi/(x + varphi))`
		`= 1/sqrt 5(1/(1-varphi x) - 1/(1-psi x))`
		`= 1/sqrt 5 sum_(n=0)^oo [(varphi x)^n - (psi x)^n]`.
	</span>
	于是
	<span class="formula">
		`f_n = 1/sqrt 5(varphi^n - psi^n)`.
	</span>
</p>

<p class="solution">
	<b>特征根法</b>
	将 `f_n = lambda^n` (`lambda != 0`) 代入递推公式, 得
	<span class="formula">
		`lambda^n = lambda^(n-1) + lambda^(n-2)`,
	</span>
	由 `lambda != 0`, 有
	<span class="formula">
		`lambda^2 = lambda + 1`.
	</span>
	这个二次方程的两根记为 `varphi, psi = (1 +- sqrt 5)//2`,
	由线性叠加原理, 该差分方程的通解为
	<span class="formula">
		`f_n = c_1 varphi^n + c_2 psi^n`.
	</span>
	再代入初值条件 `f_0 = 0`, `f_1 = 1`, 有
	<span class="formula">`{
		(c_1 + c_2 = 0),
		(varphi c_1 + psi c_2 = 1)
	:}`</span>
	解得
	<span class="formula">
		`c_1, c_2 = +- 1/sqrt 5`.
	</span>
	于是 Fibonacci 数列的通项公式是
	<span class="formula">
		`f_n = 1/sqrt 5 (varphi^n - psi^n)`.
	</span>
</p>

<p class="corollary">
	注意 `|psi|  = |1-sqrt 5|//2 lt 1`, 从而对 `n = 0, 1, 2...` 都成立
	`|psi^n/sqrt 5| lt 1/sqrt 5 lt 1/2`. 我们推出: `f_n` 等于最接近
	`varphi^n/sqrt 5` 的整数.
</p>

<p class="remark">
	`varphi = (1+sqrt 5)//2` 即是著名的黄金比例, 它定义为方程 `x^2 = 1 +
	x` 的正根.  利用通项公式容易计算, Fibonacci 数列前后项的比值
	`f_(n+1)//f_n` 的极限是 `varphi`, 因此它在某种意义上是对等比数列
	`varphi^n/sqrt 5` 的逼近.
</p>

<p class="proof">
	现在我们不用通项公式, 只借助递推式来推导极限 `lim_(n to oo)
	f_(n+1)//f_n`. 记 `x_n = f_(n+1)//f_n`, 则
	<span class="formula">
		`x_1 = 1`, `quad x_n = (f_n + f_(n-1))/(f_n) = 1 + 1/x_(n-1)`.
	</span>
	假设 `x_n to a`, 则 `a` 满足
	<span class="formula">
		`a = 1 + 1/a`.
	</span>
	显然 `a` 是正数, 由上式解得 `a = varphi = (1+sqrt 5)//2`.
	下证极限存在. 注意到 `x_n ge 1`, `n = 1, 2, cdots`, 有
	<span class="formula">
		`|x_n - a| = |(1 + 1/x_(n-1)) - (1 + 1/a)|`
		`= |1/x_(n-1) - 1/a|`
		`= |x_(n-1) - a|/(a x_(n-1))`
		`le 1/a |x_(n-1) - a|`
	</span>
	由 `1/a lt 1` 知 `|x_n - a| to 0`, 即 `x_n to a`.
</p>

<p class="example">
	设有两种译码规则 0 = A 和 00 = B, 现收到一串 `n` 个 0 的序列,
	问有几种不同的解释. 事实上, 设这个数为 `x_n`, 则 `x_1 = 1`, `x_2 = 2`
	(因为两个 0 可以解释为一个 B, 也可以解释为两个 A).
	设 `n ge 3`, 考虑 `n` 个 0 的序列, 若将第一个 0 解释为一个 A, 则余下
	`n-1` 个 0 有 `x_(n-1)` 种解释; 若将前两个 0 解释为一个 B, 则余下
	`n-2` 个 0 有 `x_(n-2)` 种解释.
	<span class="formula">
		`x_n = x_(n-1) + x_(n-2)`, `quad n ge 3`.
	</span>
	注意 `x_1 = f_2`, `x_2 = f_3`, 所以 `x_n = f_(n+1)`.
</p>

<h3>常系数齐次线性递推式</h3>

<p>	我们看到, 求解 Fibonacci 数列通项公式的所有方法中, 特征根法计算量最小,
	且抓住了问题的本质. 这一方法很容易推广到一般的常系数线性递推式,
	形如:
	<span class="formula">
		`sum_(i=0)^k a_i x_(n+i) = 0`, `quad a_k != 0`.
	</span>
	将 `x_n = lambda^n` (`lambda != 0`) 代入方程即得到关于 `lambda` 的一元
	`k` 次方程
	<span class="formula">
		`sum_(i=0)^k a_i lambda^i = 0`,
	</span>
	称为递推式的<b>特征方程</b>, 方程左边的 `k`
	次多项式称为<b>特征多项式</b>, 它的根称为<b>特征根</b>.
	事实上, 方程有 `k` 个线性无关的特解
	<span class="formula">
		`x_n = n^j lambda^n`,
		`quad j = 0, 1, cdots, m-1`,
	</span>
	其中 `lambda` 取遍所有不同的特征根, `m` 是 `lambda` 的重数.
	我们来说明它们确实是方程的解. 这只需证明下面的引理:
</p>

<p class="lemma">
	设 `lambda != 0` 是多项式 `f(x) = sum_(i=0)^n a_i x^i`
	的 `m` 重根 (`m ge 1`), 那么
	<span class="formula">
		`sum_(i=0)^n a_i lambda^i (x+i)^j = 0`,
		`quad j = 0, 1, cdots, m-1`.
	</span>
</p>

<ol class="proof">
	当 `j = 0` 时, 显然 `sum_(i=0)^n a_i lambda^i = 0`. 下面证明分两步:
	<li>先证 `lambda` 是 `sum_(i=0)^n a_i i^j x^i` 的 `m-j` 重根,
		`j = 0, 1, cdots, m-1`. (约定 `0^0 = 1`).
		`j = 0` 的情形, 条件已经给出.  现在设 `lambda` 是
		`sum_(i=0)^n a_i i^(j-1) x^i` 的 `m-j+1` 重根, 则它是其导式
		<span class="formula">
			`sum_(i=1)^n a_i i^j x^(i-1)`
		</span>
		的 `m-j` 重根, 从而是
		<span class="formula">
			`sum_(i=0)^n a_i i^j x^i`
			`= sum_(i=1)^n a_i i^j x^i`
			`= x sum_(i=1)^n a_i i^j x^(i-1)`
		</span>
		的 `m-j` 重根 (另一个根显然是 `0`).
	</li>
	<li>再设引理的结论对 `j-1` 成立, 则
		<span class="formula">
			`sum_(i=0)^n a_i lambda^i (x+i)^j`
			`= x sum_(i=0)^n a_i lambda^i (x+i)^(j-1)`
			`  + sum_(i=0)^n a_i i lambda^i (x+i)^(j-1)`
			`= x * 0 + sum_(i=0)^n a_i lambda^i sum_(k=0)^(j-1)
			((j-1),(k)) i^(k+1) x^(j-1-k)`
			`= sum_(k=0)^(j-1) ((j-1),(k)) x^(j-1-k)
			sum_(i=0)^n a_i lambda^i i^(k+1) = 0`.
		</span>
	</li>
</ol>

<p class="remark">
	如果特征方程有 `m` 重零根 `lambda = 0`, 则对应的系数满足
	`a_0 = a_1 = cdots = a_(m-1) = 0`, 且 `a_m != 0`.
	此时令 `y_n = x_(n+m)`, 原方程就化为
	<span class="formula">
		`sum_(i=m)^k a_i x_(n+i)`
		`= sum_(i=0)^(k-m) a_(i+m) y_(n+i) = 0`.
	</span>
	由于 `a_m != 0`, 它的特征方程无零根.
</p>

<p class="remark">
	如果系数 `a_0, a_1, cdots, a_k` 为实数, 而特征方程有复根
	`lambda = r"e"^("i" theta) = r(cos theta + "i"sin theta)`,
	则在特征方程两端同时取其共轭, 容易证明
	`bar lambda = r(cos theta - "i"sin theta)` 也是特征根,
	且和 `lambda` 具有相同重数.
	可以取两个实的特解
	<span class="formula">
		`1/2 n^j (lambda^n + {:bar lambda:}^n) = n^j r^n cos {:n theta:}`,
		<br/>
		`1/(2"i") n^j (lambda^n - {:bar lambda:}^n) = n^j r^n sin {:n
		theta:}`.
	</span>
	来替换对应的复数特解
	`n^j lambda^n` 和 `n^j {:bar lambda:}^n`.
</p>

<h3>非齐次常系数线性递推式的比较系数法</h3>

<ol>这类方程的一般形式如
	<span class="formula">
		`sum_(i=0)^k a_i x_(n+i) = f(n)`.
	</span>
	我们的结论是 (证明?):
	<li>当 `f(n) = P(n) lambda^n`, 其中 `P(n)` 是多项式:
		方程有特解 `n^m Q(n) lambda^n`, 其中 `Q(n)` 是次数不超过
		`del P(n)` 的多项式, `m` 是 `lambda` 在特征多项式中的重数,
		如果 `lambda` 不是特征根, 则 `m = 0`.
	</li>
	<li>当 `f(n) = r^n (A(n) cos n theta + B(n) sin n theta)`, 其中
		`A(n)`, `B(n)` 是多项式:
		方程有特解 `n^m r^n (P(n) cos n theta + Q(n) sin n theta)`, 其中
		`P(n)`, `Q(n)` 是次数不超过 `max{del A(n), del B(n)}` 的多项式,
		`m` 是 `r"e"^("i" theta)` 在特征多项式中的重数,
		如果 `r"e"^("i" theta)` 不是特征根, 则 `m = 0`.
	</li>
</ol>

<table>
	<tr>
		<th>`f(n)`</th>
		<th>方程的特解</th>
	</tr>
	<tr>
		<td>`P(n) lambda^n`</td>
		<td>`n^m Q(n) lambda^n`</td>
	</tr>
	<tr>
		<td>`r^n (A(n) cos n theta + B(n) sin n theta)`</td>
		<td>`n^m r^n (P(n) cos n theta + Q(n) sin n theta)`</td>
	</tr>
</table>

<script src="../js/note.js?type=math"></script>

</body>

</html>
