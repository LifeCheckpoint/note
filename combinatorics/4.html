<!DOCTYPE html>
<html lang="zh-cn">

<head>

<title>Bernoulli 数</title>
<meta charset="utf-8" />

<link rel="stylesheet" type="text/css" href="../css/note.css" />

</head>

<body>

<h2>前 `x` 个自然数 `n` 次幂的求和公式</h2>

<p class="definition">
	设 `n` 为非负整数, 定义 `B_n(x) in QQ[x]` 是满足
	<span class="formula">
		`int_x^(x+1) B_n(y) dy = x^n`
		<span class="label" id="for-def-Bn(x)"></span>
	</span>
	的唯一 (?) 多项式, 称为 <b>Bernoulli 多项式</b>.
	易知 `B_n(x)` 是次数为 `n` 的首一多项式.
	`B_n(x)` 也记为 `B_n^(-)(x)`.
</p>

<p class="definition">
	对任意非负整数 `n, x`, 记
	<span class="formula">
		`S_n(x) = sum_(i=1)^x i^n`, `quad B_n^+(x) = "d"/dx S_n(x)`.
	</span>
	注意 `S_n(0) -= 0`, 故有 `S_n(x) = int_0^x B_n^+(y) dy`.
</p>

<p class="proposition" id="prop-relation-bernoulli-poly">
	`B_n^+(x) = B_n(x+1)`, 因此 `B_n^+(x)` 也是次数为 `n` 的首一多项式.
</p>

<p class="proof">
	在等式
	<span class="formula">
		`S_n(x) = sum_(i=1)^x i^n`
		`= sum_(i=1)^x int_i^(i+1) B_n(y) dy`
		`= int_1^(x+1) B_n(y) dy`
	</span>
	两端求导即得.
</p>

<p class="corollary" id="cor-relation-bernoulli-poly">
	在 `B_n(x)` 的定义式<a class="ref"
	href="#for-def-Bn(x)"></a>两端求导有
	<span class="formula">
		`B_n^+(x) - B_n(x) = n x^(n-1)`.
	</span>
</p>

<p class="proposition" id="prop-Bn'(x)">
	`"d"/dx B_n^(+-)(x) = n B_(n-1)^(+-)(x)`, `n ge 1`.
</p>

<p class="proof">
	<span class="formula">
		`int_x^(x+1) "d"/dx B_n(y) dy`
		`= "d"/dx int_x^(x+1) B_n(y) dy`
		`= "d"/dx (x^n)`
		`= n x^(n-1)`,
	</span>
	再由定义即得
	<span class="formula">
		`"d"/dx B_n(x) = n B_(n-1)(x)`.
	</span>
	利用<a class="ref" href="#prop-relation-bernoulli-poly"></a> 知,
	`B_n^+(x)` 也满足相同的等式.
</p>

<p class="proposition" id="prop-Sn">
	`S_(n-1)(x) = (B_n^+(x) - B_n^+(0))/n`, `n ge 1`.
</p>

<p class="proof">
	`S_(n-1)(x) = int_0^x B_(n-1)^+(y) dy`
	`= int_0^x ("d"/dx B_n^+(y))/n dy`
	`= (B_n^+(x) - B_n^+(0))/n`.
</p>

<ol class="definition">
	<li><b>第一类 Bernoulli 数</b>是 `B_n(x)` 的常数项:
		`B_n^(-) := B_n^(-)(0) = B_n^+(-1)`;
	</li>
	<li><b>第二类 Bernoulli 数</b>是 `B_n^+(x)` 的常数项, 也是 `B_n(x)`
		的各项系数之和: `B_n^+ := B_n^+(0) = B_n^(-)(1)`.
	</li>
	由<a class="ref" href="#cor-relation-bernoulli-poly"></a>知道,
	除了 `n=1` 时有 `B_n^+ - B_n^(-) = 1` 外, 对于 `n != 1` 均有 `B_n^+
	= B_n^(-)`, 这时我们不区分两类 Bernoulli 数, 都简记为 `B_n`.
</ol>

<p class="proposition" id="prop-Bn(x)">
	`B_n^(+-)(x) = sum_(k=0)^n (n;k) B_k^(+-) x^(n-k)`.
</p>

<p class="proof">
	由<a class="ref" href="#prop-Bn'(x)"></a>,
	<span class="formula">
		`1/(k!) "d"^k/dx^k B_n^(+-)(x)`
		`= (n;k) B_(n-k)^(+-)(x)`, `quad n ge k`.
	</span>
	从而 `B_n^(+-)(x)` 的 `n-k` 次项系数等于
	<span class="formula">
		`1/((n-k)!) "d"^(n-k)/dx^(n-k) B_n(x)|_(x=0)`
		`= (n;n-k) B_k(0)`
		`= (n;k) B_k^+`,
	</span>
	从而结论成立.
</p>

<p>综上有:</p>

<p class="theorem">
	设整数 `x ge 0`, `n ge 1`, 则
	<span class="formula">
		`sum_(i=1)^x i^(n-1) = S_(n-1)(x)`
		`= 1/n sum_(k=0)^(n-1) (n;k) B_k^+ x^(n-k)`.
		<span class="label" id="for-sum-powers"></span>
	</span>
</p>

<p class="proof">
	由<a class="ref" href="#prop-Sn"></a>知, `n S_(n-1)(x)` 等于
	`B_n^+(x)` 减去其常数项,
	由<a class="ref" href="#prop-Bn(x)"></a>, 此即
	<span class="formula">
		`n S_(n-1)(x)`
		`= sum_(k=0)^(n-1) (n;k) B_k^+ x^(n-k)`.
	</span>
</p>

<h2>Bernoulli 数的递推公式与生成函数</h2>

<h3>递推公式</h3>

<p class="proposition">
	<b>`B_n^(+-)(x)` 的递推公式</b>
	<span class="formula">
		`sum_(k=0)^(n-1) (n;k) B_k^(+)(x) = n(x+1)^(n-1)`, `quad n ge 1`.
		<br/>
		`sum_(k=0)^(n-1) (n;k) B_k^(-)(x) = n x^(n-1)`, `quad n ge 2`.
	</span>
</p>

<ol class="proof">
	<li>由二项式定理
		<span class="formula">
			`sum_(k=0)^(n-1) (n;k) i^k`
			`= (i+1)^n - i^n`,
		</span>
		令 `i` 从 `1` 到 `x` 求和,
		<span class="formula">
			`sum_(k=0)^(n-1) (n;k) S_n(x)`
			`= (x+1)^n - 1`.
		</span>
		再求导即可.
	</li>
	<li>由 1, <a class="ref" href="#cor-relation-bernoulli-poly"></a> 和
		<span class="formula">
			`sum_(k=0)^(n-1) (n;k) k x^(k-1)`
			`= sum_(k=0)^(n-2) (n;k+1) (k+1) x^k`
			`= n sum_(k=0)^(n-2) (n-1;k) x^k`
			`= n [(x+1)^(n-1) - x^(n-1)]`
		</span>
		即得证.
	</li>
</ol>

<p class="corollary">
	<b>`B_n^(+-)` 的递推公式</b>
	在 `B_n^(+-)(x)` 的递推公式中代入 `x=0` 得,
	<span class="formula">
		`sum_(k=0)^(n-1) (n; k) B_k^+ = n`, `quad n ge 1`.<br/>
		`sum_(k=0)^(n-1) (n; k) B_k^(-) = 0`, `quad n ge 2`.
	</span>
	在 <a class="ref" href="#for-sum-powers"></a> 中代入 `x=1` 也能得到
	`B_n^+` 的递推公式.
	(由此知 `n ge 1` 时, `B_(2n)` 的符号是正负交错的.
	因此 `tan x` 的 Maclaurin 展开系数全为正, 等等.)(?)
</p>

<p>	利用递推公式计算前几个 Bernoulli 数如下. 其中除了 `B_1^+ = 1/2`,
	`B_1^(-) = -1/2` 外, 均有 `B_n^+ = B_n^(-)`.
	有趣的是 `B_3 = B_5 = B_7 = cdots = 0`, 这一点我们稍后证明.
</p>

<table style="font-size:.85em;text-align:center">
	<tr>
		<td>`n`</td>
		<td>`0`</td>
		<td>`1`</td>
		<td>`2`</td>
		<td>`4`</td>
		<td>`6`</td>
		<td>`8`</td>
		<td>`10`</td>
		<td>`12`</td>
		<td>`14`</td>
		<td>`16`</td>
		<td>`18`</td>
		<td>`20`</td>
	</tr>
	<tr>
		<td>`B_n`</td>
		<td>`1`</td>
		<td>`+-1/2`</td>
		<td>`1/6`</td>
		<td>`-1/30`</td>
		<td>`1/42`</td>
		<td>`-1/30`</td>
		<td>`5/66`</td>
		<td>`-691/2730`</td>
		<td>`7/6`</td>
		<td>`-3617/510`</td>
		<td>`43867/798`</td>
		<td>`-174611/330`</td>
	</tr>
</table>

<p class="proposition">
	`B_n(1-x) = (-1)^n B_n(x)`.
</p>

<p class="proof">
	<span class="formula">
		`int_x^(x+1) B_n(1-y) dy`
		`= int_(-x)^(1-x) B_n(t) dt`
		`= (-x)^n`,
	</span>
	由定义即得结论.
</p>

<p class="corollary">
	`B_n^(-) = B_n(0) = (-1)^n B_n(1) = (-1)^n B_n^+`.
	但是对任意 `n != 1` 有 `B_n^+ = B_n^(-)`,
	所以对任意奇数 `n ge 3`, `B_n = 0`.
</p>

<h3>生成函数</h3>

<p class="theorem">
	`B_n(x)` 的指数型生成函数是
	<span class="formula">
		`(t "e"^(x t))/("e"^t-1) = sum_(n=0)^oo B_n(x) t^n/(n!)`,
		`quad |t| lt 2pi`.
	</span>
	分别代入 `x = 1, 0` 得:
	<span class="formula">
		`(t"e"^t)/("e"^t-1) = sum_(n=0)^oo B_n^+ t^n/(n!)`,
		`quad |t| lt 2 pi`,<br/>
		`(t)/("e"^t-1) = sum_(n=0)^oo B_n^(-) t^n/(n!)`,
		`quad |t| lt 2 pi`.
	</span>
</p>

<p class="proof">
	<span class="formula">`{:
		 , ("e"^t-1) sum_(k=0)^oo B_k(x) t^k/(k!);
		=, (sum_(j=1)^oo t^j/(j!)) (sum_(k=0)^oo B_k(x) t^k/(k!));
		=, sum_(n=1)^oo sum_(k=0)^(n-1) B_k(x) t^n/(k!(n-k)!);
		=, sum_(n=1)^oo t^n/(n!) sum_(k=0)^(n-1) (n;k) B_k(x);
		=, sum_(n=1)^oo (x^(n-1) t^n)/((n-1)!);
		=, t sum_(n=0)^oo (x t)^n/(n!);
		=, t "e"^(x t).
	:}`</span>
	注意到生成函数具有奇点 `2 k pi "i"`, `k in ZZ`, 因此收敛半径为 `2pi`.
</p>

<p class="remark">
	在 `B_n^+` 的生成函数两边用 `-t` 替换 `t`,
	也能得到 `B_n^(-)` 的生成函数:
	<span class="formula">
		`sum_(n=0)^oo B_n^(-) t^n/(n!)`
		`= sum_(n=0)^oo B_n^+ (-1)^n t^n/(n!)`
		`= (-t"e"^-t)/("e"^-t-1)`
		`= t/("e"^t-1)`.
	</span>
</p>

<p class="remark">
	也可以由生成函数来定义 `B_n(x)`, `B_n^+`, `B_n^-`,
	并导出以上提到的全部性质.
</p>

<p class="corollary">
	<span class="formula">
		`t/2 coth{:t/2:}`
		`= t/2 ("e"^t+1)/("e"^t-1)`
		`= (t"e"^t-t/2("e"^t-1))/("e"^t-1)`
		`= (t"e"^t)/("e"^t-1) - B_1^+ t`
		`= sum_(n=0)^oo B_(2n) t^(2n)/((2n)!)`.
	</span>
</p>

<p class="example">
	一些三角函数的 Maclaurin 展式:
</p>

<table>
	<tr>
		<td>`coth x = sum_(n=0)^oo B_(2n) (4^n x^(2n-1))/((2n)!)`,</td>
		<td>`|x| lt pi`</td>
	</tr>
	<tr>
		<td>`cot x = sum_(n=0)^oo B_(2n) ((-4)^n x^(2n-1))/((2n)!)`,</td>
		<td>`|x| lt pi`</td>
	</tr>
	<tr>
		<td>`tanh x = sum_(n=1)^oo B_(2n) (4^n(4^n-1) x^(2n-1))/((2n)!)`,</td>
		<td>`|x| lt pi/2`</td>
	</tr>
	<tr>
		<td>`tan x = sum_(n=1)^oo B_(2n)((-4)^n(1-4^n) x^(2n-1))/((2n)!)`,</td>
		<td>`|x| lt pi/2`</td>
	</tr>
</table>

<p class="proof">
	<span class="formula">
		`coth x`
		`= ("e"^(2x)+1)/("e"^(2x)-1)`
		`= 1/x sum_(n=0)^oo B_(2n) (2x)^(2n)/((2n)!)`
		`= sum_(n=0)^oo B_(2n)(4^n x^(2n-1))/((2n)!)`,<br/>
		`tanh x`
		`= ("e"^(2x)-1)/("e"^(2x)+1)`
		`= 2("e"^(4x)+1)/("e"^(4x)-1) - ("e"^(2x)+1)/("e"^(2x)-1)`
		`= sum_(n=1)^oo (4^n(4^n-1) B_(2n))/((2n)!) x^(2n-1)`.
	</span>
	再利用
	<span class="formula">
		`cot x = "i" coth("i"x)`,
		`quad tan x = -"i" tanh("i"x)`,
	</span>
	即得到 `cot x`, `tan x` 的展式.
	类似地, 还可以通过恒等式
	<span class="formula">
		`csc x = cot x + tan{:x/2:}`
	</span>
	得到展式
	<span class="formula">
		`csc x = sum_(n=0)^oo B_(2n) ((-1)^n (2-4^n) x^(2n-1))/((2n)!)`,
		`quad |x| lt pi`.
	</span>
	等等.
</p>

<h2>Euler-Maclaurin 求和公式</h2>

<h3>Bernoulli 数与调和级数</h3>

<ol class="lemma">
	<li>`sum_(k=n)^oo 1/(k(k+1) cdots (k+m))`
		`= 1/(m n(n+1)cdots(n+m-1))`.
	</li>
	<li>设 `m ge 1`, 当 `n to oo` 时有 `sum_(k=n)^oo 1/k^(m+1) ~ 1/(m n^m)`.
	</li>
</ol>

<ol class="proof">
	<li>等式左边记为 `T_(m, n)`.
		显然 `m ge 1` 时级数收敛. 直接计算
		<span class="formula">
			`T_(m+1,n) = sum_(k=n)^oo 1/(k(k+1)cdots(k+m+1))`
			`= sum_(k=n)^oo 1/(k(k+1)cdots(k+m)) - sum_(k=n)^oo
			(k+m)/(k(k+1)cdots(k+m+1))`
			`= T_(m,n) - m T_(m+1,n) - sum_(k=n)^oo
			1/((k+1)cdots(k+m+1))`.
		</span>
		于是
		<span class="formula">
			`T_(m+1,n) = 1/(m+1) (T_(m,n) - T_(m,n+1))`
			`= 1/((m+1)n(n+1)cdots(n+m)`.
		</span>
	</li>
	<li>由 1. 有
		<span class="formula">
			`sum_(k=n)^oo 1/k^(m+1)`
			`le sum_(k=n)^oo 1/(k(k-1)cdots(k-m))`
			`= 1/(m(n-1)cdots(n-m))`,
		</span>
		另一方面
		<span class="formula">
			`sum_(k=n)^oo 1/k^(m+1)`
			`ge sum_(k=n)^oo 1/(k(k+1)cdots(k+m))`
			`= 1/(m n(n+1)cdots(n+m-1))`,
		</span>
		令 `n to oo`, 由两边夹法则即得结论.
	</li>
</ol>

<ol class="example">
	记 `a_n = sum_(k=1)^n 1/k - ln n`, 则
	<li>`lim_(n to oo) a_n` 存在, 记为 `gamma` (Euler 常数);</li>
	<li>`a_n - gamma ~ 1/(2n)`;</li>
	<li>`a_n - gamma - 1/(2n) ~ -1/(12n^2)`.</li>
</ol>

<ol	class="proof">
	<li>见<a href="../analysis/10.html#euler-constant">Euler 常数</a>的证明.</li>
	<li>即证 `lim_(n to oo) n (a_n - gamma) = 1/2`.
		首先利用
		<span class="formula">
			`ln n = sum_(k=1)^(n-1) [ln(k+1) - ln k]`
			`= sum_(k=1)^(n-1) ln(1+1/k)`,
		</span>
		把 `a_n` 写成求和的形式:
		<span class="formula">
			`a_n = 1 + sum_(k=1)^(n-1) [1/(k+1) - ln(1+1/k)]`.
		</span>
		利用 Taylor 展开 `ln(1+x) = x - x^2/2 + O(x^3)` (`x to 0`) 有
		<span class="formula">
			`n(a_n - gamma)`
			`= n sum_(k=n)^oo [ln(1+1/k) - 1/(k+1)]`
			`= n sum_(k=n)^oo [1/k - 1/(2 k^2) + O(1/k^3) - 1/(k+1)]`
			`= n sum_(k=n)^oo [(k-1)/(2k^2(k+1)) + O(1/k^3)]`.
		</span>
		由引理有
		<span class="formula">
			`lim_(n to oo) n(a_n-gamma)`
			`= lim_(n to oo) n * 1/(2n) = 1/2`.
		</span>
	</li>
	<li>即证 `lim_(n to oo) n^2(a_n-gamma-1/(2n)) = -1/12`.
		由 `1/(2n) = sum_(k=n)^oo (1/(2k) - 1/(2(k+1)))` 有
		<span class="formula">
			`n^2 (a_n-gamma-1/(2n))`
			`= n^2 sum_(k=n)^oo [ln(1+1/k) - 1/(k+1) - 1/(2k)
			+ 1/(2(k+1))]`
			`= n^2 sum_(k=n)^oo [1/k - 1/(2k^2) + 1/(3k^3) + O(1/k^4)
			- 1/(2k) - 1/(2(k+1))]`
			`= n^2 sum_(k=n)^oo [(2-k)/(6k^3(k+1)) + O(1/k^4)]`.
		</span>
		由引理有
		<span class="formula">
			`lim_(n to oo) n^2(a_n-gamma-1/(2n))`
			`= lim_(n to oo) n^2 (1/(3*3n^3) - 1/(6*2n^2))`
			`= -1/12`.
		</span>
	</li>
</ol>

<p class="remark" id="rem-conj-harmonic">
	继续计算, 得到:
	<span class="formula">
		`a_n = gamma + 1/(2n) - 1/(6*2n^2) + 1/(30*4n^4) - 1/(42*6n^6)+ cdots`.
	</span>
	猜想:
	<span class="formula">
		`a_n = gamma - sum_(k=1)^m (B_k^-)/(k n^(k)) + O(1/n^(m+1))`.
	</span>
</p>

<h3>Euler-Maclaurin 求和公式</h3>

<p>	在探讨前 `x` 个自然数 `n` 次幂的求和公式时, 采用了化求和
	`sum_(i=1)^x i^n` 为积分 `int_0^x B_n^+(y) dy` 的方法.
	同样的思想加以推广, 就有了下述以积分来估计求和的
	Euler-Maclaurin 求和公式. 这一公式可以类比于积分型余项的 Taylor 公式.
</p>

<p class="theorem">
	<b>Euler-Maclaurin 求和公式</b>
	设函数 `f in C^m[a,b]`, `m ge 1`, `a,b` 为整数. 则
	<span class="formula">
		`sum_(n=a)^b f(n) = int_a^b f(x) dx + (f(a)+f(b))/2`
		`+ sum_(k=1)^(m-1) B_(k+1)/((k+1)!) (f^((k))(b) - f^((k))(a))`
		`- (-1)^m/(m!) int_a^b B_m(x-|__x__|) f^((m))(x) dx`.
	</span>
	上式等号右端的前两项相当于梯形公式
	<span class="formula">
		`int_a^b f(x) dx ~~ sum_(n=a)^(b-1) (f(n)+f(n+1))/2`,
	</span>
	它用一系列宽度为 `1`, 两底长分别为 `f(n)` 和 `f(n+1)`
	的梯形面积来估计积分 `int_a^b f(x) dx`.
</p>

<p class="proof">
	设 `g in C^m[0,1]`.
	反复应用<a class="ref" href="#prop-Bn'(x)"></a> 和分部积分,
	<span class="formula">
		`int_0^1 g(x) dx`
		`= int_0^1 B_0(x) g(x) dx`
		`= int_0^1 B_1'(x) g(x) dx`
		`= [B_1(x) g(x)]_0^1 - int_0^1 B_1(x) g'(x) dx`
		`= (B_1^+ g(1) - B_1^(-) g(0)) - 1/2 int_0^1 B_2'(x) g'(x) dx`
		`= (g(1)+g(0))/2 - 1/2 [B_2(x) g'(x)]_0^1 + 1/2 int_0^1 B_2(x)
		g''(x) dx`
		`= (g(1)+g(0))/2 - B_2/2 (g'(1)-g'(0)) + 1/2 int_0^1 B_2(x) g''(x) dx`
		`= cdots`
		`= (g(1)+g(0))/2 - sum_(k=1)^(m-1) B_(k+1)/((k+1)!) (g^((k))(1)
		- g^((k))(0))`
		`+ (-1)^m/(m!) int_0^1 B_m(x) g^((m))(x) dx`.
	</span>
	在上式中令 `g(x) = f(x+n)`,
	<span class="formula">
		`int_n^(n+1) f(x) dx`
		`= (f(n+1)+f(n))/2 - sum_(k=1)^(m-1) B_(k+1)/((k+1)!)
		(f^((k))(n+1)-f^((k))(n))`
		`+ (-1)^m/(m!) int_n^(n+1) B_m(x-n) f^((m))(x) dx`.
	</span>
	再令 `n = a` 到 `b-1` 求和,
	注意到对任意 `x in [n,n+1]` 有 `B_m(x-n) = B_m(x-|__x__|)`,
	就得到结论.
</p>

<p class="corollary">
	<b>调和级数的估计</b>
	<a class="ref" href="#rem-conj-harmonic"></a> 中的猜想是正确的.
</p>

<p class="proof">
	在 Euler-Maclaurin 公式中取 `f(k) = 1/k`, `a = 1`, `b = n`. 由
	<span class="formula">
		`int_1^n dx/x = ln n`,
		`quad "d"^k/dx^k (1/x)`
		`= ((-1)^k k!)/x^(1+k)`,
	</span>
	得到
	<span class="formula">
		`a_n = sum_(k=1)^n 1/k - ln n`
		`= 1/2(1+1/n) + sum_(k=1)^(m-1) B_(k+1)/(k+1)(1 - 1/n^(1+k))`
		`- int_1^n (B_m(x-|__x__|))/x^(1+m) dx`.
	</span>
	取极限,
	<span class="formula">
		`gamma = lim_(n to oo) a_n`
		`= 1/2 + sum_(k=1)^(m-1) B_(k+1)/(k+1)`
		`- int_1^oo (B_m(x-|__x__|))/x^(1+m) dx`.
	</span>
	两式相减,
	<span class="formula">
		`a_n - gamma`
		`= 1/(2n) - sum_(k=1)^(m-1) B_(k+1)/(k+1) 1/n^(1+k) + int_n^oo
		(B_m(x-|__x__|))/x^(1+m) dx`.
	</span>
	因为 `B_m(x-|__x__|)` 是有界函数, 我们设它的模不超过 `C`, 则
	<span class="formula">
		`|int_n^oo (B_m(x-|__x__|))/x^(1+m) dx|`
		`le C int_n^oo dx/x^(1+m)`
		`= C/(m n^m)`
		`= O(1/n^m)`.
	</span>
	于是
	<span class="formula">
		`a_n = gamma - sum_(k=1)^m B_k^(-)/(k n^k) + O(1/n^(m+1))`.
	</span>
</p>

<p class="corollary">
	<b>Stirling 级数</b>
	<span class="formula">
		`n! = sqrt(2pi n) (n/"e")^n exp(sum_(k=1)^m B_(k+1)/(k(k+1))
		1/n^k + O(1/n^(m+1)))`.
	</span>
</p>

<ol class="proof">
	<li>在 Euler-Maclaurin 公式中取 `f(k) = ln k`, `a = 1`, `b = n`. 由
	<span class="formula">
		`sum_(k=1)^n ln k = ln n!`,<br/>
		`int_1^n ln x dx = n(ln n-1) + 1`,<br/>
		`quad "d"^k/dx^k (ln x) = (-1)^(k-1) (k-1)! x^-k`, `quad k ge 1`,
	</span>
	得到
	<span class="formula">
		`ln n! - 1/2 ln n - n(ln n-1)`
		`= 1 + sum_(k=1)^(m-1) B_(k+1)/(k(k+1)) (1/n^k-1)`
		`+ 1/m int_1^n (B_m(x-|__x__|))/x^m dx`.
	</span>
	取极限
	<span class="formula">
		`a := lim_(n to oo) (ln n! - 1/2 ln n - n(ln n-1))`
		`= 1-sum_(k=1)^(m-1) B_(k+1)/(k(k+1))`
		`+ 1/m int_1^oo (B_m(x-|__x__|))/x^m dx`.
	</span>
	两式相减
	<span class="formula">
		`ln n! - ln(sqrt n(n/"e")^n) - a`
		`= sum_(k=1)^(m-1) B_(k+1)/(k(k+1)) 1/n^k`
		`+ O(1/n^(m-1))`,
	</span>
	移项后两边取指数,
	<span class="formula">
		`n! = "e"^a sqrt n (n/"e")^n exp(sum_(k=1)^(m-1) B_(k+1)/(k(k+1))
		1/n^k + O(1/n^(m-1)))`.
		<span class="label" id="for-On^(1-m)"></span>
	</span>
	以 `m` 代替上式的 `m-1`, 又得到
	<span class="formula">
		`n! = "e"^a sqrt n (n/"e")^n exp(sum_(k=1)^m B_(k+1)/(k(k+1))
		1/n^k + O(1/n^m))`.
	</span>
	两式比较可以发现, <a class="ref" href="#for-On^(1-m)"></a>
	中的余项 `O(1/n^(m-1))` 实际上可以换成 `O(1/n^m)`. 于是
	<span class="formula">
		`n! = "e"^a sqrt n (n/"e")^n exp(sum_(k=1)^m B_(k+1)/(k(k+1))
		1/n^k + O(1/n^(m+1)))`.
	</span>
	</li>
	<li>下面确定公式中的常数 `"e"^a`. 由 1. 得
		<span class="formula">
			`n! = "e"^a sqrt n (n/"e")^n exp(O(1/n))`
			`= "e"^a sqrt n (n/"e")^n (1 + O(1/n))`.
		</span>
		将其代入 <a href="../analysis/7.html#for-wallis">Wallis 公式</a>
		<span class="formula">
			`pi/2 = lim_(n to oo) ((2n)!!)^2/((2n-1)!!(2n+1)!!)`,
		</span>
		就可算出 `"e"^a = sqrt(2pi)`.
	</li>
</ol>

<h2>Bernoulli 数与 Stirling 数</h2>

<h2>`zeta(2k)` 的求值</h2>

<script src="../js/note.js?type=math"></script>

</body>

</html>
