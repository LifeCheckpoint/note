<!DOCTYPE html>
<html lang="zh-cn">

<head>

<title>Bernoulli 数</title>
<meta charset="utf-8" />

<link rel="stylesheet" type="text/css" href="../css/note.css" />

</head>

<body>

<h2>前 `x` 个自然数 `n` 次幂的求和公式</h2>

<p class="definition">
	对任意非负整数 `n` 和 `x`, 记
	<span class="formula">
		`S_n(x) = sum_(i=1)^x i^n`.
	</span>
	特别 `S_n(0) = 0`, `n = 0, 1, 2, cdots`.
</p>

<p class="theorem">
	<b>`S_n(x)` 的递推公式</b>
	<span class="formula">
		`sum_(k=0)^n ((n+1),(k)) S_k(x) = (x+1)^(n+1) - 1`,
		`quad n ge 0`.
		<span class="label" id="for-Sn(x)-recur"></span>
	</span>
	其中 `S_n(x)` 是关于 `x` 的 `n+1` 次多项式, 其常数项为 `0`.
</p>

<p class="proof">
	`n = 0` 时, `S_0(x) = sum_(i=1)^x i^0 = x`, 结论成立.
	现假设 `n gt 0`, 结论对所有小于 `n` 的非负整数成立, 
	由二项式定理, 对 `i = 1, 2, cdots, x` 有
	<span class="formula">
		`(i+1)^(n+1) - i^(n+1) = sum_(k=0)^n ((n+1),(k)) i^k`.
	</span>
	两边关于 `i` 从 `1` 到 `x` 求和就得到式 <a class="ref"
	href="#for-Sn(x)-recur"></a>.
	由归纳假设, `S_k(x)` 是常数项为 `0` 的 `k+1` 次多项式, `k = 0, 1,
	cdots, n-1`, 又 <a class="ref" href="#for-Sn(x)-recur"></a>
	右边是一个常数项为 `0` 的 `n+1` 次多项式, 所以 `S_n(x)` 是常数项为 `0`
	的 `n+1` 次多项式.
</p>

<p class="corollary">
	取 `x = 1` 知, `S_n(x)` 的各次项系数之和为 `1`.
</p>

<p class="definition">
	现在考虑 `S_n(x)` 的导数.
	对任意非负整数 `n`, 定义多项式 `B_n(x) := "d"/dx S_n(x)`, 则
	<span class="formula">
		`sum_(i=1)^x i^n = S_n(x) = int_0^x B_n(t) dt`.
	</span>
	从而将离散的求和化为连续的积分来处理.

</p>

<p class="corollary">
	<b>`B_n^+` 的递推公式</b>
	对任意非负整数 `n`, 记 `B_n^+ := B_n(0)` 为 `B_n(x)` 的常数项,
	在 <a class="ref" href="#for-Sn(x)-recur"></a> 两边求导, 有
	<span class="formula">
		`sum_(k=0)^n ((n+1),(k)) B_k(x) = (n+1)(x+1)^n`,
		<span class="label" id="for-Bn(x)-recur"></span>
	</span>
	从而
	<span class="formula">
		`sum_(k=0)^n ((n+1),(k)) B_k^+ = n+1`.
		<span class="label" id="for-Bn+-recur"></span>
	</span>
</p>

<p class="theorem">
	<span class="formula">
		`B_n(x) = "d"/dx S_n(x) = {
			(B_0^+, if n = 0),
			(n S_(n-1)(x) + B_n^+, if n ge 1)
		:}`
	</span>
	换言之,
	<span class="formula">
		`S_n(x) = (B_(n+1)(x) - B_(n+1)^+)/(n+1)`, `quad n ge 0`.
	</span>
	此外,
	<span class="formula">
		`"d"/dx B_n(x) = n "d"/dx S_(n-1)(x) = n B_(n-1)(x)`,
		`quad n ge 1`,<br/>
		`1/(k!)"d"^k/dx^k B_n(x) = ((n),(k)) B_(n-k)(x)`, `quad n ge k`.
	</span>
</p>

<p class="proof">
	`n = 0, 1` 时,
	<span class="formula">
		`B_0(x) = "d"/dx (x) = 1 = B_0^+`,<br/>
		`B_1(x) = "d"/dx(x^2/2+x/2)`
		`= x + 1/2 = S_0(x) + B_1^+`,
	</span>
	结论成立. 现假设 `n gt 1`, 结论对所有小于 `n` 的非负整数都成立,
	利用
	<a class="ref" href="#for-Sn(x)-recur"></a>,
	<a class="ref" href="#for-Bn(x)-recur"></a>,
	<a class="ref" href="#for-Bn+-recur"></a> 和归纳假设,
	<span class="formula">
		`B_n(x) = (x+1)^n - 1/(n+1) sum_(k=0)^(n-1) ((n+1),(k)) B_k(x)`
		`= (x+1)^n - sum_(k=1)^(n-1) ((n+1),(k)) k/(n+1) S_(k-1)(x)`
		`- 1/(n+1) sum_(k=0)^(n-1) ((n+1),(k)) B_k^+`
		`= (x+1)^n - sum_(k=1)^(n-1) ((n),(k-1)) S_(k-1)(x)`
		`- (1 - B_n^+)`
		`= (x+1)^n - 1 - sum_(k=0)^(n-2) ((n),(k)) S_k(x) + B_n^+`
		`= n S_(n-1)(x) + B_n^+`.
	</span>
</p>

<p class="corollary">
	<span class="formula">
		`B_n(x) = sum_(k=0)^n ((n),(k)) B_k^+ x^(n-k)`, `quad n ge 0`.
		<span class="label" id="for-Bn(x)"></span>
	</span>
</p>

<!--
<p class="proof">
	`n = 0` 时, `B_0(x) = 1 = B_k^+`, 结论成立.
	现假设 `n gt 0`, 结论对任意小于 `n` 的非负整数成立, 则
	<span class="formula">
		`"d"/dx B_n(x)`
		`= n B_(n-1)(x)`
		`= n sum_(k=0)^(n-1) ((n-1),(k)) B_k^+ x^(n-1-k)`
		`= sum_(k=0)^(n-1) ((n),(k)) B_k^+ (n-k) x^(n-1-k)`
		`= "d"/dx sum_(k=0)^n ((n),(k)) B_k^+ x^(n-k)`.
	</span>
	又 `B_n(0) = B_n^+ = sum_(k=0)^n ((n),(k)) B_k^+ x^(n-k)|_(x=0)`,
	所以结论成立.
</p>
-->

<p class="proof">
	`B_n(x)` 的 `n-k` 次项系数等于
	<span class="formula">
		`1/((n-k)!) "d"^(n-k)/dx^(n-k) B_n(x)|_(x=0)`
		`= ((n),(n-k)) B_k(0)`
		`= ((n),(k)) B_k^+`,
	</span>
	从而结论成立.
</p>

<h2>Bernoulli 数的定义</h2>

<p class="definition">
	对任意非负整数 `n`,
	把由递推公式 <a class="ref" href="#for-Bn+-recur"></a> 定义的
	`B_n^+` 称为<b>第二类 Bernoulli 数</b>,
	`B_n^(-) := (-1)^n B_n^+` 称为<b>第一类 Bernoulli 数</b>.
</p>

<p class="theorem">
	两类 Bernoulli 数的指数型生成函数分别是
	<span class="formula">
		`(t"e"^t)/("e"^t-1) = sum_(n=0)^oo B_n^+ t^n/(n!)`,
		`quad |t| lt 2 pi`,<br/>
		`(t)/("e"^t-1) = sum_(n=0)^oo B_n^(-) t^n/(n!)`,
		`quad |t| lt 2 pi`.
	</span>
	等价地, 也可以由生成函数来定义数列 `{B_n^+}`, `{B_n^-}`.
</p>

<p class="proof">
	利用 `B_n^+` 的递推公式, 计算
	<span class="formula">
		`("e"^t-1) sum_(n=0)^oo B_n^+ t^n/(n!)`
		`= (sum_(n=1)^oo t^n/(n!)) (sum_(n=0)^oo B_n^+ t^n/(n!))`
		`= sum_(n=1)^oo sum_(k=0)^(n-1) B_k^+ t^n/(k!(n-k)!)`
		`= sum_(n=1)^oo t^n/(n!) sum_(k=0)^(n-1) ((n),(k)) B_k^+`
		`= sum_(n=1)^oo t^n/((n-1)!)`
		`= t sum_(n=0)^oo t^n/(n!)`
		`= t "e"^t`.
	</span>
	从而证明了 `B_n^+` 的生成函数. 在 `B_n^+` 的生成函数两边取 `t = -t`,
	有
	<span class="formula">
		`(-t"e"^-t)/("e"^-t-1) = sum_(n=0)^oo B_n^(-) t^n/(n!)`,
	</span>
	从而 `B_n^-` 的生成函数为
	<span class="formula">
		`(-t"e"^-t)/("e"^-t-1) = t/("e"^t-1)`.
	</span>
	注意到生成函数具有奇点 `2 k pi "i"`, `k in ZZ`, 因此收敛半径为 `2pi`.
</p>

<p class="corollary">
	对奇数 `n ge 3`, `B_n^+ = 0`. 因此, 除了 `B_1^+ = 1/2`,
	`B_1^(-) = -1/2` 外, 对所有非负整数 `n` 都有 `B_n^+ = B_n^-`.
	因此, 当下标为偶数时, 我们不区分两类 Bernoulli 数, 都简记为 `B_(2n)`.
</p>

<p class="proof">
	注意
	<span class="formula">
		`(t"e"^t)/("e"^t-1) - B_1^+ t`
		`= (t"e"^t-t/2("e"^t-1))/("e"^t-1)`
		`= t/2 ("e"^t+1)/("e"^t-1)`
	</span>
	是偶函数, 即得到结论.
</p>

<p class="corollary">
	<span class="formula">
		`t/2 ("e"^t+1)/("e"^t-1)`
		`= sum_(n=0)^oo B_(2n) t^(2n)/((2n)!)`.
	</span>
</p>

<p class="example">
	作为 Bernoulli 数的一个应用, 给出若干三角函数的 Maclaurin 展式:
</p>

<table>
	<tr>
		<td>`coth x = sum_(n=0)^oo B_(2n) (4^n x^(2n-1))/((2n)!)`,</td>
		<td>`|x| lt pi`</td>
	</tr>
	<tr>
		<td>`cot x = sum_(n=0)^oo B_(2n) ((-4)^n x^(2n-1))/((2n)!)`,</td>
		<td>`|x| lt pi`</td>
	</tr>
	<tr>
		<td>`tanh x = sum_(n=1)^oo B_(2n) (4^n(4^n-1) x^(2n-1))/((2n)!)`,</td>
		<td>`|x| lt pi/2`</td>
	</tr>
	<tr>
		<td>`tan x = sum_(n=1)^oo B_(2n)((-4)^n(1-4^n) x^(2n-1))/((2n)!)`,</td>
		<td>`|x| lt pi/2`</td>
	</tr>
</table>

<p class="proof">
	<span class="formula">
		`coth x`
		`= ("e"^(2x)+1)/("e"^(2x)-1)`
		`= 1/x sum_(n=0)^oo B_(2n) (2x)^(2n)/((2n)!)`
		`= sum_(n=0)^oo B_(2n)(4^n x^(2n-1))/((2n)!)`,<br/>
		`tanh x`
		`= ("e"^(2x)-1)/("e"^(2x)+1)`
		`= 2("e"^(4x)+1)/("e"^(4x)-1) - ("e"^(2x)+1)/("e"^(2x)-1)`
		`= sum_(n=1)^oo (4^n(4^n-1) B_(2n))/((2n)!) x^(2n-1)`.
	</span>
	再利用
	<span class="formula">
		`cot x = "i" coth("i"x)`,
		`quad tan x = -"i" tanh("i"x)`,
	</span>
	即得到 `cot x`, `tan x` 的展式.
	类似地, 还可以通过恒等式
	<span class="formula">
		`csc x = cot x + tan{:x/2:}`
	</span>
	得到展式
	<span class="formula">
		`csc x = sum_(n=0)^oo B_(2n) ((-1)^n (2-4^n) x^(2n-1))/((2n)!)`,
		`quad |x| lt pi`.
	</span>
	等等.
</p>

<p class="corollary">
	<b>`B_n^-` 的递推公式</b>
	在 `B_n^+` 的递推公式
	<span class="formula">
		`n = sum_(k=0)^(n-1) ((n),(k)) B_k^+`,
		`quad n ge 1`.
	</span>
	两边同时减 `n`, 有
	<span class="formula">
		`0 = sum_(k=0)^(n-1) ((n),(k)) B_k^-`, `quad n ge 2`,
		<span class="label" id="for-Bn--recur"></span>
	</span>
	由这个递推公式立即得到: `n ge 1` 时, `B_(2n)` 的符号是正负交错的.
	因此 `tan x` 的 Maclaurin 展开系数全为正, 等等.
</p>

<p>	利用递推公式计算前几个 Bernoulli 数如下:</p>

<table style="font-size:.85em;text-align:center">
	<tr>
		<td>`n`</td>
		<td>`0`</td>
		<td>`1`</td>
		<td>`2`</td>
		<td>`4`</td>
		<td>`6`</td>
		<td>`8`</td>
		<td>`10`</td>
		<td>`12`</td>
		<td>`14`</td>
		<td>`16`</td>
		<td>`18`</td>
		<td>`20`</td>
	</tr>
	<tr>
		<td>`B_n^+`</td>
		<td>`1`</td>
		<td>`1/2`</td>
		<td>`1/6`</td>
		<td>`-1/30`</td>
		<td>`1/42`</td>
		<td>`-1/30`</td>
		<td>`5/66`</td>
		<td>`-691/2730`</td>
		<td>`7/6`</td>
		<td>`-3617/510`</td>
		<td>`43867/798`</td>
		<td>`-174611/330`</td>
	</tr>
</table>

<p class="definition">
	<b>Bernoulli 多项式</b> `B_n(x)` (`n ge 0`) 由指数型生成函数
	<span class="formula">
		`(t "e"^(x t))/("e"^t-1) = sum_(n=0)^oo B_n(x) t^n/(n!)`,
		`quad |t| lt 2pi`
	</span>
	定义. 联系两类 Bernoulli 数的生成函数知,
	第一类 Bernoulli 数是 Bernoulli 多项式的常数项,
	第二类 Bernoulli 数是 Bernoulli 多项式的各项系数之和:
	<span class="formula">
		`B_n^(-) = B_n(0)`, `quad B_n^+ = B_n(1)`.
	</span>
</p>

<script src="../js/note.js?type=math"></script>

</body>

</html>
