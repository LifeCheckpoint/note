<!DOCTYPE html>
<html lang="zh-cn">

<head>

<title>三角函数</title>
<meta charset="utf-8" />

<link rel="stylesheet" type="text/css" href="../css/note.css" />

</head>

<body>

<h2>三角恒等式</h2>

<h4>特殊角</h4>

<span class="formula">
	`cos n pi = (-1)^n`,<br/>
</span>

<h4>勾股定理</h4>

<span class="formula">
	`sin^2 x + cos^2 x = 1`,
	`quad tan^2 x + 1 = 1 // cos^2 x`,
	`quad 1 + cot^2 x = 1 // sin^2 x`,<br/>
	`sec^2 x + csc^2 x = sec^2 x csc^2 x`.
</span>

<h4>周期性</h4>

<span class="formula">
	`sin(x+2pi) = sin x`,
	`quad cos(x+2pi) = cos x`,
	`quad tan(x+pi) = tan x`.
</span>

<h4>反射变换</h4>

<span class="formula">
	`sin(-x) = -sin x`,
	`quad cos(-x) = cos x`,
	`quad tan(-x) = -tan x`,<br/>
	`sin(pi-x) = sin x`,
	`quad cos(pi-x) = -cos x`,
	`quad tan(pi-x) = -tan x`,<br/>
	`sin(pi/2-x) = cos x`,
	`quad tan(pi/2-x) = cot x`,
	`quad tan(pi/4-x) = (1-tan x)/(1+tan x)`.
</span>

<h4>平移变换</h4>

<span class="formula">
	`sin (x + (k pi)/2) = sin x, cos x, -sin x, -cos x`,
	`k = 0, 1, 2, 3`.
</span>

<h4>和角公式</h4>

<span class="formula">
	`sin (x +- y) = sin x cos y +- cos x sin y`,<br/>
	`cos (x +- y) = cos x cos y &mp; sin x sin y`,<br/>
	`tan (x +- y) = (tan x +- tan y) / (1 &mp; tan x tan y)`,<br/>
	`cot (x +- y) = (cot x cot y &mp; 1) / (cot y +- cot x)`.
</span>

<h4>倍角公式</h4>

<span class="formula">
	`sin 2x = 2 sin x cos x`,
	`quad cos 2x = cos^2 x - sin^2 x`
	`= 1 - 2 sin^2 x`
	`= 2 cos^2 x -1`,<br/>
	`sin 3x = 3 sin x - 4 sin^3 x`
	`= 4 sin x sin(pi/3-x) sin(pi/3+x)`,<br/>
	`cos 3x = 4 cos^3 x - 3 cos x`
	`= 4 cos x cos(pi/3-x) cos(pi/3+x)`,<br/>
	`tan 3x = (3tan x - tan^3 x)/(1-3tan^2 x)`
	`= tan x tan(pi/3-x) tan(pi/3+x)`.
</span>

<h4>半角公式</h4>

<span class="formula">
	`sin^2 x = (1 - cos 2x)//2`,
	`quad cos^2 x = (1 + cos 2x)//2`,
	`quad tan^2 x = (1 - cos 2x)/(1 + cos 2x)`,<br/>
	`tan{:(x+y)/2:} = (sin x + sin y)/(cos x + cos y)`
	`= - (cos x - cos y)/(sin x - sin y)`,<br/>
	`tan{:x/2:} = csc x - cot x = (1 - cos x)/(sin x)`
	`= (sin x)/(1 + cos x) = (csc x + cot x)^-1`,<br/>
	`tan(pi/4 +- x/2) = sec x +- tan x`,<br/>
	`1 +- sin 2x = (sin x +- cos x)^2`,<br/>
	`(1 - sin 2x)/(1 + sin 2x) = ((1 - tan x)/(1 + tan x))^2`.
</span>

<h4>和差化积</h4>

<span class="formula">
	`sin x +- sin y = 2 sin{:(x+-y)/2:} cos{:(x&mp;y)/2:}`,<br/>
	`cos x + cos y = 2 cos{:(x+y)/2:} cos{:(x-y)/2:}`,<br/>
	`cos x - cos y = 2 sin{:(x+y)/2:} sin{:(x-y)/2:}`.
</span>

<h4>积化和差</h4>

<span class="formula">
	`2 sin x cos y = sin(x+y) + sin(x-y)`
	`= sin(y+x) - sin(y-x)`,<br/>
	`2 cos x cos y = cos(x-y) + cos(x+y)`,<br/>
	`2 sin x sin y = cos(x-y) - cos(x+y)`,<br/>
	`tan x tan y = (cos(x-y) - cos(x+y))/(cos(x-y)-cos(x+y))`.
</span>
<p>
	<span class="formula">
		`prod_(k=1)^n cos x_k = 1/2^n sum_(e in S)
		cos(e_1 x_1 + cdots + e_n x_n)`,
	</span>
	其中 `S = {1, -1}^n`.
</p>

<h4>辅助角公式</h4>

<span class="formula">
	`A sin x + B cos x = sqrt(A^2+B^2) sin(x+varphi)`,
	`quad tan varphi = B/A`;<br/>
	`(1 + C tan x)/(C - tan x) = tan (x+varphi)`,
	`quad cot varphi = C`.
</span>

<h4>万能代换</h4>

<p>	令 `t = tan {:x/2:}`, 有 `x = 2 arctan t`, 从而
	<span class="formula">
		`dx = (2 dt)/(1+t^2)`,
		`quad sin x = (2t)/(1+t^2)`,
		`quad tan x = (2t)/(1-t^2)`,
		`quad cos x = (1-t^2)/(1+t^2)`,
		`quad "e"^("i"x) = (1+"i"t)/(1-"i"t)`.
	</span>
</p>

<h4>三角形中的恒等式</h4>

<p>	设 `x + y + z = pi`, 则
	<span class="formula">
		`sin x + sin y + sin z = 4 cos{:x/2:} cos{:y/2:} cos{:z/2:}`,<br/>
		`cos x + cos y + cos z = 4 sin{:x/2:} sin{:y/2:} sin{:z/2:} +
		1`,<br/>
		`tan x + tan y + tan z = tan x tan y tan z`,<br/>
		`sin 2x + sin 2y + sin 2z = 4 sin x sin y sin z`,<br/>
		`cos 2x + cos 2y + cos 2z = -4 cos x cos y cos z - 1`,<br/>
		`tan{:y/2:} tan{:z/2:} + tan{:z/2:} tan{:x/2:} +
		tan{:x/2:} tan{:y/2:} = 1`,<br/>
		`cot{:x/2:} + cot{:y/2:} + cot{:z/2:} = cot{:x/2:} cot{:y/2:}
		cot{:z/2:}`,<br/>
		`sin^2 x + sin^2 y + sin^2 z = 2 cos x cos y cos z + 2`,<br/>
		`cos^2 x + cos^2 y + cos^2 z = -2 cos x cos y cos z + 1`,<br/>
		`sin^2{:x/2:} + sin^2{:y/2:} + sin^2{:z/2:} + 2 sin{:x/2:}
		sin{:y/2:} sin{:z/2:} = 1`.
	</span>
</p>

<p>	(Ptolemy 定理) 设 `sum_(n=0)^3 x_n = pi`, 则
	<span class="formula">
		`sin x_0 sin x_2 + sin x_1 sin x_3 = sin(x_i+x_j) sin(x_j+x_k)`.
	</span>
	其中 `j -= i+1 (mod 4)`, `k -= j+1 (mod 4)`.
</p>

<h2>Chebyshev 多项式系与幂函数系的相互表示</h2>

<h3>De Moivre 定理与 `n` 倍角公式</h3>

<p>	De Moivre 定理是下面的恒等式:
	<span class="formula">
		`(cos x + "i"sin x)(cos y + "i"sin y)`
		`= cos(x+y) + "i"sin(x+y)`.
	</span>
	`AA n in ZZ`, 对 `n` 作归纳得到
	<span class="formula">
		`(cos x + "i"sin x)^n = cos nx + "i" sin nx`.
	</span>
	上式左边展开, 分别取实部和虚部就得到 (François Viète):
	<span class="formula">
		`sin n x = sum_(j" odd") (-1)^((j-1)/2)
		((n),(j)) cos^(n-j) x sin^j x`,<br/>
		`cos n x = sum_(j" even") (-1)^(j/2)
		((n),(j)) cos^(n-j) x sin^j x`.
	</span>
</p>

<h3>Chebyshev 多项式</h3>

<p>	让我们换一个角度来求 `n` 倍角. 使用和差化积公式,
	便得到求 `n` 倍角正余弦值的 Chebyshev 算法:
	<span class="formula">
		`cos n x = 2 cos x cos(n-1)x - cos(n-2)x`,<br/>
		`sin n x = 2 cos x sin(n-1)x - sin(n-2)x`.
	</span>
	而初始条件为
	<span class="formula">
		`cos 0 x = 1`, `quad cos 1 x = cos x`,<br/>
		`sin 0 x = 0`, `quad sin 1 x = sin x`.
	</span>
	容易看出 `cos n x` 可以被表为 `cos x` 的多项式, 称为
	<b>(第一类) Chebyshev 多项式</b>:
	<span class="formula">
		`cos n x = T_n(cos x)`.
	</span>
	类似地, `U_n` 称为 <b>第二类 Chebyshev 多项式</b>:
	<span class="formula">
		`(sin n x)/(sin x) = U_(n-1)(cos x)`.
	</span>
	<!--
	另外, `S_n` 称为 <b>spread polynomial</b>:
	<span class="formula">
		`sin^2 n x = S_n(sin^2 x)`.
	</span>
	-->
</p>

<p>	Chebyshev 多项式的递归定义:
	<span class="formula">
		`T_n(c) = {
			(0, if n = 0),
			(c, if n = 1),
			(2c T_(n-1)(c) - T_(n-2)(c), if n ge 2)
		:}`
	</span>
	容易证明, Chebyshev 多项式的各次项系数之和等于 1.
	同样, 第二类 Chebyshev 多项式的递归定义为:
	<span class="formula">
		`U_(n-1)(c) = {
			(0, if n = 0),
			(1, if n = 1),
			(2c U_(n-2)(c) - U_(n-3)(c), if n ge 2)
		:}`
	</span>
</p>

<table>
	<caption>Chebyshev 多项式</caption>
	<tr>
		<td>`n`</td>
		<td>`c_n := T_n(c)`</td>
		<td>`s_n//s := U_(n-1)(c)`</td>
	</tr>
	<tr>
		<td>`0`</td>
		<td>`1`</td>
		<td>`0`</td>
	</tr>
	<tr>
		<td>`1`</td>
		<td>`c`</td>
		<td>`1`</td>
	</tr>
	<tr>
		<td>`2`</td>
		<td>`2c^2-1`</td>
		<td>`2c`</td>
	</tr>
	<tr>
		<td>`3`</td>
		<td>`4c^3 - 3c`</td>
		<td>`4c^2-1`</td>
	</tr>
	<tr>
		<td>`4`</td>
		<td>`8c^4 - 8c^2 + 1`</td>
		<td>`8c^3 - 4c`</td>
	</tr>
	<tr>
		<td>`5`</td>
		<td>`16c^5 - 20c^3 + 5c`</td>
		<td>`16c^4 - 12c^2 + 1</td>
	</tr>
</table>

<h3>Chebyshev 多项式的反向表示</h3>

<p>	现在考虑 Chebyshev 多项式的反向表示, 亦即
	`sin^n x`, `cos^n x` 的 Fourier 级数.  记
	<span class="formula">
		`s_n = sin n x`, `quad c_n = cos n x`, `quad n = 0, 1, 2, cdots`.
	</span>
	利用积化和差公式
	<span class="formula">
		`2 c_m c_n = c_(m+n) + c_|m-n|`,<br/>
		`2 s_m s_n = c_|m-n| - c_(m+n)`,<br/>
		`2 s_m c_n = s_(m+n) + sgn(m-n) s_|m-n|`
	</span>
	和初始条件
	<span class="formula">
		`cos^0 x = 1`, `cos^1 x = c_1`, `sin^0 x = 1`, `sin^1 x = s_1`
	</span>
	我们有:
</p>

<table>
	<tr>
		<td>`n`</td>
		<td>`sin^n x`</td>
		<td>`cos^n x`</td>
	</tr>
	<tr>
		<td>`0`</td>
		<td>`c_0`</td>
		<td>`c_0`</td>
	</tr>
	<tr>
		<td>`1`</td>
		<td>`s_1`</td>
		<td>`c_1`</td>
	</tr>
	<tr>
		<td>`2`</td>
		<td>`(c_0 - c_2)//2`</td>
		<td>`(c_0 + c_2)//2`</td>
	</tr>
	<tr>
		<td>`3`</td>
		<td>`(3s_1 - s_3)//4`</td>
		<td>`(3c_1 + c_3)//4`</td>
	</tr>
	<tr>
		<td>`4`</td>
		<td>`(3c_0 - 4c_2 + c_4)//8`</td>
		<td>`(3c_0 + 4c_2 + c_4)//8`</td>
	</tr>
	<tr>
		<td>`5`</td>
		<td>`(10s_1 - 5s_3 + s_5)//16`</td>
		<td>`(10c_1 + 5c_3 + c_5)//16`</td>
	</tr>
</table>

<p>	容易看出每行的系数之和为 1. 系数三角形的规律为:
	最右一条斜线系数全为 1, 其余每一系数等于左上方与右上方两系数之和,
	但 `c_1` 的系数等于左上方系数的两倍与右上方系数之和.
</p>

<pre>
1
0  1
1  0  1
0  3  0  1
3  0  4  0  1
0  10 0  5  0  1
</pre>

<p>	利用这个结果可以轻松得出 `sin^n x`, `cos^n x` 的不定积分, 如
	<span class="formula">
		`int sin^5 x dx`
		`= 1/16 int (10 sin x - 5 sin 3 x + sin 5 x) dx`
		`= 1/16 (-10 cos x + 5/3 cos 3 x - 1/5 cos 5 x) + C`.
	</span>
</p>

<h2>反三角函数</h2>

<table>
	<tr>
		<td></td>
		<td>定义域</td>
		<td>值域</td>
	</tr>
	<tr>
		<td>`arcsin x`</td>
		<td>`[-1, 1]`</td>
		<td>`[-pi/2, pi/2]`</td>
	</tr>
	<tr>
		<td>`arccos x`</td>
		<td>`[-1, 1]`</td>
		<td>`[0, pi]`</td>
	</tr>
	<tr>
		<td>`arctan x`</td>
		<td>`(-oo, +oo)`</td>
		<td>`(-pi/2, pi/2)`</td>
	</tr>
	<tr>
		<td>`" arccot "x`</td>
		<td>`(-oo, +oo)`</td>
		<td>`(0, pi)`</td>
	</tr>
</table>

<p>	其中
	<span class="formula">
		`"arccot "x := {
			(arctan{:1/x:}, if x gt 0),
			(pi/2, if x = 0),
			(arctan{:1/x:}+pi, if x lt 0)
		:}`
	</span>
	因为上面 4 个反三角函数都在各自的定义域上单调,
	所以对所有定义域中的 `x`,
	<span class="formula">
		`sin arcsin x = x`.
	</span>
	其它三个类似.
</p>

<h4>互余关系, 反射变换</h4>

<span class="formula">
	`arcsin x + arccos x = pi/2`
	`quad arctan x + "arccot "x = pi/2`,<br/>
	`arcsin(-x) = -arcsin x`,
	`quad arctan(-x) = -arctan x`,<br/>
	`arccos(-x) + arccos x =  pi`,
	`quad "arccot"(-x) + "arccot" x = pi`.
</span>

<p class="proof">
	我们只证 `arcsin`, `arccos` 的相关公式. 先证明
	<span class="formula">
		`arcsin x = pi/2 - arccos x`.
	</span>
	考察 `arcsin x` 和 `arccos x` 的值域可知,
	上式两边之差的绝对值不超过 `2 pi`, 所以上式成立当且仅当
	<span class="formula">
		`sin arcsin x = sin (pi/2 - arccos x)`,
	</span>
	即 `x = cos arccos x`, 这显然成立.
	又 `arcsin x` 是 `sin x` 在对称区间 `[-pi/2, pi/2]` 上的反函数,
	而 `sin x` 为奇函数, 所以 `arcsin x` 也为奇函数. 最后
	<span class="formula">
		`arccos(-x) = pi/2 - arcsin(-x)`
		`= pi/2 + arcsin x = pi/2 + pi/2 - arccos x`.
	</span>
</p>

<h4>勾股互化</h4>

<p>	`x gt 0` 时, 通过画图容易得知</p>

<span class="formula">
	` arcsin x = arccos sqrt(1-x^2)`
	`= arctan {:x/sqrt(1-x^2):}`,<br/>
	`arccos x = arcsin sqrt(1-x^2)`
	`= arctan{:sqrt(1-x^2)/x:}`,<br/>
	`arctan x = arccos{:1/sqrt(1+x^2):}`
	`= arcsin{:x/sqrt(1+x^2):}`.
</span>

<p>	`x lt 0` 时, 令 `x = -y`, 再对 `y` 应用上述公式.
	适当利用反三角函数的反射变换.
	比如 `x lt 0` 时,
	<span class="formula">
		`arccos x = arccos(-y) = pi-arccos y`
		`= pi - arctan{:sqrt(1-y^2)/y:}`
		`= pi + arctan{:sqrt(1-x^2)/x:}`.
	</span>
</p>

<h4>反函数性质</h4>

<p>	前面已经提到,
	<span class="formula">
		`sin arcsin x = x`,
		`quad cos arccos x = x`,
		`quad tan arctan x = x`.
	</span>
	反之就比较复杂, 需要适当地作<b>平移变换</b>, 将 `x-n pi`
	落入反三角函数的值域中:
	<span class="formula">
		`arcsin sin x = (-1)^n (x-n pi)`, `quad |x-n pi| le pi/2,<br/>
		`arccos cos x = (-1)^n (x-n pi) + [n" odd"] pi`,
		`quad 0 le x-n pi le pi`,<br/>
		`arctan tan x = x-n pi`, `quad |x - n pi| lt pi/2`,<br/>
	</span>
	其中 `[n" odd"] = {(1, if n" is odd;"), (0, if n" is even."):}`
</p>

<p>	利用勾股互化, 得到
	<span class="formula">
		`cos arcsin x = sin arccos x = sqrt(1-x^2)`,
	</span>
	当然, 也可以从值域来考虑. 比如 `arcsin x` 值域是 `[-pi/2,
	pi/2]`, 而在这一区间上 `cos` 函数非负, 所以结果的符号为正.
</p>

<h4>差角公式</h4>

<p>
	介绍差角而不是和角, 是因为前者在数学分析中更常用.
	<span class="formula">
		`arcsin sin(arcsin x - arcsin y)`
		`= arcsin(x sqrt(1-y^2) - y sqrt(1-x^2))`,
		`arccos cos(arccos x - arccos y)`
		`= arccos(x y+sqrt(1-x^2) sqrt(1-y^2))`,
		`arctan tan(arctan x - arctan y)`
		`= arctan{:(x - y)/(1+x y):}`,
	</span>
	条件
	<span class="formula">
		`|arcsin x - arcsin y| le pi/2` `iff x y ge 0 or x^2+y^2 le 1`,
		<br/>
		`0 le arccos x - arccos y le pi` `iff x le y`,<br/>
		`|arctan x - arctan y| lt pi/2` `iff x y gt -1`.
	</span>
	分别成立时, 上面三个等式分别等于
	<span class="formula">
		`arcsin x - arcsin y`,
		`arccos x - arccos y`,
		`arctan x - arctan y`.
	</span>
</p>

<ol class="proof">
	我们来证明那些使公式成立的等价条件.
	<li>首先由 `arccos` 的值域为 `[0, pi]` 知 `arccos x - arccos y le pi`
		恒成立.
		又由 `arccos` 单调递减知 `arccos x - arccos y ge 0 iff x le y`.
	</li>
	<li>记 `a = arctan x`, `b = arctan y`, 由值域知
		`-pi/2 lt a, b lt pi/2`, 所以 `cos a, cos b gt 0`.
		若 `|a-b| lt pi/2`,
		<span class="formula">
			`0 lt cos(a-b) = cos a cos b + sin a sin b`
			`= cos a cos b(1 + tan a tan b)`
		</span>
		这推出 `x y+1 = tan a tan b + 1 gt 0`.
		反之若 `x y gt -1`, 可得 `cos(a-b) gt 0`
		但由 `-pi/2 lt a, b lt pi/2` 知 `|a-b| lt pi`,
		于是必有 `|a-b| lt pi/2`.
		这个条件的几何意义是, 若两角之差是锐角, 且两直线与 `x`
		轴正方向的夹角分别等于这两个角, 则两直线斜率之积大于 `-1`.
	</li>
	<li>记 `a = arcsin x`, `b = arcsin y`.  若 `|a-b| le pi/2`,
		<span class="formula">
			`0 le cos(a-b) = cos a cos b + sin a sin b`.
		</span>
		即
		<span class="formula">
			`-x y le sqrt(1-x^2) sqrt(1-y^2)`.
		</span>
		假设 `x y lt 0`, 上式化为
		<span class="formula">
			`|x y| le sqrt(1-x^2) sqrt(1-y^2)`,
		</span>
		两边平方得
		<span class="formula">
			`x^2 y^2 le (1-x^2)(1-y^2) = 1 - (x^2+y^2) + x^2 y^2`.
		</span>
		即
		<span class="formula">
			`x^2+y^2 le 1`.
		</span>
		反之, 若 `x y ge 0` 或 `x^2+y^2 le 1` 成立, 都可以推出
		<span class="formula">
			`-x y le sqrt(1-x^2) sqrt(1-y^2)`
		</span>
		成立, 这等价于 `cos(a-b) ge 0`, 从而等价于 `|a-b| le pi/2`.
	</li>
</ol>

<p>	条件不成立时, 使用平移变换. 比如, 取合适的 `n` 使得
	`|arcsin x - arcsin y - n pi| le pi/2`, 则
	<span class="formula">
		`arcsin sin(arcsin x - arcsin y)`
		`= (-1)^n (arcsin x - arcsin y - n pi)`
	</span>
	于是
	<span class="formula">
		`arcsin x - arcsin y`
		`= n pi + (-1)^n arcsin(x sqrt(1-y^2) - y sqrt(1-x^2))`.
	</span>
	另外, 利用反射变换可以得到
	<span class="formula">
		`arcsin x + arcsin y = arcsin x - arcsin(-y)`,<br/>
		`arccos x + arccos y = arccos x - arccos(-y) + pi`,<br/>
		`arctan x + arctan y = arctan x - arctan(-y)`.
	</span>
</p>

<!-- 放在哪里好呢???
<p>	其中 `sgn x = {(1, if x gt 0), (0, if x = 0), (-1, if x lt 0):}`.
	显然恒有 `x = sgn x |x|`, `x in RR`.
</p>
-->

<h2>双曲三角函数与反双曲三角函数</h2>

<h4>和角</h4>

<span class="formula">
	`sinh(x+-y) = sinh x cosh y +- sinh y cosh x`;<br/>
	`cosh(x+-y) = cosh x cosh y +- sinh x sinh y`;<br/>
	`tanh(x+-y) = (tanh x +- tanh y)/(1+-tanh x tanh y)`.
</span>

<h4>倍角公式</h4>

<span class="formula">
	`sinh 2x = 2 sinh x cosh x`;<br/>
	`cosh 2x = cosh^2 x + sinh^2 x` `= 2 cosh^2 x -1` `= 2 sinh^2 x +1`.
</span>

<h4>勾股定理</h4>

<span class="formula">
	`cosh^2 x = sinh^2 x + 1`;<br/>
	`1 = tanh^2 x + 1//cosh^2 x`;<br/>
	`1//tanh^2 x = 1 + 1//sinh^2 x`.
</span>

<h4>反双曲三角函数</h4>

<span class="formula">
	`"arsh "x = ln (x + sqrt(x^2+1))`, `quad x in RR`;<br/>
	`"arch "x = ln (x + sqrt(x^2-1))`, `quad x ge 1`;<br/>
	`"arth "x = 1/2 ln ((1+x)/(1-x))`, `quad -1 lt x lt 1`.
</span>

<h2>Euler 公式</h2>

<p>
	<span class="formula">
		`"e"^("i"x) = cos x + "i" sin x`, `quad AA x in CC`.
	</span>
	从而
	<span class="formula">
		`cos x = ("e"^("i"x) + "e"^(-"i"x))/2`,
		`quad sin x = ("e"^("i"x) - "e"^(-"i"x))/{2"i"}`.
	</span>
	且
	<span class="formula">
		`arccos x = -"i" ln (x + "i"sqrt(1-x^2))`,<br/>
		`arcsin x = -"i" ln (sqrt(1-x^2) + "i"x)`,<br/>
		`arctan x = -"i" ln {:(1 + "i"x)/sqrt(1+x^2):}`.
	</span>
</p>

<p class="remark">
	比如, 设 `y = arccos x`, 则
	<span class="formula">
		`"e"^("i"y) = cos y + "i"sin y = x + "i"sqrt(1-x^2)`,
	</span>
	于是 `y = -"i"ln (x + "i"sqrt(1-x^2))`.
</p>

<h2>杂例</h2>

<p class="example">
	证明 `x != 2m pi`, `m in ZZ` 时,
	<span class="formula">
		`sum_(k=1)^n cos kx`
		`= (cos {:((n+1)x)/2:} sin {:(nx)/2:}) / sin{:x/2:}`;<br/>
		` sum_(k=1)^n sin kx
		= (sin {:((n+1)x)/2:} sin {:(nx)/2:}) / sin {:x/2:}`.
	</span>
	从而对 `AA n in ZZ^+`,
	<span class="formula">
		`sum_(k=1)^n cos {:(2k pi)/n:}`
		`= sum_(k=1)^n sin {:(2k pi)/n:} = 0`.
	</span>
	这个等式的几何意义是,
	向量组 `bm e_k = ( cos {:(2k pi)/n:}, sin {:(2k pi)/n:} )`,
	`k = 1, 2, cdots, n`, 中所有向量之和为零.
</p>

<p class="proof">
	只证第一式. 第二式类似. 利用积化和差与和差化积:
	<span class="formula">
		`2 sin{:x/2:} sum_(k=1)^n cos kx`
		`=	sum_(k=1)^n [sin(k+1/2)x - sin(k-1/2)x]`
		`= sin(n+1/2)x - sin{:x/2:}`
		`= 2 cos {:((n+1)x)/2:} sin {:(nx)/2:}`.
	</span>
</p>

<p class="example">
	计算 `sin 20^@ * sin40^@ * sin80^@`.
</p>

<p class="solution">
	记 `x = 10^@`, 注意到 `sin 8x = cos x`, 利用积化和差, 上式即
	<span class="formula">
		`1/2 [ cos (4-2)x - cos (4+2)x ] cos x`
		`= 1/2 (cos 2 x - 1/2) cos x`
		`= 1/2 cos 2 x cos x - 1/4 cos x`
		`= 1/4 [ cos(2+1)x + cos(2-1)x ] - 1/4 cos x`
		`= (sqrt 3)/8`.
	</span>
</p>

<p class="example">
	计算 `1/(2sin 10^@) ( 3/(sin^2 40^@) - 1/(cos^2 40^@) )`.
</p>

<p class="solution">
	同样设 `x = 10^@`. 利用三倍角公式
	<span class="formula">
		` 1/2 = sin 3x`
		`= 3 cos^2 x sin x - sin^3 x`
		`= 3 sin x - 4 sin^3 x`.
	</span>
	消去 `sin^3 x` 后, 得到
	<span class="formula">
		`8 cos^2 x sin x = 2 sin x + 1`.
	</span>
	于是原式等于
	<span class="formula">
		`1/(2 sin x) ( 6/(1 - cos 8x) - 2/(1 + cos 8x) )`
		`= 1/sin x ( (3(1+sin x) - (1-sin x)) / ( 1-sin^2 x) )`
		`= (2(2sin x + 1)) / (sin x \ cos^2 x) = 16`.
	</span>
</p>

<p class="example">
	`prod_(n=1)^oo cos^{:x/2^n:} = (sin x)/x`.
</p>

<ol class="example">
	计算
	<li>`arctan 1 + arctan{:1/2:} + arctan{:1/3:}`;</li>
	<li>`4 arctan{:1/5:} - arctan{:1/239:}`.</li>
</ol>

<ol class="solution">
	利用等式
	<span class="formula">
		`arctan x + arctan y = arctan{:(x+y)/(1-xy):}`,
		`quad x y lt 1`.
	</span>
	<li>
		<span class="formula">
			原式 `= arctan 1 + arctan{:(1/2 + 1/3)/(1- 1/2 *1/3 ):}`
			`= arctan 1 + arctan 1 = pi/2`.
		</span>
	</li>
	<li>
		<span class="formula">
			`2 arctan{:1/5:} = arctan{:(2/5)/(1-1/25):} =
			arctan{:5/12:}`,<br/>
			`4 arctan{:1/5:} = 2 arctan{:5/12:}`
			`= arctan{:(5/6)/(1-25/144):} = arctan{:120/119:}`,<br/>
			原式
			`= arctan{:(120/119-1/239)/(1+1/239 120/119):} = arctan 1`
			`= pi/4`.
		</span>
	</li>
</ol>

<ol class="example">
	证明:
	<li>`2 arctan "e"^x - arctan sinh x = pi/2`;</li>
	<li>`2 arctan "e"^-x + arctan sinh x = pi/2`.</li>
</ol>

<p class="proof">
	只证第一式.
	注意到 `"e"^x * "e"^x lt 1` 未必成立, 不适合用公式
	<span class="formula">
		`arctan x + arctan y = arctan{:(x+y)/(1-x y):}`.
	</span>
	不过 `arctan" e"^x gt 0` 恒成立, 因此适合用 `"arccot"` 来刻画.
	<span class="formula">
		原式 `= "arccot"{:(1-"e"^(2x))/(2"e"^x):} - arctan sinh x`
		`= "arccot"(-sinh x) + arctan(-sinh x)`
		`= pi/2`.
	</span>
</p>

<p class="proof">
	只证第一式.  求导,
	<span class="formula">
		`2/(1+"e"^(2x)) "e"^x - 1/(1+sinh^2 x) cosh x`
		`= 1/(cosh x) - 1/(cosh x) = 0`.
	</span>
	从而原式恒为一常数. 取 `x = 0` 得 `pi/2`.
</p>

<ol class="example">
	证明
	<li>`2 arctan sqrt ((a-b)/(a+b))
		= arccos {: b/a :}`, `quad a ge |b|`;</li>
	<li>`arccos x = 2 arccos sqrt((1+x)/2) = 2 arcsin sqrt((1-x)/2)`.</li>
</ol>

<ol class="proof">
	<li>原式 `= arctan{:(2sqrt((a-b)/(a+b)))/(1-(a-b)/(a+b)):}`
		`= arctan{:(sqrt(a^2-b^2))/b:}`
		`= sgn b * arccos{:b/a:}`.
	</li>
</ol>

</body>

<script src="../js/note.js?type=math"></script>

</html>
