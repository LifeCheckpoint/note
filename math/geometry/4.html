<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <title>圆</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" type="text/css" href="../../css/note.css" />
</head>
<body>

<p class="theorem">
  <b>Apollonius 圆 (阿氏圆)</b>
  平面上到两定点距离之比为常数 `k` (`k gt 0`, `k != 1`) 的点的轨迹为圆.
  <span class="img md">
    <img src="../img/apollonius-circle.svg">
  </span>
</p>

<p class="proof">
  设这两个定点为 `A, B`, 线段 `AB` 长为 `l`.
  若平面上一点 `R` 满足 `RA = k RB`,
  则在直线 `AB` 上可取一点 `O`, 使得 `triangle ORA S~ triangle OBR`.
  由相似关系得
  <span class="formula">
    `OA * OB = OR^2`.
  </span>
  又
  <span class="formula">
    `OA = (OA)/(OR) * (OR)/(OB) * OB = k^2 OB`,<br>
    `OA = OB +- l` (`k gt 1` 时取 `+`, `0 lt k lt 1` 时取 `-`),
  </span>
  由此解得的 `OA, OB, OR` 均可用常数 `k, l` 表示, 即 `O` 点的位置与 `OR` 的长度均为定值,
  因此 `R` 的轨迹为一圆.
</p>

<p class="definition">
  <b>反演变换</b>
  设圆 `O` 的半径为 `r`.
  观察上图, `A, B` 两点位于 `O` 出发的同一条射线上, 且 `OA * OB = r^2`,
  我们称 `A, B` 关于圆 `O` 互为反演, `O` 为反演中心, `r` 为反演半径,
  圆 `O` 称为反演的参考圆.  显然, 一个点的反演的反演是其自身.
  反演变换的全体不动点就是参考圆上的点.
</p>

<div class="property">
  <b>反演变换将广义圆映为广义圆</b>
  除了将一个点映为另一个点,
  反演变换也可以将点集映为点集.
  常见情形如下:
  <table>
    <tr>
      <th>反演前</th>
      <th>反演后</th>
    </tr>
    <tr>
      <td>不过反演中心的圆</td>
      <td>仍是一个不过反演中心的圆</td>
    </tr>
    <tr>
      <td>过反演中心的圆</td>
      <td>不过反演中心的直线</td>
    </tr>
    <tr>
      <td>过反演中心的直线</td>
      <td>它自身</td>
    </tr>
  </table>
  可以为平面引入一个无穷远点 `oo`, 规定反演中心的像是 `oo`.
  直线可以视为过 `oo` 的, 半径无穷大的圆.
  这样一来, 以上结论简记为: 反演变换将广义圆映为广义圆.
  由于对应点在同一直线上, 圆与它的反演圆关于反演中心位似.
</div>

<p class="property">
  <b>反演变换是反向保角的</b>
  两条曲线的夹角 (交点处切线的夹角) 在反演变换后保持不变, 但角的定向发生改变 (顺时针变为逆时针).
</p>

<p class="property">
  <b>正交圆的反演像是自身</b>
  广义圆在反演变换下的像是自身当且仅当它是参考圆, 或与参考圆正交 (夹角为直角).
  一个特殊的正交情形是, 广义圆是通过反演中心的直线.
</p>

<ol class="proof">
  <li>
    `rArr`: 因为参考圆上的点都是不动点, 所以参考圆的反演像是自身.
    下设变换前的广义圆 `C` 与参考圆 `O` 不重合. 若圆 `C` 完全位于圆 `O` 外部,
    则它的像完全位于圆 `O` 内部, 反之亦然. 但圆 `C` 的像是自身, 因此圆 `C` 与圆 `O` 必有交点.
    假设两圆的夹角不是直角, 则反演后角的定向改变, 圆 `C` 不可能保持不动;
    因此两圆夹角必为直角.
  </li>
  <li>
    `lArr`: 反之若广义圆 `C` 与参考圆正交, 则由保角性, 反演像仍与参考圆正交, 且两个交点在反演下不动.
    由于过两个交点与参考圆正交的广义圆是唯一的 (在两个交点处作参考圆的切线,
    切线交点即为所求的圆心), 所以圆 `C` 保持不动.
  </li>
</ol>

<p class="remark">
  既然将直线视为特殊的圆, 我们也可以定义关于直线的反演.
  为了找到点 `P` 关于直线 `l` 的反演像, 过点 `P` 作两个圆与直线 `l` 正交
  (只需圆心在 `l` 上, 作出的圆就会与 `l` 正交),
  则 `P` 的像必为这两个圆的另一个交点, 即点 `P` 关于直线 `l` 的对称点.
</p>

<p class="construction">
  过不在圆 `O` 上的一点 `A` 可作无数个圆与圆 `O` 正交.
</p>

<p class="solution">
  [来自 言、我是阳光开朗的小白]
  在圆 `O` 上任取一点 `B` 作为交点. 作圆 `O` 在 `B` 处的切线 `l`, 由正交性,
  所求的圆心必定在直线 `l` 上. 但这个圆又过 `A, B` 两点, 所以它的圆心还在 `AB`
  中垂线上. 取两直线交点即为所求圆心.
</p>

<p class="property">
  <b>反演变换保持反演关系</b>
  设点 `A, B` 关于圆 `C` 互为反演, 现在将 `A, B`, 圆 `C` 一起关于另一个圆 `O` 反演,
  则反演像 `A', B'` 关于圆 `C'` 仍互为反演.
</p>

<p class="proof">
  过 `A` 可以作无数个圆与圆 `C` 正交, 由于正交圆的反演像是自身, 所以这些圆都通过点 `B`.
  任取其中两个圆 `D, E`, 由保角性, 它们关于圆 `O` 反演后的像 `D', E'` 仍与 `C'`
  正交. 而 `A', B'` 是这两个圆的交点, 因此关于圆 `C'` 互为反演.
</p>

<p class="property">
  在复平面上, 反演变换是<b>分式线性变换 (Möbius map)</b> 的一个特例.
  分式线性变换是指:
  <span class="formula">
    `f(z) = (a z+b)/(c z+d)`,
    `quad a, b, c, d in CC`,
    `quad a d - b c != 0`.
  </span>
</p>

<p class="proof">
  设 `f(z)` 表示点 `z` 关于以 `s = a+b"i"` 为心, `r` 为半径的圆的反演.
  先设 `s = 0`, 有 `f(z) = r^2//z`. 一般情形的反演可以先平移到原点进行,
  再平移回去, 即
  <span class="formula">
    `f(z) = r^2/(z-s) + s`
    `= (s z+r^2-s^2)/(z-s)`,
  </span>
  这是分式线性变换.<br/>
  反之, 对任意分式线性变换 `f(z) = (a z+b)/(c z+d)`,
  于是当 `c != 0` 时,
  <span class="formula">
    `f(z) = 1/c((b c - a d)/(c z+d) + a)`,
  </span>
  相当于反演变换与平移、伸缩变换的复合.
</p>

<!--
<p class="remark">
  特别取 `s = r`, 则
  <span class="formula">
    `lim_(r to oo) f(z)`
    `= lim_(r to oo) (s z + r^2 - s^2)/(z - s)`
    `= -z`,
  </span>
  这再次说明关于直线的反演像其实就是关于直线的对称点.
</p>
-->

<script src="../../js/note.js?type=math"></script>
</body>
</html>
