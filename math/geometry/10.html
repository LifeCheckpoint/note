<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8" />
  <title>射影几何</title>
  <link rel="stylesheet" href="../../css/note.css"/>
</head>

<body>

<p>[来自《射影几何入门》]</p>

<h2>射影空间</h2>

<p>
  我们的讨论将在射影平面 `P(RR^2)` 和射影空间 `P(RR^3)` 中进行.
  射影平面和欧氏平面 `RR^2` 的区别在于, 它比 `RR^2` 多了无穷远点和无穷远直线的概念.
</p>
<p>
  在 `RR^2` 上考虑直线 `l` 和直线外一点 `P`. 我们把过 `P` 的全体直线组成的直线束仍记为 `P`.
  任取 `Q in l`, 则点 `Q` 完全决定了直线束中的一条直线 `PQ`.
  然而直线束中有一条直线在 `l` 上找不到对应的点, 那就是与 `l` 平行的那条直线.
  为弥补这个缺憾, 我们规定这条直线与 `l` 上的<b>无穷远点</b>对应, 从而在直线 `l` 与线束 `P`
  之间建立了双射, 这个双射就称为直线与线束间的<b>透视对应</b>,
  我们称这样的直线与线束是<b>相互透视</b>的.
</p>
<p>
  注意, 要使双射成立, 我们引入的直线 `l` 的无穷远点必须唯一,
  即不论向直线的哪个方向走到「尽头」, 最终都会到达同一个无穷远点.
  为 `RR^2` 上的每条直线都引入一个无穷远点, 最后, 再规定所有这些无穷远点组成一条<b>无穷远直线</b>.
  这样一来, 我们可以说, 射影平面上任意两条不同直线有唯一的交点; 特别地, 两条平行直线相交于无穷远点,
  直线与无穷远直线的交点是它的无穷远点.
</p>
<p>
  若干透视对应的复合称为<b>射影对应</b>, 比如平面上有多个直线与线束, 其中 `l_1` 与 `S_1` 透视,
  `S_1` 与 `l_2` 透视, `l_2` 又与 `S_3` 透视..., 那么所有这些直线与线束都是<b>相互射影</b>的.
</p>

<p class="remark">
  射影平面上的直线又称为<b>点列</b>, 这个名字强调了直线是点的集合.
</p>

<p>
  再看射影空间 `P(RR^3)`. 我们为 `RR^3` 的每条直线都引入一个无穷远点, 这些无穷远点全体组成一个无穷远平面. 无穷远平面和另一个平面的交点组成后者的无穷远直线.
  于是, `P(RR^3)` 中任意两个不同平面有唯一的交线; 特别地, 两平行平面相交于无穷远直线.
  `P(RR^3)` 中直线与平面有唯一的交点; 当直线与平面平行时, 它们相交于直线的无穷远点.
  `P(RR^3)` 中两条不同直线有 0 或 1 个交点; 两平行直线相交于无穷远点,
  两异面直线的无穷远点不相同, 因而没有交点.
</p>

<h3>射影空间的可视化</h3>

<p>我们专门讨论 `P(RR^2)` 的四种可视化.</p>

<div class="img md">
  <img src="../img/PR2.png">
</div>

<h4>线束模型</h4>

<p>在 `RR^3` 中, 将 `xOy` 平面上一点 `P(x, y, 0)` 抬升到 `P_1(x, y, 1)`, 它唯一确定了<b>线束 `O`</b> (即, 通过原点的全体直线) 中的一条直线 `l = OP_1`:
  <span class="formula">
    `RR^2 to 线束 O`<br>
    `(x, y) mapsto l: OP_1`.
  </span>
  与平面上的无穷远点对应的, 是线束 `O` 中位于平面 `xOy` 上的那些直线, 这些直线与平面 `z = 1` 平行, 无法用刚才的几何方法得到.
  在线束模型中, 线束 `O` 代表射影空间 `P(RR^2)`, 线束 `O` 中的一条直线代表 `P(RR^2)` 中的一点.
</p>

<h4>球面模型</h4>

<p>在线束模型中, 取线束 `O` 中直线 `l` 与单位球面 `S^1` 的交点 `A_1, B_1`, 得到映射
  <span class="formula">
    `RR^2 to S^1`<br>
    `(x, y) mapsto +-(x, y, 1) // sqrt(x^2 + y^2 + 1)`.
  </span>
  每条直线与 `S^1` 有两个交点, 它们位于一条直径的两端, 称为一组对径点.
  我们把这两点等同起来, 代表射影空间 `P(RR^2)` 中的同一点.
  与无穷远点对应的, 是 `S^1` <b>赤道</b> (即它与 `xOy` 平面相交的部分, 平面 `xOy` 上的单位圆) 上的点, 
  在球面模型中, 单位球面上的全体对径点代表射影空间 `P(RR^2)`, 每组对径点代表 `P(RR^2)` 中的一点.
</p>

<h4>半球模型</h4>

<p>在球面模型中, 我们只取对径点 `A_1, B_1` 中 `z ge 0` 的那一个 (`A_1`), 得到映射
  <span class="formula">
    `RR^2 to S^1_(z ge 0)`<br>
    `(x, y) mapsto (x, y, 1) // sqrt(x^2 + y^2 + 1)`.
  </span>
  这样除了赤道外, `RR^2` 中的点与上半球面的点一一对应. 而赤道上和球面模型相同:
  每组对径点对应一个无穷远点.
</p>

<h4>圆盘模型</h4>

<p>把半球模型「拍平」到单位圆盘 `D^2` 中, 得到映射
  <span class="formula">
    `RR^2 to D^2`<br>
    `(x, y) mapsto (x, y) // sqrt(x^2 + y^2 + 1)`.
  </span> 
  `RR^2` 中的点与 `D^2` 的内点一一对应. 而 `D^2` 边界上的每组对径点对应一个无穷远点.
</p>

<p class="remark">
  本节对射影空间的四种可视化仅用于说明射影空间定义的合理性, 并帮助理解射影空间的结构.
  在以下的叙述与插图中, 为直观起见, 我们通常仍使用 `RR^2` 的视角来描绘射影空间,
  并想象它在无穷远处有一条直线.
</p>

<h2>Desargues 定理, 四调和点</h2>

<p class="theorem">
  <b>Desargues (笛沙格) 定理</b>
  对两个三角形 `ABC` 和 `A'B'C'`,
  设 `A B nn A'B' = P`, `B C nn B'C' = Q`, `C A nn C'A' = R`, 则有
  <span class="formula">
    `A A'`, `B B'`, `C C'` 三线共点 `iff` `P, Q, R` 三点共线.
  </span>
</p>

<div class="img md">
  <img src="../img/desargues.png">
</div>

<ol class="proof">
  采用「升维法」.
  <li>
    `rArr`.
    把上图想象为一个三维立体图形, `M` 是三棱锥的顶点, 三角形 `ABC` 和 `A'B'C'` 是三棱锥的两个截面.
    直线 `AB`, `A'B'` 位于三棱锥的同一侧面 `MAB` 上, 因而它们必有交点 `P`.
    由立体几何知道, `P` 点位于平面 `ABC` 和 `A'B'C'` 的交线上.
    同理 `Q, R` 也位于同一直线上, 即三点共线.
    现在把三维图形投影到平面上, `P, Q, R` 共线的关系不变, 这证明了定理的一半.
  </li>
  <li>
    `lArr`. 把 `Q` 看作三棱锥的顶点, 对三角形 `PBB'` 和 `RC C'` 应用定理的前半部分,
    可知 `BB'`, `C C'` 的交点与 `A A'` 共线, 即三线共点.
  </li>
</ol>

<p class="definition">
  <b>完全四边形</b>
  在平面上, 连接四边形的两条对角线, 这两条直线连同原来的四条边一共 6 条直线, 组成的图形称为完全四边形.
  或者, 将平面上四点两两连接得到的图形就叫做完全四边形.
  完全四边形共有三组对边: 除了原四边形的两组对边外, 我们把两条对角线也看作一组对边.
</p>

<ol class="theorem">
  <b>四调和点定理</b>
  在直线 `l` 上给定 `A, B, C` 三点,
  则存在完全四边形 `KLMN` 满足:
  <li>对边 `KL`, `MN` 交于点 `A`;</li>
  <li>对边 `LM`, `NK` 交于点 `C`;</li>
  考查剩下一组对边 `LN` 与 `KM`.
  若 `LN` 与直线 `l` 交于 `B`, 则 `KM` 与直线 `l` 的交点 `D` 完全由 `A, B, C` 的位置决定,
  不依赖于完全四边形 `KLMN` 的形状.
</ol>

<div class="img md">
  <img src="../img/harmonic-points.png">
</div>

<ol class="proof">
  <li>完全四边形的作法如下:
    在直线外任取点 `L`, 连接 `AL`, `BL`, `CL`;<br>
    在 `CL` 上任取点 `M`, 连接 `AM`, 交 `BL` 于 `N`;<br>
    连接 `CN` 交 `AL` 于 `K`.
    由于点 `L, M` 的任意性, 这样的完全四边形有无穷多个.
  </li>
  <li>
    设 `KLMN`, `K'L'M'N'` 是两个满足题意的完全四边形: 其中
    两组对边 `KL`, `K'L'`, `MN`, `M'N'` 交于同一点 `A`;
    另外两组对边 `LM`, `L'M'`, `NK`, `N'K'` 交于同一点 `C`;
    `LN`, `L'N'` 交于 `B`.
    我们要证 `KM`, `K'M'` 与直线 `l` 的交点是同一点,
    可设 `KM`, `K'M'` 的交点是 `D`, 下证 `A, B, C, D` 四点共线.
  </li>
  <li>
    考察三角形 `KLN` 和 `K'L'N'`, 因为 `A, B, C` 共线, 由 Desargues 定理逆定理知道
    `K K'`, `L L'`, `N N'` 三线共点, 设交点为 `S`.
    同理 `L L'`, `M M'`, `N N'` 三线也交于同一点 `S`,
    于是 `K K'`, `L L'`, `M M'` 三线也交于 `S`.
    由 Desargues 定理知道 `A, C, D` 三点共线.
  </li>
</ol>

<p class="remark">
  四调和点定理表明,
  在直线上任取 `A, B, C` 三点, 可以作出一点 `D`, 它的位置完全由 `A, B, C` 的位置决定.
  我们称这样的四点 `A, B, C, D` 为四调和点.
  由于定理的叙述中 `B, D` 两点位置对等, 我们也称 `B, D` 关于 `A, C` 调和共轭,
  或者称 `B, D` 两点调和分割线段 `AC`.
</p>

<p class="theorem">
  <b>调和共轭的对称性</b>
  如果 `B, D` 关于 `A, C` 调和共轭, 则 `A, C` 也关于 `B, D` 调和共轭.
</p>

<div class="img md">
  <img src="../img/harmonic-conjugate.png">
</div>

<p class="proof">
  设 `B, D` 关于 `A, C` 调和共轭, 相应的完全四边形是 `KLMN`.
  记对边 `KM`, `LN` 的交点为 `O`, 连接 `AO`, `CO`, 这两条直线把四边形 `KLMN` 分为四个四边形.
  我们看其中的一个 `KPOQ`, 它的一组对边 `PK`, `OQ` 通过点 `A`,
  另一组对边 `PO`, `KQ` 通过点 `C`, 又 `KO` 通过点 `D`, 于是由 `B, D` 关于 `A, C` 调和共轭知,
  `PQ` 过点 `B`. 考察其它三个小四边形, 同理得 `SR` 过点 `B`, `PS`, `QR` 过点 `D`.
  现在, 完全四边形 `PQRS` 的一组对边过点 `B`, 另一组对边过点 `D`, 其剩下的一组对边分别过 `A, C`.
  这说明 `A, C` 关于 `B, D` 调和共轭.
</p>

<p class="theorem">
  <b>四调和点的射影不变性</b>
  设直线 `l` 上的 `A, B, C, D` 为四调和点, 将 `l` 射影对应到直线 `l'`, 则对应点 `A', B', C', D'` 也是四调和点.
</p>

<p class="proof">
  如图, 线束
</p>

<!--

<h2>四调和点</h2>

<ol class="definition">
  <li>
    设 `a, b, c, d in CC uu {oo}`, 规定 `oo//oo = 1`, 这四点的<b>交比</b>定义为
    <span class="formula">
      `(a, b, c, d) := ((c-a)//(c-b)) / ((d-a)//(d-b))`.
    </span>
    交比也可以写成
    <span class="formula">
      `(AB, CD) = (AC//BC)/(AD//BD)`,
    </span>
    右边各线段是有向的, 要放在复平面上考虑.
  </li>
  <li>
    当四点的交比等于 -1 时, 称它们构成<b>四调和点</b>.
    我们也说 `AB` 调和分割 `CD`, `CD` 调和分割 `AB`, 或 `AB, CD` 调和共轭,
    因为两条线段地位是对称的.
  </li>
</ol>

<ol class="corollary">
  平面上有 `A, B, C, D` 四点, 以下各款等价
  <li>`(AB, CD) = -1`;</li>
  <li>`(AC)/(BC) + (AD)/(BD) = 0`;</li>
  <li>`AC * BD = AD * CB`;</li>
  第 3 个式子是最常用的.
</ol>

<p class="remark">
	若 `A, B, C, D` 是四调和点, `AC = x`, `AD = y`, `AB = z`. 计算得到
	<span class="formula">
		`z = (2x y)/(x+y), quad` 即 `1/z = 1/2 (1/x + 1/y)`.
	</span>
	这就是 "调和" 一词的由来.<br/>
</p>

<ol class="corollary">
	`A, B, C, D` 构成四调和点, `M` 是 `AB` 中点, 直接计算知
	<li>`AC * BD = AD * CB = AB * CD //2`;</li>
	<li>`CA * CB = CM * CD`;</li>
</ol>

<p class="theorem">
  <b>完全四边形</b>
  是指平面上一般位置的四条直线, 既没有直线平行, 也没有三线共点.
  完全四边形的每条对角线被另外两条对角线调和分割.<br/>
  如图, 在三角形 `ABC` 中, `R, Q` 分别在直线 `AB, AC` 上, `BQ, CR`
  交于点 `O`.  现在设 `AO, BC` 交于 `P`, `RQ, BC` 交于 `T`, 则 `BC`
  与 `PT` 调和共轭.
  <span class="img sm">
    <img src="../img/complete-quadrilateral.png"/>
  </span>
</p>

<p class="proof">
  在 `triangle ABC` 中使用 Menelaus 定理得
  <span class="formula">
    `(BT)/(TC) (CQ)/(QA) (AR)/(RB) = 1`,
  </span>
  使用 Ceva 定理得
  <span class="formula">
    `(BP)/(PC) (CQ)/(QA) (AR)/(RB) = 1`.
  </span>
  比较得 `(BT)/(TC) = (BP)/(PC)`, 即得结论.<br/>
  此外, 设 `AP, RT` 交于 `S`, 则在 `triangle AOB` 中应用两大定理可证
  `AO, SP` 调和共轭; 在 `triangle ARQ` 中应用两大定理可证 `RQ, ST`
  调和共轭.
</p>

<ol class="theorem">
	设直线上依次有 `A, C, B, D` 四点, 若以下命题中有两个为真,
	则四个命题都为真:
	<li>`A, B, C, D` 成四调和点;</li>
	<li>平面上存在一点 `O`, 使 `OC` 平分 `/_ AOB`;</li>
	<li>平面上存在一点 `O`, 使 `OC _|_ OD`;</li>
	<li>平面上存在一点 `O`, 使 `OD` 平分 `/_AOB` 的补角.</li>
</ol>

<ol class="proof">
  <li>易知 2, 3, 4 中的任意两个能推出第三个.</li>
  <li>下证 2, 3, 4 中的任意两个能推出全部四个命题, 只需证
    2, 3 `rArr` 1. 设 `/_ BOC = alpha`, `CB = 1`, `BD = y`,
    由 3,  `OB = sqrt y`, `tan alpha = 1/(sqrt y)`.
    又设 `AC = x`, 由 2, `tan 2 alpha = (x+1)/(sqrt y)`
    利用二倍角公式
    <span class="formula">
      `(x+1)/(sqrt y) = (2//sqrt y)/(1- 1//y)`,
    </span>
    化简得 `x y = x + y + 1`, 因此 `A, B, C, D` 为四调和点.
  </li>
  <li>若已知 2, 3, 4 中的一个和 1, 也可以推出其它命题, 不再赘述.</li>
</ol>

<h2>极点与极线</h2>

<ol class="definition">
  设二次曲线 `c` 外有一定点 `P`.
  过 `P` 作直线 `l` 与 `c` 交于 `M, N` 两点.
  在直线 `l` 上存在唯一的点 `Q` 使 `P, Q, M, N` 成四调和点,
  <li>称 `P, Q` 关于曲线 `c` 调和共轭, 注意到 `P, Q` 地位是对称的.</li>
  <li>令 `l` 绕 `P` 转动, `Q` 点的轨迹为一直线, 称为<b>极线</b>; `P`
    点则称为<b>极点</b>.  极点与极线是一一对应的.
  </li>
  当 `P` 在曲线 `c` 上时, 规定它的极线为 `P` 处的切线.
</ol>

<p class="proof">
  [来自 百度百科]
  用齐次坐标证明 `Q` 的轨迹为直线.
  设 `P = (p_1, p_2, p_3)'`, `Q = (q_1, q_2, q_3)'`,
  则 `l_(P Q)` 上任意一点坐标为 `Q + k P` (`k = oo` 时, `Q + k P = P`).
  将 `Q + k P` 代入 `c` 的方程 `bm x' bm A bm x = 0`
  (`bm x in RR^3`, `bm A` 是三阶实对称矩阵) 得
  <span class="formula">
    `(Q + k P)' bm A (Q + k P) = 0`,<br>
    `k^2 P' bm A P + 2 k (P'bm A Q) + Q' bm A Q = 0`.
  </span>
  设 `M = Q + m P`, `N = Q + n P`.  则 `m, n` 是上面关于 `k`
  的二次方程的两根. 注意到
  <span class="formula">
    `-1 = (PQ, MN) = m // n`, 即 `m + n = 0`,
  </span>
  由韦达定理有 `P'bm A Q = 0`, 即 `Q` 的轨迹是直线.
</p>

<p class="example">
  椭圆外一点的极线恰好是过该点的两切线确定的切点弦.
  用解析的语言, 椭圆 `x^2/a^2 + y^2/b^2 = 1` 外一点 `P(x_0, y_0)` 的极线方程是椭圆方程的半代入:
  <span class="formula">
    `(x_0 x)/a^2 + (y_0 y)/b^2 = 1`.
  </span>
</p>
-->

<script src="../../js/note.js?type=math"></script>
</body>
</html>
