<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8" />
  <title>代数数域和代数整数</title>
  <link rel="stylesheet" href="../../css/note.css"/>
</head>

<body>

<p>本章起进入代数数论的世界.
  读者可以先回顾一下<a href="../abstract/7.html">域</a>和
  <a href="../abstract/8.html">Galois 理论</a>的知识.
  代数数论研究的主要对象是<b>代数数域</b>, 即有理数域 `QQ` 的有限次扩张.
  任意代数数域均是 `QQ^(a c)` (全体代数数组成的域) 的子域, 从而是 `CC`
  的子域. 今后, 我们将代数数域简称为数域.
</p>

<h2>代数数域</h2>

<h3>二次域和分圆域</h3>

<p>这是研究得最多的两类数域, 在我们的下文中也时时见到它们的影子.</p>

<p class="example">
  <b>二次域</b> 是指 `QQ(sqrt d)`, 其中 `d` 不是平方数.
  `d gt 0` 时, 称为实二次域, `d lt 0` 时, 称为虚二次域.
  `QQ(sqrt d)` 中的元素形如 `u = a + b sqrt d`, 显然 `bar u = a - b sqrt d
  in QQ(sqrt d)`, 因此 `QQ(sqrt d)` 是 `QQ` 的二次 Galois 扩张.
</p>

<p class="example">
  求 `a = sqrt 2 + sqrt 3` 在 `QQ(sqrt 2, sqrt 3)` 的全体 `QQ`-共轭元.
</p>

<p class="solution">
  先求 `a` 在 `QQ` 上的最小多项式.
  <span class="formula">
    `a - sqrt 2 = sqrt 3`,<br>
    `a^2 - 2 sqrt 2 a + 2 = 3`,<br>
    `a^2 - 1 = 2 sqrt 2 a`,<br>
    `(a^2-1)^2 = 8a^2`.
  </span>
  最小多项式为 `f(x) = (x^2-1)^2 - 8x^2`.
  `f(x)` 的全部根为 `+-sqrt 2 +- sqrt 3`, 即为 `a` 的全体 `QQ`-共轭元.
</p>

<p class="example">
  <b><a href="3.html#3-4">分圆域</a></b> 是指 `QQ(zeta_n)`, 其中 `zeta_n`
  是 `n` 次本原单位根. `n ge 3` 时, 分圆域中含有虚数.
  `zeta_n` 的最小多项式是分圆多项式 `phi_n(x)`, 它的次数是 `varphi(n)`
  (Euler 函数).  又 `QQ(zeta_n)` 是 `x^n-1` 的分裂域, 因此它是 `QQ` 的
  `varphi(n)` 次 Galois 扩张.
</p>

<h3>单扩张定理</h3>

<ol class="remark">
  <b>单扩张</b>
  <li>设 `L = K(gamma)` 是域的 `n` 次扩张, 则 `gamma` 在 `K`
    上的最小多项式 `f` 是 `n` 次多项式. 由于我们讨论的数域都是特征为零的,
    因此 `f` 可分, 即没有重根. 设 `f` 的 `n` 个根为 `gamma = gamma_1,
    gamma_2, cdots, gamma_n in CC`, 它们称为 `gamma` 的 <b>`K`-共轭元</b>.
  </li>
  <li>每个共轭元 `gamma_i` 都决定一个单同态 `sigma_i: K to CC`, 其中
    `sigma_i` 保持 `K` 中的元素不动, 即 `AA a in K`, `sigma_i(a) = a`.
    这 `n` 个单同态称为 `L` 到 `CC` 的 <b>`K`-嵌入</b>, 每个同态像
    `sigma_i(L) = K(gamma_i)` 称为 `L` 的 <b>`K`-共轭域</b>.
    可以证明这些共轭域与生成元 `gamma` 的选取无关, 它们是域扩张 `L//K`
    自身的特性.
  </li>
  <li>特别当 `L//K` 是 Galois 扩张时, 这些 `K`-共轭域都相等 (都等于 `L`).
  </li>
</ol>

<p>好消息是, 数域的扩张均为单扩张.</p>

<p class="theorem">
  <b>单扩张定理</b>
  数域的扩张 `L//K` 必是单扩张, 即存在 `gamma in L` 使得 `L = K(gamma)`.
</p>

<p class="proof">
  只需证 `L = K(a, b)` 的情形, 一般情形 `L = K(omega_1, cdots, omega_n)`
  用归纳法可证. 令 `f, g` 分别是 `a, b` 在 `K` 上的最小多项式,
  它们的根分别是
  <span class="formula">
    `a = a_1, cdots, a_n`,
    `quad b = b_1, cdots, b_m`
  </span>
  由于 `f, g` 在 `K[x]` 中不可约, 所以它们无重根.
  考虑有限集合
  <span class="formula">
    `S = {(a_i-f_j)/(b_k-b_l)}`,
  </span>
  取 `c in Q\\S`, 则 `m n` 个复数 `a_i + c b_j` 两两不同. 我们取 `gamma = a
  + c b = a_1 + c b_1`, 下证 `L = K(gamma)`.<br>
  令 `h(x) = f(gamma - c x) in K(gamma)[x]`, 有 `h(b) = f(a) = 0`,
  且 `f(b_j) != 0`, `j = 2, cdots, m`, 因此在 `K(gamma)` 上有
  `(h(x), g(x)) = x - b`, 这证明了 `b in K(gamma)`, `a = gamma - c b in K(gamma)`. 于是 `K(a, b) sube K(gamma)`.<br>
  显然 `gamma = a + c b in K(a, b)`, 于是 `K(a, b) = K(gamma)`.
</p>

<p class="definition">
  <b>实嵌入与复嵌入</b>
  令 `K = QQ(gamma)` 为数域的 `n` 次扩张, `f` 为最小多项式,
  设 `f` 有 `r` 个实根 `gamma_1, gamma_2, cdots, gamma_r`
  和 `s` 对复根 `beta_1, bar beta_1, cdots, beta_s, bar beta_s`,
  其中 `r + 2 s = n`.
  则由 `f` 的实根确定的 `K` 到 `RR` 的嵌入称为 `K` 的<b>实嵌入</b>:
  <span class="formula">
    `sigma_i: K to RR`, `quad sigma_i(gamma) = gamma_i`,
  </span>
  由复根确定的 `K` 到 `CC` 的嵌入称为 `K` 的<b>复嵌入</b>:
  <span class="formula">
    `tau_i: K to CC`, `quad tau_i(gamma) = beta_i`;<br>
    `bar tau_i: K to CC`, `quad bar tau_i(gamma) = bar beta_i`.
  </span>
  如前述, 生成元 `gamma` 的取法可以不同, 但实嵌入与复嵌入的数目 `r`
  和 `s` 不变, 它们是数域 `K` 本身的性质.
  特别当 `s = 0` 时, `K` 的全体共轭域均为实域, 这时 `K` 称为<b>全实域</b>;
  `r = 0` 时, `K` 全体共轭域均为虚域, `K` 称为<b>全虚域</b>.
</p>

<ol class="example">
  当 `K//Q` 为 Galois 扩张时, `K` 的共轭域只有它自己, 因此:
  <li>`n ge 3` 时, 分圆域 `QQ(zeta_n)` 是全虚域;</li>
  <li>`d gt 0` 时, 二次域 `QQ(sqrt d)` 是全实域, `d lt 0` 时则是全虚域.</li>
</ol>

<h3>范与迹</h3>

<p class="definition">
  <b>元素的范与迹</b>
  考虑数域扩张 `L//K`. 将 `L` 视为 `K` 上线性空间, 任取 `alpha in L`, 则
  `alpha` 诱导的左平移变换
  <span class="formula">
    `varphi_alpha: L to L`<br>
    `x mapsto alpha x`
  </span>
  是 `L` 上的线性变换.
  由线性代数知道, 在不同的基底下, 线性变换 `varphi_alpha`
  的表示矩阵 `M_alpha` 的行列式与迹不变, 分别称为元素 `alpha` 对于扩张
  `L//K` 的<b>范 (norm)</b> `N_(L//K)(alpha)` 与<b>迹 (trace)</b>
  `T_(L//K)(alpha)`. 上下文明确时, 简记为 `N(alpha)` 和 `T(alpha)`.
</p>

<ol class="example">
  <li>对于 Gauss 数域 `QQ(sqrt(-1))`, 取 `QQ`-基 `[1, "i"]`, 有
    <span class="formula">
      `(a+b"i")[1, "i"]` `= [a+b"i", -b+a"i"]`;<br>
      `N(a+b"i") = |a, b; -b, a| = a^2+b^2`,
      `quad T(a+b"i") = 2a`.
    </span>
  </li>
  <li>对于 Eisenstein 数域 `QQ(sqrt(-3))`, 取 `QQ`-基 `[1, omega]`, 其中
    `1 + omega + omega^2 = 0`, 则
    <span class="formula">
      `(a+b omega)[1, omega]`
      `= [a+b omega, a omega + b omega^2]`
      `= [a+b omega, -b + (a-b) omega]`;<br>
      `N(a+b omega) = |a, b; -b, a-b|` `= a^2-a b+b^2`.
      `quad T(a+b omega) = 2a-b`.
    </span>
  </li>
</ol>

<ol class="corollary">
  设 `L//K` 是数域的 `n` 次扩张, `a, b in L`, `k in K`, 有
  <li>`N(1) = 1`, `T(1) = n`;</li>
  <li>`N(k a) = k^n N(a)`, `T(k a) = k T(a)`;</li>
  <li>`N(a b) = N(a) N(b)`, `T(a + b) = T(a) + T(b)`,
    即 `N`, `T` 分别是关于乘法和加法的同态.
  </li>
</ol>

<ol class="proof">
  <li>因为元素 1 的表示矩阵是单位阵;</li>
  <li>因为 `k a` 的表示矩阵是 `a` 的表示矩阵的 `k` 倍;</li>
  <li>因为 `a b` 的表示矩阵是 `a, b` 的表示矩阵之积;
    `a + b` 的表示矩阵是 `a, b` 的表示矩阵之和;</li>
</ol>

<p class="theorem">
  `AA a in L`,
  设 `sigma_i` 是 `L` 到 `CC` 的 `n` 个 `K`-嵌入,
  则 `sigma_i(a)` 是 `a` 的 `K`-共轭元; 可以证明
  <span class="formula">
    `N(a) = prod sigma_i(a)`, `quad T(a) = sum sigma_i(a)`.
  </span>
  设 `a` 的最小多项式是 `f(x) = sum_(k=0)^n c_k x^k`,
  则由 Vieta 定理知道, `N(a) = (-1)^n c_0`, `T(a) = - c_(n-1)`.
</p>

<p class="corollary">
  若 `M` 是 `L//K` 的中间域, 则 `AA a in L`,
  <span class="formula">
    `N_(L//K)(a) = N_(M//K)(N_(L//M)(a))`,<br>
    `T_(L//K)(a) = T_(M//K)(T_(L//M)(a))`.
  </span>
</p>

<p class="proof">
  (??)
  这是因为, 要求 `a` 在 `L//K` 上的全体共轭元之积,
  可以先求 `a` 在 `L//M` 上的全体共轭元之积——记为 `b`,
  再求 `b` 在 `M//K` 上的全体共轭元之积. 迹的情形类似.
</p>

<h3>判别式</h3>

<p class="definition">
  <b>元素的判别式</b>
  考虑数域的 `n` 次扩张 `L//K`, 有时需要判断元素
  `a_1, cdots, a_n in L` 是否线性相关, 为此引入判别式
  <span class="formula">
    `d(a_1, cdots, a_n)`
    `:= "det"(sigma_i(a_j))_(1 le i,j le n)^2`.
  </span>
  对于单个元素 `a in L`, 简记
  <span class="formula">
    `d(a) := d(1, a, cdots, a^(n-1))`.
  </span>
  当 `L` 为全实域时, 判别式总是非负的.
</p>

<p class="corollary">
  `d(a_1, cdots, a_n) = "det"(T(a_i a_j))_(1 le i,j le n) in K`.
</p>

<p class="proof">
  <span class="formula">
    `d(a_1, cdots, a_n)`
    `= |sigma_1(a_1), cdots, sigma_n(a_1); , cdots, ; sigma_1(a_n), cdots, sigma_n(a_n)|`
    `|sigma_1(a_1), cdots, sigma_1(a_n); , cdots, ; sigma_n(a_1), cdots, sigma_n(a_n)|`
    `= "det"(sum_k sigma_k(a_i) sigma_k(a_j))_(1 le i,j le n)`
    `= "det"(T(a_i a_j))_(1 le i,j le n)`.
  </span> 
</p>

<ol class="corollary">
  <li>`a_1, cdots, a_n` 线性无关当且仅当 `d(a_1, cdots, a_n) != 0`.
    此时它们构成一组 `K`-基.
  </li>
  <li>`L = K(a)` 当且仅当 `1, a, cdots, a^(n-1)` 线性无关, 即 `d(a) != 0`.
    此时 `a` 为 `L` 的生成元.
  </li>
</ol>

<p class="proof">
  设 `a_1, cdots, a_n` 线性相关, 则存在不全为零的 `k_1, cdots, k_n in K` 使得 `sum_j k_j a_j = 0`, 于是
  <span class="formula">
    `sum_j k_j sigma_i(a_j) = 0`, `quad i = 1, cdots, n`.
  </span>
  这表明方阵 `(sigma_i(a_j))` 的列向量线性相关, 即 `d(a_1, cdots, a_n) = 0`.
  <br>
  反之若 `d(a_1, cdots, a_n) = 0`, 则方阵 `(T(a_i a_j))` 的行向量线性相关.
  记 `R_i = (T(a_i a_1), cdots, T(a_i, a_n))`, 则存在不全为零的 `k_1,
  cdots, k_n in K` 使得 `sum k_i R_i = 0`.
  假设 `a_1, cdots, a_n` 线性无关, 则 `a = sum k_j a_j != 0`.
  从 `sum k_i R_i = 0` 取第 `j` 个分量得 `sum_i k_i T(a_i a_j) = 0`,
  即 `T(a a_j) = 0`. 又 `a_1, cdots, a_n` 是一组 `K`-基, 知对任意
  `b in L` 有 `T(a b) = 0`. 这与 `a != 0` 矛盾. 因为只要取 `b = a^-1` 即有
  `T(a a^-1) = T(1) = n`.
</p>

<ol class="corollary">
  <b>判别式的又一公式</b>
  <li>
    设 `L//K` 是数域的 `n` 次扩张, `a in L` 的 `n` 个 `K`-共轭元为
    `a_1, a_2, cdots, a_n`, 则
    <span class="formula">
      `d(a) = prod_(i lt j) (a_i - a_j)^2`.
    </span>
    从而 `d(a) != 0` 当且仅当 `a` 的共轭元两两不同.
  </li>
  <li>设 `f` 为 `a` 的最小多项式, 记 `s = n(n-1)//2`, 有
    <span class="formula">
      `d(a) = (-1)^s N(f'(a))`.
    </span>
  </li>
</ol>

<ol class="proof">
  <li>`d(a) = d(1, cdots, a^(n-1))` `= "det"(a_i^j)^2`,
    利用 Vandermonde 行列式的结论即可.
  </li>
  <li>满足 `1 le i lt j le n` 的 `(i, j)` 共有 `s = n(n-1)//2` 对,
    由 1. 有
    <span class="formula">
      `d(a) = (-1)^s prod_(i != j) (a_i - a_j)`
      `= (-1)^s prod_(i=1)^n prod_(j=1, j != i)^n (a_i - a_j)`
      `= (-1)^s prod_(i=1)^n f'(a_i)`
      `= (-1)^s N(f'(a))`.
    </span>
  </li>
</ol>

<p class="definition">
  <b>多项式的判别式</b>
  设 `f(x)` 是 `K` 上的首一 `n` 次多项式, 其在 `CC` 上的全部根为 `a_1,
  cdots, a_n`. 记 `s = n(n-1)//2`, 定义
  <span class="formula">
    `d(f) = prod_(i lt j) (a_i - a_j)^2`
    `= (-1)^s prod_i f'(a_i) in K`.
  </span>
  于是 `f` 有重根 `iff d(f) = 0`.
</p>

<ol class="example">
  记 `s = n(n-1)//2`,
  <li>`x^n + a` 的判别式为 `(-1)^s n^n a^(n-1)`;</li>
  <li>`x^n + a x + b` 的判别式为 `(-1)^s[(1-n)^(n-1) a^n + n^n b^(n-1)]`. 特别
    <span class="formula">
      `x^2 + a x + b` 的判别式为 `a^2 - 4 b`;<br>
      `x^3 + a x + b` 的判别式为 `-(4a^3 + 27b^2)`.
    </span>
  </li>
</ol>

<h2>代数整数</h2>

<p class="definition">
  设 `a in CC`. 若存在 `ZZ` 上首一多项式 `f` 满足 `f(a) = 0`,
  则称 `a` 为<b>代数整数</b>;
  数域 `K` 中全体代数整数的集合记为 `O_K`.
  由定义知, 若 `L//K` 是域的扩张, 则 `O_L nn K = O_K`.
</p>

<p class="remark">
  本节将要证明 `O_K` 是环, 即代数整数的和、差、积仍为代数整数.
  历史上正是为了证明此结论, 产生了近世代数中 "模" 的概念.
</p>

<p class="corollary">
  `ZZ` 上首一多项式的有理根必为整数, 因此 `QQ` 中的代数整数必为整数,
  即 `O_QQ = ZZ`.
</p>

<ol class="theorem">
  <b>代数整数的判别法</b>
  设 `a in CC`, 以下各款等价:
  <li>`a` 为代数整数;</li>
  <li>`a` 在 `QQ` 上的最小多项式属于 `ZZ[x]`;</li>
  <li>环 `ZZ[a]` 的加法群是有限生成的, 即存在 `a_1, cdots, a_n in ZZ[a]`
    使得 `ZZ[a] = a_1 ZZ + cdots + a_n ZZ`.
  </li>
  <li>存在 `CC` 的非零子环 `R`, 满足 `a in R`, 且 `R`
    的加法群是有限生成的;</li>
  <li>存在 `CC` 的有限生成非零加法子群 `A`, 使得 `a A sube A`.</li>
</ol>

<ol class="proof">
  <li>`rArr 2`. 由 `a` 为代数整数知, 存在首一的 `f(x) in ZZ[x]` 使得 `f(a)
    = 0`.
    又设 `a` 的最小多项式为 `p(x)`, 则 `p(x) | f(x)`.
    注意到 `p` 首一, `f` 在 `ZZ[x]` 上首一, 故有 `p(x) in ZZ[x]`.
  </li>
  <li>`rArr 3`. 设 `f(x) = x^n + c_(n-1) x^(n-1) + cdots + c_0`
    是 `a` 的最小多项式,
    于是 `a^n = -(c_(n-1) x^(n-1) + cdots + c_0)`,
    归纳知任意 `a^m` 可以写成 `1, a, cdots, a^(n-1)` 的 `ZZ`-线性组合,
    于是环 `ZZ[a]` 中的每个元素也是如此.
  </li>
  <li>`rArr 4`. 取 `R = ZZ[a]`.</li>
  <li>`rArr 5`. 取 `A = R`.</li>
  <li>`rArr 1`. 记 `A = a_1 ZZ + cdots + a_n ZZ`. 由 `a A sube A` 知 `a a_i
    in A`, `i = 1, cdots, n`. 于是它们可以写成 `a_1, cdots, a_n`
    的线性组合. 设
    <span class="formula">
      `[a a_1; vdots; a a_n] = M [a_1; vdots; a_n]`,
    </span>
    `M` 是 `ZZ` 上的 `n` 阶方阵. 由 `A != (0)` 知 `a_1, cdots, a_n`
    不全为零, 因此 `a` 是 `M` 的特征值, `f(x) = det(x I_n - M)` 是 `ZZ`
    上满足 `f(a) = 0` 的首一多项式.
  </li>
</ol>

<p class="theorem">
  数域 `K` 中全体代数整数构成 `K` 的子环 `O_K`, 称为 `K` 的整数环;
  与此同时 `K` 是环 `O_K` 的分式域.
</p>

<p class="definition">
  设 `K` 是数域, `a in K`.  若存在 `K` 的子环 `R` 上首一多项式 `f` 满足
  `f(a) = 0`, 则称 `a` <b>在 `R` 上整</b>.
  因此代数整数就是那些在 `ZZ` 上整的数.
  若除了 `R` 中的数以外, `K` 中没有其它数在 `R` 上整, 即
  <span class="formula">
    `AA a in K`, `a` 在 `R` 上整 `rArr` `a in R`,
  </span>
  则称 `R` 是<b>整闭</b>的.
</p>

<p class="corollary">
  环 `O_K` 在数域 `K` 中是整闭的.
</p>

<p class="proof">
  对 `AA u in K`, 若 `u` 在 `K` 上整, 设
  <span class="formula">
    `f(u) = u^m + c_(m-1) u^(m-1) + cdots c_1 u + c_0 = 0`,
    `quad c_i in O_K`.
  </span>
  由于 `c_i in O_K`, 即它们都在 `ZZ` 上整, 由引理??
  可知 `O_K` 的子环 `R = ZZ[c_1, cdots, c_m]` 的加法群为有限生成:
  <span class="formula">
    `R = gamma_1 ZZ + cdots + gamma_s ZZ`.
  </span>
  另一方面由 `f(u) = 0` 知 `u^r (r ge 1)` 均可表为 `1, u, cdots, u^(m-1)` 的`R`-线性组合. 于是
  <span class="formula">
    `R_1 := ZZ[c_1, cdots, c_m, u] = R[u]`
    `= R + u R + cdots + u^(m-1) R`.
  </span>
  即 `R_1` 的加法群也是有限生成的. 由引理?? 知 `u` 在 `ZZ` 上整, 因此 `u in
  O_K`.
</p>

<ol class="example">
  <b>二次域中的代数整数</b> 考虑 `K = QQ(sqrt d)`, `d` 不是平方数.
  <li>`d -= 2, 3 (mod 4)` 时, `O_K = ZZ[sqrt d]`;</li>
  <li>`d -= 1 (mod 4)` 时, `O_K = ZZ[(1+sqrt d)/2]`.</li>
</ol>

<p class="example">
  <b>分圆域中的代数整数</b> 考虑 `K = QQ(zeta_n)`, `n ge 3`.
  则 `O_K = ZZ[zeta_n]`.
</p>

<h2>整基</h2>

<p class="definition">
  设数域 `K` 是 `QQ` 的 `n` 次扩域, 则 `O_K` 是有限生成的:
  存在 `omega_1, cdots, omega_n in O_K` 使得
  `O_K = omega_1 ZZ o+ cdots o+ omega_n ZZ`.
  换言之, 任意 `a in O_K` 可唯一表为
  <span class="formula">
    `a = a_1 omega_1 + cdots a_n omega_n`, `quad a_i in ZZ`.
  </span>
  `omega_1, cdots, omega_n` 称为 `K` 或 `O_K` 的一组整基.
</p>

<script src="../../js/note.js"></script>
</body>
</html>
