<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <title>曲面的局部理论</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" type="text/css" href="../../css/note.css" />
</head>
<body>

<h2>曲面的概念</h2>

<h3>曲面的定义及参数变换</h3>

<p class="definition">
  <b>曲面</b>是平面区域 `D` 到 `E^3` 的映射
  `bm r(u,v) = (x(u,v), y(u,v), z(u,v))`, 满足
  <ol>
    <li>`x, y, z in C^oo(D)`;</li>
    <li>`bm r_u = ((del x)/(del u), (del y)/(del u), (del z)/(del u))`
      与
      `bm r_v = ((del x)/(del v), (del y)/(del v), (del z)/(del v))`
      线性无关, 即 `bm r_u ^^ bm r_v != bb 0`.
    </li>
  </ol>
</p>

<p class="definition">
  <b>曲面的参数变换</b>
  设 `bm r(u, v): D |-> E^3`,
  <span class="formula">
    `sigma: bar D |-> D`<br/>
    `(bar u, bar v) |-> (u, v)`,
  </span>
  若 `sigma` 一阶连续可微,
  则切向量微元具有变换
  <span class="formula">
    `["d"u; "d"v] = J ["d"bar u; "d"bar v]`,
    `quad J = (del(u,v))/(del(bar u, bar v))`
    `= [u_(bar u), u_(bar v); v_(bar u), v_(bar v)]`.
  </span>
  `|J| != 0` 时, `bm r` 有新参数表示
  `bm r(u(bar u, bar v), v(bar u, bar v))`.
  如果存在满足上述条件的参数变换使两个曲面的表达式相同,
  则视它们为相同的曲面.
</p>

<p>在上述变换下, 坐标切向量 `bm r_u` 和 `bm r_v` 的变换公式为
  <span class="formula">
    `[bm r_(bar u), bm r_(bar v)] = [bm r_u, bm r_v] J`,<br/>
    `bm r_(bar u) ^^ bm r_(bar v) = bm r_u ^^ bm r_v |J|`.
  </span>
</p>

<p class="remark">
  形象记忆: 由
  <span class="formula">
    `["d"u; "d"v] = (del(u, v))/(del(bar u, bar v)) ["d"bar u; "d"bar v]`,
  </span>
  得到
  <span class="formula">
    `[bm r_(bar u), bm r_(bar v)]`
    `= (del bm r)/(del(bar u,bar v))`
    `= (del bm r)/(del(u, v)) (del(u, v))/(del(bar u, bar v))`
    `= [bm r_u, bm r_v] J`.
  </span>
</p>

<p class="example">
  球面 `x^2 + y^2 + z^2 = a^2` 有球坐标表示
  <span class="formula">`{
    x = a cos u cos v;
    y = a cos u sin v;
    z = a sin u;
  :}`,
  `quad u in [-pi/2, pi/2]`, `v in [0, 2pi]`.
  </span>
  和球极投影坐标表示:
  <span class="formula">`{
    x = 2a^2 u // d^2;
    y = 2a^2 v // d^2;
    z = a delta^2 // d^2;
  :}`, `quad u, v in RR`.
  </span>
  其中 `P(u, v, 0)` 是赤道平面上的一点,
  `(x, y, z)` 是 `P` 到北极 `N(0, 0, a)` 的连线与球面的交点.
  `d = sqrt(u^2 + v^2 + a^2)` 是 `P` 到 `N` 的距离,
  `delta = sqrt(u^2 + v^2 - a^2)` 是 `P` 到球面的切线长.
</p>
<img src="../img/sphere-coordinal.png" />
<img src="../img/sphere-polar-coordinal.png" />

<p class="example"> <b>旋转面</b><br/>
  `xz` 平面上与 `z` 轴无交的曲线 `{x = x(u); z = z(u) :}`
  绕 `z` 轴旋转得到
  <span class="formula">
    `{x = x(u) cos v; y = x(u) sin v; z = z(u) :}`.
  </span>
  特别当 `x(u) = a cos u`, `z(u) = a sin u` 时, 得到球面.
</p>

<p class="example"> <b>柱面</b><br/>
  `xy` 平面上的曲线 `{x = x(u); y = y(u) :}` 沿 `z` 轴平移得到
  <span class="formula">
    `{x = x(u); y = y(u); z = v :}`.
  </span>
</p>

<p class="example"> <b>直纹面</b><br/>
  称直线沿空间曲线 `bm r = bm a(u)` 滑动扫过的曲面
  <span class="formula">
    `bm r(u,v) = bm a(u) + v bm b(u)`
  </span>
  为直纹面. 其中 `bm a` 表示直线与曲线的交点, `bm b` 表示直线在该点的方向.
  方程中取定一个 `u`, 就确定一条直母线. 当 `bm a` 为常向量时, 为锥面;
  当 `bm b` 方向不变时, 为柱面. 当 `bm b` 始终沿曲线切向时, 方程形如
  <span class="formula">
    `bm r(u,v) = bm a(u) + v bm a'(u)`,
  </span>
  称为曲线 `bm r(u)` 的<b>切线面</b>, 它包含了 `bm r(u)` 的全体切线.
</p>

<h3>切向量, 切平面, 法向量</h3>

<p class="definition">
  称 `bm r_u`, `bm r_v` 为<b>坐标切向量</b>. 它们线性无关,
  从而确定了曲面 `S` 在点 `P_0 = (u, v)` 处的<b>切平面</b> `T_0`.
  `S` 上过 `P_0` 的任一曲线在 `P_0` 的切向量落在切平面 `T_0` 上;
  反之, 对切平面 `T_0` 上的任一向量 `bm t`,
  存在曲面上过 `P_0` 的一曲线, 它在 `P_0` 的切向量与 `bm t` 同向.
</p>

<p class="definition">
  `bm r_u ^^ bm r_v` 是曲面的一个<b>法向量</b>.
  `bm n = (bm r_u ^^ bm r_v)/|bm r_u ^^ bm r_v|`
  是曲面的一个<b>单位法向量</b>. 法向量所在直线称为<b>法线</b>.
</p>

<p class="example">
  当曲面由方程 `F(bm r) = c` 给出时,
  方程两边对 `u, v` 分别求导得
  <span class="formula">
    `(:grad F, bm r_u:) = (:grad F, bm r_v:) = 0`,
  </span>
  故 `grad F` 是曲面的法向量,
  `(:grad F, bm r - bm r_0:) = 0` 是 `bm r_0` 处的切平面.
</p>

<p class="theorem">
  曲面的切平面, 法线与参数选取无关.
</p>

<h2>曲面的基本形式</h2>

<h3>第一基本形式 (The first fundamental form)</h3>

<p class="definition">
  <span class="formula">
    `"I" = "d"s^2 = "d" bm r^2`
    `= (bm r_u "d"u + bm r_v "d" v)^2`
    `= ["d"u, "d"v][bm r_u^T; bm r_v^T][bm r_u, bm r_v]["d"u; "d"v]`
    `= ["d"u, "d"v][E, F; F, G]["d"u; "d"v]`
    `= E "d"u"d"u + 2F "d"u"d"v + G"d"v"d"v`.
  </span>
  其中
  <span class="formula">
    `E = (:bm r_u, bm r_u:)`,
    `quad F = (:bm r_u, bm r_v:)`,
    `quad G = (:bm r_v, bm r_v:)`.
  </span>
  第一基本形式是正定的二次型, 是曲面上的度量.
  它在合同变换下不变, 与参数选取无关.
</p>

<p class="proof">
  将参数变换
  <span class="formula">
    `["d"u; "d"v] = J ["d"bar u; "d"bar v]`,
    `quad [bm r_(bar u), bm r_(bar v)] = [bm r_u, bm r_v] J`
  </span>
  代入得
  <span class="formula">
    `"I" = ["d"bar u, "d"bar v][bm r_(bar u)^T; bm r_(bar v)^T]
    [bm r_(bar u), bm r_(bar v)]["d"bar u; "d"bar v]`,
  </span>
  第一基本形式不变.
</p>

<p class="corollary">
  `F = 0` 当且仅当 `(u, v)` 是正交参数.
</p>

<p class="remark">
  第一基本形式和下文的第二基本形式是所谓的 "微分形式",
  即微分 `"d"u`, `"d"v` 等与函数的算术组合.
  设 `bm v` 是曲面上一点处的切向量, 将它分解为 `bm r_u, bm r_v`
  的线性组合 `bm v = xi bm r_u + eta bm r_v`, 则
  <span class="formula">
    `v^2 = (:bm v, bm v:)`
    `= E xi^2 + 2F xi eta + G eta^2`.
  </span>
</p>

<p class="example">
  平面 `bm r(u,v) = (u, v, 0)` 的第一基本形式
  `"I" = "d"u"d"u + "d"v"d"v`.
</p>

<p class="example">
  柱面 `bm r(u,v) = (x(u), y(u), v)` 的第一基本形式
  `"I" = ({:x':}^2 + {:y':}^2)"d"u"d"u + "d"v"d"v`.
  取 `u` 是弧长参数时, `"I" = "d"u"d"u + "d"v"d"v`.
</p>

<p class="example">
  球面 `bm r(theta, varphi) = (a cos theta cos varphi, a cos theta sin
  varphi, a sin varphi)` 的第一基本形式
  `"I" = a^2 "d"theta"d"theta + a^2 cos^2 theta "d"varphi"d"varphi`.
  球面 `bm r(u,v) = (2a^2u//d^2, 2a^2v//d^2, a(d^2-2a^2)//d^2)` `(d^2 =
  u^2 + v^2 + a^2)` 的第一基本形式
  `"I" = ((2a^2)/d^2)^2 ("d"u"d"u + "d"v"d"v)`.
</p>

<h3>第二基本形式 (The second fundamental form)</h3>

<p class="definition">
  <span class="formula">
    `"II" = -(:"d"bm r, "d"bm n:)`
    `= - ["d"u, "d"v][bm r_u^T; bm r_v^T][bm n_u, bm n_v]["d"u; "d"v]`
    `= ["d"u, "d"v][L, M; M, N]["d"u; "d"v]`
    `= L"d"u"d"u + 2M"d"u"d"v + N"d"v"d"v`.
  </span>
  其中 (通过分部积分)
  <span class="formula">
    `L = -(:bm r_u"," bm n_u:) = (:bm r_(u u)"," bm n:)`,<br/>
    `M = -(:bm r_v"," bm n_u:)`
    `= -(:bm r_u"," bm n_v:)`
    `= (:bm r_(uv)"," bm n:)`,<br/>
    `N = -(:bm r_v"," bm n_v:) = (:bm r_(v v)"," bm n:)`.
  </span>
  第二基本形式在同向参数变换 (`|J| gt 0`) 下不变,
  反向则变号; 在同向刚体运动 (`|T| = 1`) 下不变, 反向则变号.
</p>

<p class="remark">
  因为 `bm n` 的长度不变, 所以 `(:bm n_u, bm n:) = (:bm n_v, bm n:) = 0`,
  故 `bm n_u, bm n_v` 落在切平面上, 它们也是切向量.
</p>

<ol>
  根据第二基本形式行列式符号的不同, 将曲面上的点作如下分类:
  <li>`LN-M^2 gt 0`, 正定或负定, 凸或凹, 椭圆点;</li>
  <li>`LN-M^2 lt 0`, 不定, 马鞍型, 双曲点;</li>
  <li>`LN-M^2 = 0`, 退化, 抛物点; 若 `L = M = N = 0`, 为平点.</li>
</ol>

<p class="example"> 记 `bm r = bm r(u,v)`, `bm r_0 = bm r(u_0, v_0)`,
  `bm n_0 = bm n(u_0, v_0)`, 定义曲面高度函数
  <span class="formula">
    `f(u, v) = (:bm r - bm r_0, bm n_0:)`,
  </span>
  则 `f_u = (:bm r_u, bm n_0:)`, `f_v = (:bm r_v, bm n_0:)`,
  `"II" = ["d"u, "d"v]
  [{:f_(u u):}, {:f_(uv):}; {:f_(vu):}, {:f_(v v):}]["d"u; "d"v]`.
</p>

<p class="example">
  平面 `bm r(u,v) = (u, v, 0)`. 注意 `bm n` 为常向量, 故
  `"II" = -(:"d"bm r, "d"bm n:) = 0`.
</p>

<p class="example" id="exp-pillar-II">
  柱面 `bm r(u,v) = (x(u), y(u), v)`. 记 `kappa = |x_u, y_u; x_(u u),
  y_(u u)|`, 有 `"II" = -kappa "d"u"d"u`.
</p>

<p class="example">
  球面 `bm r(theta, varphi) = (a cos theta cos varphi, a cos theta sin
  varphi, a sin theta)`.
  `"II" = a "d"theta"d"theta + a cos^2 theta "d"varphi"d"varphi`.
</p>

<h2>法曲率与 Weingarten 变换</h2>

<h3>法曲率</h3>

<p>
  设曲面上有一曲线 `bm r`, `s` 是其弧长参数.
  `bm r` 在一点的单位切向量为 `("d"bm r)/("d"s)`,
  曲率向量为 `("d"^2 bm r)/{:"d"s:}^2`.
  利用分部积分计算曲率向量与法向量的内积:
  <span class="formula">
    ` (: ("d"^2 bm r)/{:"d"s:}^2, bm n :)
    = -(:("d"bm r)/("d"s), ("d"bm n)/("d"s):)
    = L(("d"u)/("d"s))^2 + 2M("d"u)/("d"s)("d"v)/("d"s)
      + N(("d"v)/("d"s))^2`.
  </span>
  上式只与曲线在一点处的单位切向量
  `("d"bm r)/("d"s) = (("d"u)/("d"s), ("d"v)/("d"s))`
  以及曲面的第二基本形式有关, 而与曲线选取无关.
  这启发我们作出如下定义:
</p>

<p class="definition">
  已知曲面上一点处的单位切向量 `bm v = xi bm r_u + eta bm r_v`, 定义
  <span class="formula">
    `k_n(bm v) = L xi^2 + 2M xi eta + N eta^2`,
  </span>
  称为曲面在该点处沿给定方向的<b>法曲率</b>.
  若 `bm v` 是任意非零切向量, 则沿 `bm v` 方向的法曲率等于
  <span class="formula">
    `k_n(bm v) = k_n(bm v/v) = 1/v^2 (L xi^2 + 2M xi eta + N
    eta^2) = (L xi^2 + 2M xi eta + N eta^2)/(E xi^2 + 2F xi eta + G
    eta^2)`.
  </span>
</p>

<p>
  法曲率反映了曲面沿给定方向的弯曲程度. 将曲面沿 `bm v, bm n` 所在平面
  "切开", 则剖面边缘 (视为平面曲线) 的曲率就是 `k_n`.
  法曲率在同向参数变换/刚体运动下不变, 反向则变号.
</p>

<p class="remark">
  类比于微积分中, 导数 `dy/dx` 是微分 `dy` 与 `dx` 之商,
  法曲率 `k_n` 是第二基本形式与第一基本形式之商.
</p>

<ol class="example">
  <li>半径为 `a` 的球面: `k_n = 1/a`.</li>
  <li>平面: `k_n = 0`.</li>
  <li>柱面 `bm r(u,v) = (x(u), y(u), v)`, 其中 `u` 为弧长参数.
    此时 `bm r_u, bm r_v` 是正交的单位向量,
    取单位切向量 `bm w = cos theta bm r_u + sin theta bm r_v` 得
    `k_n(bm w) = -kappa cos^2 theta`
    (`kappa` 的定义参见<a class="ref" href="#exp-pillar-II"></a>).
  </li>
</ol>

<h3>Weingarten 变换</h3>

<p class="definition">
  <b>Gauss 映射</b> 将曲面上的一点映为该点处的法向量 (`S_2` 为单位球面):
  <span class="formula">
    `bm g: S |-> S^2`<br/>
    `bm r(u, v) |-> bm n(u, v)`.
  </span>
  <b>Weingarten 变换</b> `cc W` 是 Gauss 映射的导映射 (符号取反),
  它是切平面上切向量间的线性变换.  我们定义 `cc W(bm r_u) = -bm n_u`,
  `cc W(bm r_v) = -bm n_v`; 一般地,
  <span class="formula">
    `cc W: T_0 |-> T_0`<br/>
    `a bm r_u + b bm r_v |-> -a bm n_u - b bm n_v`.
  </span>
  Weingarten 变换也可以用于微分形式:
  <span class="formula">
    `cc W("d"bm r)`
    `= cc W(bm r_u "d"u + bm r_v "d"v)`
    `= -bm n_u "d"u - bm n_v "d"v`
    `= -"d"bm n`.
  </span>
</p>

<p class="remark">
  也有定义 Weingarten 变换为 `cc W("d"bm r) = "d"bm n` 的.
</p>

<p class="corollary">
  Weingarten 变换与曲面的参数选取无关.
</p>

<p class="proof">
  在参数替换 `["d"u; "d"v] = J ["d"bar u; "d"bar v]` 下,
  <span class="formula">
    `a bm r_u + b bm r_v`
    `= [bm r_u, bm r_v] [a; b]`
    `= [bm r_(bar u), bm r_(bar v)] J^-1 [a; b]`,<br/>
    `-a bm n_u - b bm n_v`
    `= -[bm n_u, bm n_v] [a; b]`
    `= -[bm n_(bar u), bm n_(bar v)] J^-1 [a; b]`,
  </span>
  替换后的两向量仍满足 Weingarten 变换的定义.
</p>

<p class="corollary" id="col-weingarten-normal-curvature">
  曲面沿单位切向量 `bm t` 的法曲率可用 Weingarten 变换刻画:
  <span class="formula">
    `k_n(bm t) = (:cc W(bm t), bm t:)`.
  </span>
</p>

<p class="proof">
  设 `bm t = a bm r_u + b bm r_v`, 则 `cc W(bm t) = -a bm n_u -b bm n_v`,
  <span class="formula">
    `(:cc W(bm t), bm t:)`
    `= a^2 L + 2 a b M + b^2 N`
    `= k_n(bm t)`.
  </span>
</p>

<p class="theorem">
  Weingarten 变换是自共轭变换: `AA bm v, bm w in T_0`,
  <span class="formula">
    `(:cc W(bm v), bm w:) = (:cc W(bm w), bm v:)`.
  </span>
  特别取两个向量为切平面的单位正交基底 `bm e_1, bm e_2` 时, 由上式知
  Weingarten 变换在正交基底下的矩阵为二阶实对称阵.
</p>

<p class="proof">
  设 `bm v = a bm r_u + b bm r_v`, `bm w = c bm r_u + d bm r_v`,
  则 `cc W(bm v) = -a bm n_u -b bm n_v`, `cc W(bm w) = -c bm n_u - d bm
  n_v`,
  <span class="formula">
    `(:cc W(bm v), bm w:)`
    `= a c L + (a d + b c) M + b d N`
    `= (:cc W(bm w), bm v:)`.
  </span>
</p>

<p class="remark">
  Weingarten 变换的矩阵即 Gauss 映射的 Jacobi 阵 (取反).
  一般地, 函数
  <span class="formula">
    `(x, y, z) |-> (P(x, y, z), Q(x, y, z), R(x, y, z))`
  </span>
  的导线性变换为
  <span class="formula">
    `cc A(bm i, bm j, bm k) = (bm i, bm j, bm k)
        [P_x, P_y, P_z;
         Q_x, Q_y, Q_z;
         R_x, R_y, R_z]`
    `= (bm i, bm j, bm k) J`.
  </span>
  `J` 是导线性变换的矩阵, 即 Jacobi 阵.
</p>

<p class="corollary">
  由线性代数中实对称矩阵的结论知,
  Weingarten 变换的两个特征值是实数. 它们不相等时,
  有两个相互正交的特征向量; 相等时, 任一切向量都是特征向量.
</p>

<h3>主曲率</h3>

<p class="definition">
  称 Weingarten 变换的两个特征值 `k_1, k_2` 为<b>主曲率</b>,
  相应的特征向量为<b>主方向</b>.
  由<a class="ref" href="#col-weingarten-normal-curvature"></a> 知道,
  主曲率就是主方向上的法曲率.
</p>

<p class="theorem">
  <b>Euler 公式</b> 设 `k_1, k_2` 为主曲率,
  `bm e_1, bm e_2` 为相应主方向的单位向量,
  利用<a class="ref" href="#col-weingarten-normal-curvature"></a> 计算知,
  法曲率可用主曲率表达:
  <span class="formula">
    ` k_n(bm e_1 cos theta + bm e_2 sin theta)
    = k_1 cos^2 theta + k_2 sin^2 theta`.
  </span>
  可以看出, 当 `k_1 != k_2` 时, `k_n` 在主方向上取得极值;
  `k_1 = k_2` 时, 各方向上的法曲率相等.
</p>

<p class="example">
  计算 <b>Gauss 曲率</b> `K = k_1 k_2` 与<b>平均曲率</b>
  `H = (k_1 + k_2)/2`.
</p>

<p class="solution">
  由定义, Gauss 曲率等于 Weingarten 变换 `cc W` 的行列式,
  平均曲率等于 `cc W` 的迹的一半.
  设 `cc W` 在基 `(bm r_u, bm r_v)` 下的矩阵为
  `bm A = [a, b; c, d]` (未必对称), 即
  <span class="formula">
    `cc W(bm r_u) = -bm n_u = a bm r_u + b bm r_v`,<br/>
    `cc W(bm r_v) = -bm n_v = c bm r_u + d bm r_v`.
  </span>
  以上两式分别与 `bm r_u, bm r_v` 作内积, 得
  <span class="formula">
    `[L, M; M, N] = [a, b; c, d][E, F; F, G]`,
  </span>
  即
  <span class="formula">
    `[a, b; c, d] = [L, M; M, N][E, F; F, G]^-1`.
  </span>
  易知 Gauss 曲率
  <span class="formula">
    `K = |a,b; c,d| = |L,M; M,N|//|E,F; F,G|`.
  </span>
  平均曲率 `H = (a+d)//2`.
</p>

<p class="remark">
  Gauss 曲率 `K` 满足
  <span class="formula">
    `bm n_u ^^ bm n_v`
    `= (a bm r_u + b bm r_v) ^^ (c bm r_u + d bm r_v)`
    `= (ad-bc) bm r_u ^^ bm r_v = K bm r_u ^^ bm r_v`.
  </span>

  直观上, Gauss 映射将曲面上的小块邻域映到单位球面上的区域.
  对应区域的面积之比
  <span class="formula">
    `K = |bm n_u ^^ bm n_v|/|bm r_u ^^ bm r_v|`
  </span>
  就是 Gauss 曲率.
<p>

<p class="remark">
  曲面的第三基本形式定义为 `"III" = (:"d"bm n, "d"bm n:)`,
  它也是正定二次型, 且有
  <span class="formula">
    `K "I" - 2H "II" + "III" = 0`.
  </span>
</p>

<p class="proof">
  即证
  <span class="formula">
    `(:("d"bm n)/("d"s), ("d"bm n)/("d"s):) + 2H(:("d"bm r)/("d"s), ("d"bm
    n)/("d"s):) + K = 0`.
  </span>
  记 `("d"bm r)/("d"s) = bm e_1 cos theta + bm e_2 sin theta`,
  则上式左边等于
  <span class="formula">
    `k_1^2 cos^2 theta + k_2^2 sin^2 theta - (k_1 + k_2)(k_1 cos^2 theta
    + k_2 sin^2 theta) + k_1 k_2`
    `= 0`.
  </span>
</p>

<h4>主曲率的几何意义</h4>

<h2>曲面举例</h2>

[<a href="../example/surface.html">曲面绘制工具</a>]

<h3>旋转曲面</h3>

<span class="formula">
  `bm r(u, v) = (f(u) cos v, f(u) sin v, g(u))`, `f gt 0`.
</span>

<p> 直接计算
  <span class="formula">
    `bm r_u = (f'(u)cos v, f'(u)sin v, g'(u))`,<br/>
    `bm r_v = (-f(u)sin v, f(u)cos v, 0)`,<br/>
    `E = {:f':}^2+{:g':}^2`, `quad F = 0`, `quad G = f^2`,<br/>
    `L = (f' g'' - f'' g')/sqrt E`, `quad M = 0`,
    `quad N = (fg')/sqrt E`,<br/>
    `k_1 = L/E`, `quad k_2 = N/G`,
    `quad K = k_1 k_2`, `quad H = (k_1 + k_2)/2`.
  </span>
  若取 `u` 为 `xz` 平面上曲线 `(f(u), g(u))` 的弧长参数, 则
  `{:f':}^2 + {:g':}^2 = 1`, `f'f'' + g'g'' = 0`, 由此推出
  <span class="formula">
    ` f'g'' - f''g' = -(f'')/(g')`.
  </span>
  上面各式有比较简单的表达式
  <span class="formula">
    `E = 1`, `quad F = 0`, `quad G = f^2`,<br/>
    `L = -(f'')/(g')`, `quad M = 0`, `quad N = fg'`,<br/>
    `k_1 = -(f'')/(g')`, `quad k_2 = (g')/f`,
    `quad K = -(f'')/f`, `quad H = 1/2 ((g')/f - (f'')/(g'))`.
  </span>
</p>

<p class="example">
  wgs84 标准假设地球是一个椭球体, 方程为
  <span class="formula">
    `(x^2+y^2)/a^2 + z^2/b^2 = 1`.
  </span>
  其中 `a = 6378137"m"`, `b = 6356752.31424518"m"`,
  已知地球上一点 `P` 的经纬度和高度 `(theta, varphi, h)`, 求这点的坐标.
</p>

<ol class="solution">
  <li>
    这个问题的重点是得到 `P` 点处的「卯酉圈」曲率半径
    <span class="formula">
      `n = a^2/sqrt(a^2 cos^2 varphi + b^2 sin^2 varphi)`.
      <span class="label">`(**)`</span>
    </span>
    于是这点的坐标是
    <span class="formula">
      `x = (n + h) cos varphi cos theta`,<br>
      `y = (n + h) cos varphi sin theta`,<br>
      `z = (n * b^2/a^2 + h) sin varphi`.
    </span>
    `z` 的求法是, 先假设 `h = 0`, 再把 `x, y` 代入椭球面方程求解.
  </li>
  <li>
    我们来导出 `P` 点处的曲率半径公式 `(**)`.
    取定椭球面的参数方程
    <span class="formula">
      `bm r = (a cos u cos v, a cos u sin v, b sin u)`,<br>
      `bm r_u = (-a sin u cos v, -a sin u sin v, b cos u),<br>
      `bm r_v = (-a cos u sin v, a cos u cos v, 0)`.
    </span>
    使用旋转曲面的公式得到
    <span class="formula">
      `E = a^2 sin^2 u + b^2 cos^2 u`,
      `quad L = a b//sqrt E`,
      `quad N = a b cos^2 u // sqrt E`.
    </span>
    由对称性, 我们可以任取一个子午面 (椭球过 z 轴的截面), 如 `xOz` 平面, 考虑椭球面上一点
    `P(x_0, 0, z_0)`.
    <div class="img md">
      <img src="../img/wgs84-ellipsoid.png">
    </div>
    注意, 椭球面上过 `P` 点有无数个单位切向量, 每一个切向量都确定了 `P` 处的一个曲率.
    我们要求的曲率是「卯酉圈」在 `P` 处的曲率, 即 `P` 点处垂直于子午面的单位切向量所确定的曲率.
    显然, 在我们的假定下, 这个切向量就是 `bm v = (0, 1, 0)`.
    在 `P` 处, 参数 `v = 0`, 参数 `u` 满足 `a cos u = x_0`, 于是切向量 `bm r_u, bm r_v` 等于
    <span class="formula">
      `bm r_u = (-a sin u, 0, b cos u)`,
      `quad bm r_v = (0, x_0, 0)`.
    </span>
    将 `v` 分解为 `bm r_u, bm r_v` 的线性组合:
    <span class="formula">
      `bm v = 0 bm r_u + 1/x_0 bm r_v`.
    </span>
    则 `P` 处沿 `bm v` 的法曲率等于
    <span class="formula">
      `k_n(bm v) = 0^2 L + 1/x_0^2 N`
      `= b/a 1/sqrt(a^2 sin^2 u + b^2 cos^2 u)`
      `= 1/(a/b sqrt(a^2/b^2 z_0^2 + b^2/a^2 x_0^2))`
      `= 1/sqrt(x_0^2 + a^4/b^4 z_0^2)`
    </span>
    而曲率半径 `n = 1//k_n(bm v) = sqrt(x_0^2 + a^4/b^4 z_0^2)`.
  </li>
  <li>
    现在我们用纬度 (纬度是指法线 `PQ` 与 `x` 轴的夹角, 而不是 `/_ POx` 😭) 表示曲率半径.
    假定 `P` 的纬度为 `varphi`, 联立法线斜率 `tan varphi = z_0/x_0 a^2/b^2` 和子午圈方程
    `x_0^2/a^2 + z_0^2/b^2 = 1` 可得
    <span class="formula">
      `x_0 = a/sqrt(1 + b^2/a^2 tan^2 varphi)`.
    </span>
    于是
    <span class="formula">
      `n = sqrt(x_0^2 + a^4/b^4 z_0^2)`
      `= x_0 sqrt(1 + tan^2 varphi)`
      `= x_0 // cos varphi`
      `= a/sqrt(1 + b^2/a^2 tan^2 varphi) 1/(cos varphi)`
      `= a^2/sqrt(a^2 cos^2 varphi + b^2 sin^2 varphi)`.
    </span>
  </li>
  <li>最后, 反向延长 `P` 处的法线, 交 `z` 轴于 `Q` 点, 交 `x` 轴于 `R` 点,
    则 `|PQ|` 正好等于前文所求的曲率半径 `n`, `|RQ| = (1-b^2/a^2)|PQ| = e^2 n`.
    验证如下: `P` 处的法线方程为
    <span class="formula">
      `(z_0 x)/b^2 - (x_0 z)/a^2 = x_0 z_0(1/b^2 - 1/a^2)`.
    </span>
    即
    <span class="formula">
      `x/(x_0(1 - b^2/a^2)) - z/(z_0(a^2/b^2 - 1)) = 1`.
    </span>
    于是 `x_R = x_0 (1 - b^2/a^2)`, `z_Q = -z_0(a^2/b^2 - 1)`,
    <span class="formula">
      `|PQ| = sqrt(x_0^2 + (z_0 - z_Q)^2)`
      `= sqrt(x_0^2 + a^4/b^4 z_0^2) = n`.<br>
      `|RQ|/|PQ| = x_R/x_0 = 1-b^2/a^2 = e^2`.
    </span>
    运用以上几何性质不难推出 `P` 点的坐标为
    <span class="formula">
      `x = n cos varphi cos theta`,<br>
      `y = n cos varphi sin theta`,<br>
      `z = n * b^2/a^2 sin varphi`.
    </span>
  </li>
</ol>

<h4>常 Gauss 曲率旋转曲面</h4>

<!--
<p> `K = c^2 gt 0` 时, 由 `K = -(f'')/f`, 有常微分方程
  <span class="formula">
    `f''(u) + c^2 f(u) = 0`,
  </span>
  通解为
  <span class="formula">
    `f(u) = A cos cu + B sin cu`.
  </span>
</p>
-->

<h4>常平均曲率旋转曲面</h4>

<h3>直纹面与可展曲面</h3>

<h3>全脐点曲面</h3>

<p class="definition">
  曲面上两个主曲率相等的点称为<b>脐点</b>.
  由法曲率的定义知, 脐点处第二基本形式与第一基本形式的系数成比例, 即
  <span class="formula">
    `L/E = M/F = N/G = a`,
  </span>
  `a != 0` 时, 这一点称为<b>圆点</b>, `a = 0` 时称为<b>平点</b>.
  例如球面上各点均为圆点, 平面各点均为平点.
</p>

<h3>极小曲面 (平均曲率为零的曲面)</h3>

[来自 Riemann Geometry an Introduction]

<p class="example">
  <b>The catenoid (Euler, 1740)</b> `sqrt(x^2+y^2) = cosh z`.
</p>

<p class="proof">
  此为旋转曲面, 取参数
  <span class="formula">
    `bm r = (u cos v, u sin v, "arch "u)`
    `= (u cos v, u sin v, ln(u + sqrt(u^2-1)))`,
  </span>
  令 `f(u) = u`, `g(u) = ln(u + sqrt(u^2-1))`, 则
  <span class="formula">
    `E = {:f':}^2+{:g':}^2`
    `= 1 + 1/(u^2-1) = u^2/(u^2-1)`,
    `quad F = 0`, `quad G = f^2 = u^2`,<br/>
    `L = (f' g'' - f'' g')/sqrt E`
    `= -u/(u^2-1)^(3//2) * sqrt(u^2-1)/u = 1/(1-u^2)`,
    `quad M = 0`,
    `quad N = (fg')/sqrt E = u/sqrt(u^2-1) * sqrt(u^2-1)/u = 1`,<br/>
    `k_1 = L/E = 1/(1-u^2) * (u^2-1)/u^2` `= -1/u^2`,
    `quad k_2 = N/G = 1/u^2`,<br>
    `quad K = k_1 k_2 = -1/u^4`, `quad H = (k_1 + k_2)/2 = 0`.
  </span>
</p>

<p class="example">
  <b>The helicoid (Meusnier, 1776)</b> `tan z = x//y`.
</p>

<p class="proof">
  取参数 `bm r = (u v, v, arctan u)`, 则
  <span class="formula">
    `bm r_u = (v, 0, 1/(1+u^2))`,
    `bm r_v = (u, 1, 0)`,
    `bm r_u ^^ bm r_v = (-1/(1+u^2), u/(1+u^2) v)`,<br>
    `bm r_(u u) = (0, 0, (-2u)/(1+u^2)^2)`,
    `bm r_(u v) = (1, 0, 0)`,
    `bm r_(v v) = (0, 0, 0)`.
  </span>
  记 `|bm r_u ^^ bm r_v| = n`, `|E, F; F, G| = Delta`, 有
  <span class="formula">
    `E = v^2 + 1/(1+u^2)^2`, `F = u v`, `G = u^2 + 1`,<br>
    `L = 1/n (-2u v)/(1+u^2)^2`, `M = -1/n 1/(1+u^2)`, `N = 0`.
  </span>
  最终
  <span class="formula">
    `[a, b; c, d]`
    `= 1/n 1/Delta [(-2 u v)/(1+u^2)^2, -1/(1+u^2); -1/(1+u^2), 0]`
    `[u^2+1, -u v; -u v, v^2+1/(1+u^2)^2]`,<br>
    `H = 1/n 1/Delta ((-u v)/(1+u^2) + (u v)/(1+u^2)) = 0`.
  </span>
</p>

<p class="example">
  <b>Scherk's surface, 1835</b> `"e"^z = (cos x)/(cos y)`,
  即 `z = ln cos x - ln cos y`
  `= int_y^x tan t dt`.
</p>

<p class="proof">
  取参数 `bm r = (u, v, ln cos u - ln cos v)`, 则
  <span class="formula">
    `bm r_u = (1, 0, -tan u)`,
    `bm r_v = (0, 1, tan v)`.
    `bm r_u ^^ bm r_v = (tan u, -tan v, 1)`,<br>
    `bm r_(u u) = (0, 0, -sec^2 u)`,
    `bm r_(u v) = (0, 0, 0)`
    `bm r_(v v) = (0, 0, sec^2 v)`.
  </span>
  于是
  <span class="formula">
    `E = 1 + tan^2 u = sec^2 u`,
    `F = -tan u tan v`,
    `G = 1 + tan^2 v = sec^2 v`,<br>
    `L = -sec^2 u // n`, `M = 0`, `N = sec^2 v // n`
  </span>
  最终
  <span class="formula">
    `[a, b; c, d]`
    `= 1/n 1/Delta [sec^2 u, -tan u tan v; -tan u tan v, sec^2 v]`
    `[sec^2 v, 0; 0, -sec^2 u]`,<br>
    `H = 1/n 1/Delta(sec^2 u sec^2 v - sec^2 u sec^2 v) = 0`.
  </span>
</p>

<script src="../../js/note.js?type=math"></script>
</body>
</html>
