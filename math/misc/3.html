<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <title>不等式</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" type="text/css" href="../../css/note.css" />
</head>
<body>

<h2>空间中的不等式</h2>

<h3>Cauchy-Schwarz 不等式</h3>

<p class="theorem">
	<b>Cauchy-Schwarz 不等式</b>
	设 `x_k, y_k` 是非零实数, `k = 1, 2, cdots, n`. 则
	<span class="formula">
		`|sum_(k=1)^n x_k y_k|`
		`le sqrt(sum_(k=1)^n x_k^2)sqrt(sum_(k=1)^n y_k^2)`,
	</span>
	等号成立当且仅当存在实数 `t`, 使得 `y_k = t x_k`, `k = 1, 2, cdots,
	n`.
</p>

<p class="proof">
	设二次函数
	<span class="formula">
		`f(t) = sum_(k=1)^n (x_k t - y_k)^2`
		`= (sum_(k=1)^n x_k^2) t^2 - 2(sum_(k=1)^n x_k y_k) x`
		`+ sum_(k=1)^n y_k^2 ge 0`.
	</span>
	因此, 其判别式
	<span class="formula">
		`Delta/4 = (sum_(k=1)^n x_k y_k)^2 - (sum_(k=1)^n
		x_k^2)(sum_(k=1)^n y_k^2) le 0`,
	</span>
	此即要证的不等式. 其中
	<span class="formula">
		等号成立 `iff Delta = 0`
		`iff f` 存在惟一实根 `t`
		`iff EE t in RR`, `x_k t - y_k = 0`, `k = 1, 2, cdots, n`.
	</span>
</p>

<p class="proof">
	由 <a href="../number/5.html">Lagrange 恒等式</a>
	<span class="formula">
		`(sum_(i=1)^n x_i^2)(sum_(i=1)^n y_i^2)`
		`= (sum_(i=1)^n x_i y_i)^2
		+ sum_(1 le i lt j le n) (x_i y_j - x_j y_i)^2`.
	</span>
	立即得到 Cauchy 不等式.
</p>

<ol class="theorem">
	<b>内积空间中的 Cauchy-Schwarz 不等式</b>
	设 `V` 是数域 `bbb F` 上一线性空间, `(*,*)` 是 `V`
	上正定的对称双线性函数, 满足
	<li>正定性. `(AA x in V)` `(x, x) ge 0`, 等号成立当且仅当 `x = 0`;
	</li>
	<li>共轭对称性. `(AA x, y in V)` `(x, y) = bar((y","x))`;</li>
	<li>关于第一变元的线性性和第二变元的共轭线性性.
		`(AA x, y, z in V)` `(AA k, l in bbb F)`
		<span class="formula">
			`(k x+l y, z) = k(x, z) + l(y, z)`,<br/>
			`(z, k x+l y) = bar k(z, x) + bar l(z, y)`.
		</span>
	</li>
	现在引入
	<span class="formula">
		`||x|| = sqrt((x","x))`,
	</span>
	则成立不等式
	<span class="formula">
		`|(x, y)| le ||x||*||y||`.
	</span>
</ol>

<h3>三角不等式</h3>

<p class="lemma">
	设 `x in RR`, `M ge 0`, 则
	<span class="formula">
		`|x| le M iff -M le x le M`.
	</span>
</p>

<p class="theorem">
	<b>实数的三角不等式</b>
	设 `x, y in RR`, 则
	<span class="formula">
		`|x+y| le |x| + |y|`,
	</span>
	等号成立当且仅当 `x, y` 同号, 即 `x y ge 0`.
</p>

<p class="proof">
	显然 `|x| le |x|`, `|y| le |y|`,
	由引理, 这等价于
	<span class="formula">
		`-|x| le x le |x|`, `quad -|y| le y le |y|`.
	</span>
	两式相加,
	<span class="formula">
		`-(|x|+|y|) le x+y le |x|+|y|`.
	</span>
	再由引理, 这等价于要证的不等式.
	等号成立当且仅当
	<span class="formula">
		(`x = |x|` 且 `y = |y|`) 或 (`x = -|x|` 且 `y = -|y|`).
	</span>
	这等价于 `x y ge 0`.
</p>

<p class="corollary">
	设 `x, y in RR`, 则
	<span class="formula">
		`|{:|x| - |y|:}| le |x + y| le |x| + |y|`.
	</span>
	第一个等号成立当且仅当 `x y le 0`, 第二个等号成立当且仅当 `x y ge 0`.
</p>

<p class="proof">
	由三角不等式得
	<span class="formula">
		`|x| = |(x+y)+(-y)| le |x+y| + |y|`,
	</span>
	即 `|x| - |y| le |x+y|`;
	同理 `|y| - |x| le |x+y|`, 所以得到左边的不等式.
	这个不等式的等号成立当且仅当
	`(x+y)(-y) ge 0`, 或 `(y+x)(-x) ge 0`.
	两种情形都推出 `x y le 0`.
	反之若 `x y le 0`, 不妨设 `|x| ge |y|`, 则不等式左边等于
	`|x|-|y|`, 而另一边等于 `|x+y| = |x|-|y|`, 所以两边相等.
</p>

<p class="theorem">
	<b>Euclid 空间的三角不等式</b>
	设 `bm x = (x_1, x_2, cdots, x_n)`,
	`bm y = (y_1, y_2, cdots, y_n) in E^n`, 则
	<span class="formula">
		`|bm x + bm y| le |bm x| + |bm y|`,
	</span>
	即
	<span class="formula">
		`sqrt(sum_(k=1)^n (x_k+y_k)^2)`
		`le sqrt(sum_(k=1)^n x_k^2) + sqrt(sum_(k=1)^n y_k^2)`.
	</span>
</p>

<p class="proof">
	事实上, 这是 Minkowski 不等式取 `p = 2` 的情形. 当然也可以用 Cauchy
	不等式证之:
	<span class="formula">
		`sum_(k=1)^n (x_k+y_k)^2`
		`= sum_(k=1)^n x_k^2 + sum_(k=1)^n y_k^2 + 2 sum_(k=1)^n x_k y_k`
		`le sum_(k=1)^n x_k^2 + sum_(k=1)^n y_k^2`
		`+ 2 sqrt(sum_(k=1)^n x_k^2) sqrt(sum_(k=1)^n y_k^2)`
		`= (sqrt(sum_(k=1)^n x_k^2) + sqrt(sum_(k=1)^n y_k^2))^2`.
	</span>
	两边开方即得结果.
</p>

<p class="example">
  设 `bm a, bm b in RR^n`, `a, b` 是它们的模, 则
  <span class="formula">
    `|a^2-b^2| le |bm a+bm b| |bm a-bm b| le a^2+b^2`.
  </span>
</p>

<ol class="proof">
  <li>由 Cauchy 不等式 `|bm a * bm b| le |bm a| |bm b|` 得,
    <span class="formula">
      `|a^2-b^2| = |(bm a+bm b) * (bm a-bm b)|`
      `le |bm a+bm b| |bm a - bm b|`.
    </span>
  </li>
  <li>
    <span class="formula">
      `|bm a+bm b|^2 |bm a-bm b|^2`
      `= (a^2+b^2 + 2 bm a * bm b)(a^2+b^2 - 2 bm a * bm b)`
      `= (a^2+b^2)^2 - 4(bm a*bm b)^2`
      `le (a^2+b^2)^2`.
    </span>
  </li>
</ol>

<h2>Jensen 不等式</h2>

<h3>Jensen - Young - Hölder - Minkowski</h3>

[<a href="https://zhuanlan.zhihu.com/p/55307171">知乎</a>, 崔尚斌《数学分析教程》上册]

<p class="theorem">
	<b>Jensen 不等式</b>
	设 `f` 是区间 `I` 上的下凸函数, `x_k in I`, `w_k in (0, 1)`,
	`k = 1, 2, cdots, n`. 其中 `sum_(k=1)^n w_k = 1`. 则
	<span class="formula">
		`f(sum_(k=1)^n w_k x_k) le sum_(k=1)^n w_k f(x_k)`.
	</span>
	进一步, 若 `f` 在 `I` 上严格下凸, 则不等式中等号成立当且仅当
	`x_1 = x_2 = cdots = x_n`.
	另外, 若 `f` 在 `I` 上是上凸函数, 取 `g = -f` 知, 对 `f`
	成立反向的不等号.
</p>

<p class="proof">
	对 `n` 进行归纳. `n = 1` 时不等式是平凡的等式.
	设不等式对 `n-1 ge 1` 成立, 则对正整数 `n`, 有
	<span class="formula">
		`f(sum_(k=1)^n w_k x_k)`
		`= f(sum_(k=1)^(n-1) w_k x_k + w_n x_n)`
		`= f((1-w_n) sum_(k=1)^(n-1) (w_k x_k)/(1-w_n) + w_n x_n)`
		(由函数下凸) `le (1-w_n) f(sum_(k=1)^(n-1) (w_k x_k)/(1-w_n))
		+ w_n f(x_n)`
		(由归纳假设) `le (1-w_n) sum_(k=1)^(n-1) (w_k f(x_k))/(1-w_n) +
		w_n f(x_n)`
		`= sum_(k=1)^n w_k f(x_k)`.
	</span>
	如果 `f` 是严格下凸函数且 `x_1, x_2, cdots, x_n` 不全相等, 那么当
	`sum_(k=1)^(n-1) (w_k x_k)/(1-w_n) != x_n` 时,
	上面推导的第一个不等式中的等号不成立. 而 `sum_(k=1)^(n-1) (w_k
	x_k)/(1-w_n) = x_n` 时, 则断言 `x_1, x_2, cdots, x_(n-1)` 不全相等
	(否则设 `x_1 = x_2 = cdots = x_(n-1)`, 有
	<span class="formula">
		`x_n = sum_(k=1)^(n-1) (w_k x_k)/(1-w_n)`
		`= x_1 sum_(k=1)^(n-1) w_k/(1-w_n)`
		`= x_1 = x_2 = cdots = x_(n-1)`,
	</span>
	矛盾).
	由归纳假设, 只要 `x_1, x_2, cdots x_(n-1)` 不全相等,
	上面推导的第二个不等式的等号不成立. 从而上面的不等式是严格不等式.
</p>

<p class="theorem">
	<b>Young 不等式</b>
	设 `x, y gt 0`, `p, q gt 1`, 且 `1/p + 1/q = 1`, 则
	<span class="formula">
		`x y le x^p/p + y^q/q`.
	</span>
	等号成立当且仅当 `x^p = y^q`.
</p>

<p class="proof">
	由于 `f(x) = ln x` 是严格上凸函数, 所以对 `x^p, y^q gt 0` 有
	<span class="formula">
		`1/p ln x^p + 1/q ln y^q le ln (x^p/p + y^q/q)`.
	</span>
	其中等号成立当且仅当 `x^p = y^q`. 取指数即得结论.
</p>

<p class="remark">
	设 `p, q gt 1`, 则
	<span class="formula">
		`1/p + 1/q = 1 iff p + q = p q iff (p-1)(q-1) = 1`.
	</span>
</p>

<p class="remark">
	Young 不等式的几何解释: 令 `y = x^(p-1)`, 则 `x = y^(q-1)`,
	即 `y = x^(p-1)` 和 `x = y^(q-1)` 表示同一条曲线. 由积分的几何意义,
	矩形的面积小于等于两个曲边三角形的面积之和, 即
	<span class="formula">
		`a b le int_0^a x^(p-1) dx + int_0^b y^(q-1) dy`
		`= a^p/p + b^q/q`.
	</span>
	<img src="" alt="[图片暂缺]">
</p>

<p class="theorem">
	<b>Hölder 不等式 (Hardy 不等式)</b>
	设 `x_k, y_k gt 0`, `k = 1, 2, cdots, n`.
	`p, q gt 1` 且 `1/p+1/q = 1`. 则
	<span class="formula">
		`sum_(k=1)^n x_k y_k le (sum_(k=1)^n x_k^p)^(1/p) (sum_(k=1)^n
		y_k^q)^(1/q)`,
	</span>
	等号成立当且仅当所有 `x_k^p/y_k^q` 都相等 (都等于 `(sum x_k^p)/(sum
	y_k^q)`).
	分别以 `x_k, y_k` 替换 `x_k^p`, `y_k^q`, 得到另一形式:
	<span class="formula">
		`sum_(k=1)^n x_k^(1/p) y_k^(1/q) le (sum_(k=1)^n x_k)^(1/p)
		(sum_(k=1)^n y_k)^(1/q)`,
	</span>
	等号成立当且仅当所有 `x_k/y_k` 都相等 (都等于 `(sum x_k)/(sum y_k)`).
	特别取 `p = q = 2` 时, 得到 Cauchy 不等式.
</p>

<p class="proof">
	记 `sum_(k=1)^n x_k^p = A`, `sum_(k=1)^n y_k^q = B`.
	使用 Young 不等式, 对 `k = 1, 2, cdots, n` 有
	<span class="formula">
		`(x_k^p/A)^(1/p) (y_k^q/B)^(1/q)`
		`le 1/p x_k^p/A + 1/q y_k^q/B`.
	</span>
	关于 `k` 求和,
	<span class="formula">
		`1/(A^(1/p) B^(1/q)) sum_(k=1)^n x_k y_k le 1/p + 1/q = 1`.
	</span>
	所以原不等式成立. 由 Young 不等式的取等条件容易推出 Hölder
	不等式的取等条件.
</p>

<p class="corollary">
	<b>Minkowski 不等式</b>
	设 `x_k, y_k gt 0`, `k = 1, 2, cdots, n`. 又设 `p ge 1`, 则
	<span class="formula">
		`(sum_(k=1)^n (x_k+y_k)^p)^(1/p) le (sum_(k=1)^n x_k^p)^(1/p) +
		(sum_(k=1)^n y_k^p)^(1/p)`.
	</span>
	Minkowski 不等式适合用作一些度量空间的三角不等式.
</p>

<p class="proof">
	`p = 1` 的情形是平凡的. 下面设 `p gt 1`,
	取实数 `q` 使得 `1/p + 1/q = 1`. 由 Hölder 不等式有
	<span class="formula">
		`sum_(k=1)^n x_k (x_k+y_k)^(p//q) le (sum_(k=1)^n x_k^p)^(1/p)
		(sum_(k=1)^n (x_k+y_k)^p)^(1/q)`,<br/>
		`sum_(k=1)^n y_k (x_k+y_k)^(p//q) le (sum_(k=1)^n y_k^p)^(1/p)
		(sum_(k=1)^n (x_k+y_k)^p)^(1/q)`.
	</span>
	两式相加, 注意 `p/q + 1 = p/q + p/p = p`,
	<span class="formula">
		`sum_(k=1)^n (x_k+y_k)^p`
		`le [(sum_(k=1)^n x_k^p)^(1/p) + (sum_(k=1)^n y_k^p)^(1/p)]`
		`(sum_(k=1)^n (x_k+y_k)^p)^(1/q)`.
	</span>
	两边同乘以 `(sum_(k=1)^n (x_k+y_k)^p)^(-1/q)` 即得结果.
</p>

<p class="example">
  求 `y = sqrt(x^2+1) + sqrt((2-x)^2 + 4)` 的最小值.
  类似地, `sqrt(x^2-2x+2) + sqrt(x^2-8x+20) ge 3 sqrt2`.
</p>

<p class="solution">
  利用 Minkowski 不等式, `y ge sqrt((x+2-x)^2 + (1+2)^2) = sqrt 13`.
  当然也可以用 Cauchy 不等式. 毕竟 Minkowski 不等式是 Hölder
  不等式的推论.
</p>

<p class="solution">
  `y` 等于点 `(x, 0)` 到 `A(0, 1)` 与 `B(2, 2)` 的距离之和. 为求最小值,
  作 `(0, 1)` 关于 `x` 轴的对称点 `A'(0, -1)`, 则 `y ge |A'B| = sqrt 13`.
</p>

<p class="remark">
	虽然我们是用 Young 不等式导出了本节后面的几个不等式, 但实际上,
	包括 Young 不等式在内, 它们都能用 Jensen 不等式直接导出.
	例如, 取 `f(x) = x^(1/p)`, 其中 `p gt 1`, 则 `f''(x) lt 0`.
	应用 Jensen 不等式得到凸性不等式
	<span class="formula">
		`sum_(k=1)^n t_k x_k^(1/p) le (sum_(k=1)^n t_k x_k)^(1/p)`,
	</span>
	其中 `x_k gt 0`, `t_k in (0,1)`, `sum_(k=1)^n t_k = 1`.
	再取
	<span class="formula">
		`t_k = y_k^q/(sum_(k=1)^n y_k^q)`,
		`quad x_k = x_k^p/y_k^q`,
		`quad k = 1, 2, cdots,  n`,
	</span>
	利用 `1/p + 1/q = 1` 适当变形即得 Hölder 不等式.
</p>

<h3>权方和不等式</h3>

<p class="theorem">
	<b>权方和不等式</b>
	设 `x_k, y_k gt 0`, `k = 1, 2, cdots, n`, `alpha gt 0`, 则
	<span class="formula">
		`(sum_(k=1)^n x_k)^(alpha+1)/(sum_(k=1)^n y_k)^alpha le sum_(k=1)^n x_k^(alpha+1)/y_k^alpha`,
	</span>
	等号成立当且仅当所有 `x_k/y_k` 都相等 (都等于 `(sum x_k)/(sum y_k)`).
	<br/>
	权方和不等式等价于 Hölder 不等式,
	是求解分式条件极值的利器, 其特征是分子幂次比分母高一次.
	其中 `alpha = 1` 的情形 (等价于 Cauchy 不等式) 最为常用.
</p>

<p class="proof">
	在 Hölder 不等式 (第二形式) 中取
	`1/p = 1/(alpha+1)`, `1/q = alpha/(alpha+1)`,
	<span class="formula">
		`x_k = x_k^(alpha+1)/y_k^alpha`,
		`quad y_k = y_k`,
		`quad k = 1, 2, cdots, n`
	</span>
	即可, 取等条件由 Hölder 不等式的推出.
</p>

<p class="corollary">
    设 `beta - alpha gt 1`, 其它假设同上, 则
    <span class="formula">
      `(sum x_k)^beta/(sum y_k)^alpha lt sum x^beta/y^alpha`.
    </span>
</p>

<p class="proof">
  记 `epsi = beta - alpha - 1 gt 0`, 由权方和不等式,
  <span class="formula">
    `(sum x_k)^beta/(sum y_k)^alpha`
    `= (sum x_k)^beta/(sum y_k)^(beta-1-epsi)`
    `le (sum y_k)^-epsi sum x_k^beta/y_k^(beta-1)`
    `lt (sum y_k)^-epsi sum x_k^beta/y_k^(beta-1) ((sum y_k)/y_k)^epsi`
    `= sum x_k^beta/y_k^alpha`.
  </span>
</p>

<ol class="example">
	本例可以用权方和不等式, 也可以用 Cauchy 不等式.
	<li>设 `a, b, x, y gt 0`, `x^2 + y^2 = k`, 求 `a x + b y`
		的最大值;
	</li>
	<li>[<a href="https://wenku.baidu.com/view/6a33034bfad6195f302ba618.html">权方和不等式的应用</a>]
		设 `a, b, c, d, x, y gt 0`, 求 `min{a x^2 + b y^2 | c x + d y = k}`.
	</li>
</ol>

<ol class="solution">
	<li>利用权方和不等式 (`alpha = 1`),
		<span class="formula">
			`(a x + b y)^2/(a^2 + b^2)`
			`le (a x)^2/a^2 + (b y)^2/b^2`
			`= k`,
		</span>
		故
		<span class="formula">
			`a x + b y le sqrt(k(a^2 + b^2))`,
		</span>
		等号成立当且仅当 `x/a = y/b`.
	</li>
	<li>利用权方和不等式 (`alpha = 1`),
		<span class="formula">
			`a x^2 + b y^2`
			`= (c x)^2/(c^2//a) + (d y)^2/(d^2//b)`
			`ge (c x + d y)^2/(c^2//a + d^2//b)`
			`= k^2/(c^2//a + d^2//b)`,
		</span>
		等号成立当且仅当 `a/c x = b/d y = k/(c^2//a + d^2//b)`.
	</li>
</ol>

<ol class="solution">
	<li>利用 Cauchy 不等式,
		<span class="formula">
			`(a x + b y)^2 le (a^2 + b^2)(x^2 + y^2) = k(a^2+b^2)`,
		</span>
		故
		<span class="formula">
			`a x + b y le sqrt(k(a^2+b^2))`,
		</span>
		等号成立当且仅当 `x/a = y/b`.
	</li>
	<li>利用 Cauchy 不等式,
		<span class="formula">
			`(c/(sqrt a) sqrt a x + d/(sqrt b) sqrt b y)^2`
			`le (c^2/a + d^2/b)(a x^2 + b y^2)`,
		</span>
		故
		<span class="formula">
			`(a x^2 + b y^2) ge k^2/(c^2//a + d^2//b)`,
		</span>
		等号成立当且仅当 `c/(a x) = d/(b y)`.
	</li>
</ol>

<p class="example">
	设 `x in [0, pi//2]`, 求 `1/(sin x) + 8/(cos x)` 的最小值.
</p>

<p class="solution">
	利用权方和不等式 (`alpha = 1`), 原式等于
	<span class="formula">
		`1^2/(sin x) + 4^2/(2 cos x)`
		`ge (1+4)^2/(sin x + 2 cos x)`
		`= 5^2/(sqrt 5 sin(x+varphi))`
		`ge 5 sqrt 5`.
	</span>
</p>

<p class="solution">
	用 Cauchy 不等式的做法, 可能不太直观:
	<span class="formula">
		`(1 + 4)^2`
		`= (1/sqrt(sin x) sqrt(sin x) + 4/sqrt(2 cos x) sqrt(2 cos x))^2`
		`le (1^2/(sin x) + 4^2/(2 cos x))(sin x + 2 cos x)`,
	</span>
	因此
	<span class="formula">
		`1/(sin x) + 8/(cos x) ge 5^2/(sin x + 2 cos x)`.
	</span>
	后面的处理是一样的.
</p>

<p class="example">
	[<a href="https://wenku.baidu.com/view/6a33034bfad6195f302ba618.html">权方和不等式的应用</a>]
	设 `a, b, c gt 0`, `a b c = 1`, 求 `1/(a^3(b+c)) + 1/(b^3(c+a))
	+ 1/(c^3(a+b))` 的最小值.
</p>

<p class="solution">
	利用权方和不等式, 原式等于
	<span class="formula">
		`a^-2/(a(b+c)) + b^-2/(b(c+a)) + c^-2/(c(a+b))`
		`ge (a^-1+b^-1+c^-1)^2/(2(a b+b c+c a))`
		`= 1/2 (a b+b c+c a)/(a b c)^2`
		`= 1/2 (a b+b c+c a)`
		`ge 3/2 root 3 (a b b c c a)`
		`= 3/2`,
	</span>
	等号成立当且仅当 `a = b = c = 1`.
</p>

<p class="example">
	设 `a, b, c gt 0`, `a b + b c + c a = 1`, 求 `a^3/(b+c) + b^3/(c+a)
	+ c^3/(a+b)` 的最小值.
</p>

<p class="solution">
	由权方和不等式, 原式等于
	<span class="formula">
		`a^4/(a(b+c)) + b^4/(b(c+a)) + c^4/(c(a+b))`
		`ge (a^2+b^2+c^2)^2/(2(a b+b c+c a))`
		`ge (a b+b c+c a)/2 = 1/2`.
	</span>
</p>

<h3>均值不等式</h3>

<p class="lemma">
	<b>一个配方不等式</b>
	设 `x, y in RR`, 则
	`(x-y)^2 ge 0` `rArr 2 x y le x^2 + y^2`.
	显见等号成立当且仅当 `x = y`.
</p>

<p class="corollary">
	在引理的不等式两边同时加上 `x^2+y^2` 得 `(x+y)^2 le 2(x^2+y^2)`.
	可以用 `x^2, y^2` 分别代替原不等式的 `x, y`, 得到
	`2 x^2 y^2 le x^4 + y^4`, `(x^2+y^2)^2 le 2(x^4 + y^4)`, 等等.
	如果用 `sqrt x, sqrt y` 分别代替引理中不等式的 `x, y`, 就得到:
</p>

<p class="theorem">
	<b>二元均值不等式</b>
	设 `x, y gt 0`, 则
	<span class="formula">
		`sqrt(x y) le (x+y)/2`,
	</span>
	等号成立当且仅当 `x = y`.
</p>

<p class="theorem">
	<b>均值不等式</b>
	设 `x_1, x_2, cdots, x_n gt 0`, 则
	<span class="formula">
		`root n (prod_(k=1)^n x_k) le 1/n sum_(k=1)^n x_k`,
	</span>
	等号成立当且仅当 `x_1 = x_2 = cdots = x_n`.
</p>

<p class="proof">
	利用 Jensen 不等式的简单证明.
	取 `f(x) = ln x`, 它是区间 `(0, +oo)` 上的上凸函数. 取 `t_k = 1/n`,
	于是对任意 `x_1, x_2, cdots, x_n gt 0`,
	<span class="formula">
		`1/n sum_(k=1)^n ln x_k le ln(1/n sum_(k=1)^n x_k)`,
	</span>
	等号成立当且仅当 `x_1 = x_2 = cdots = x_n`. 两端取指数, 得到
	<span class="formula">
		`root n(prod_(k=1)^n x_k) le 1/n sum_(k=1)^n x_k`.
	</span>
</p>

<p class="proof">
	先证结论对所有 2 的正整数幂成立. 这是因为 `n=2` 的情形已证, 而
	<span class="formula">
		`x_1+x_2+cdots+x_n ge n root n (x_1 x_2 cdots x_n)`<br/>
		`rArr x_1 + x_2 + cdots + x_(2n)`
		`ge n (root n (x_1 cdots x_n) + root n (x_(n+1) cdots x_(2n)))`
		`ge 2n root(2n) (x_1 x_2 cdots x_(2n))`.
	</span>
	再来说明不等式对 `n` 成立可推出对 `n-1` 成立.
	记 `x_1 + x_2 + cdots + x_(n-1) = s`, 再取 `x_n = s/(n-1)`,
	由归纳假设,
	<span class="formula">
		`s + s/(n-1)`
		`= x_1 + cdots + x_n`
		`ge n root n(x_1 cdots x_n)`
		`= n root n((x_1 cdots x_(n-1) s)/(n-1))`
	</span>
	两边取 `n` 次方, 整理得到
	<span class="formula">
		`s ge (n-1) root (n-1) (x_1 cdots x_(n-1))`.
	</span>
	现在由 Cauchy 归纳法, 结论成立.
	<span style="float: right">奇怪的归纳法增加了!</span>
</p>

<p class="proof">
	对 `n` 进行归纳证明. `n = 1` 时不等式是平凡的等式.
	假设不等式对 `n ge 1` 成立, 则对正整数 `n+1`, 记 `A_n = 1/n
	sum_(k=1)^n x_k`, 有
	<span class="formula">
		`A_(n+1)`
		`= 1/2 ((n+1)/n A_(n+1) + (n-1)/n A_(n+1))`
		`= 1/2 (1/n sum_(k=1)^(n+1) x_k + (n-1)/n A_(n+1))`
		`= 1/2 (1/n sum_(k=1)^n x_k  + 1/n x_(n+1) + (n-1)/n A_(n+1))`
		(归纳假设)
		`ge 1/2 (root n(prod_(k=1)^n x_k)
		+ root n(x_(n+1) * A_(n+1)^(n-1)))`
		(二元均值不等式)
		`ge root (2n)(prod_(k=1)^(n+1) x_k * A_(n+1)^(n-1))`.
	</span>
	整理得到
	<span class="formula">
		`A_(n+1) ge root(n+1)(prod_(k=1)^(n+1) x_k)`.
	</span>
	因此不等式对任意正整数 `n` 成立.<br/>
	再看取等条件. 这个条件的充分性显然, 下证必要性.
	`n = 2` 时, 二元均值不等式的取等条件是 `x_1 = x_2`.
	现在设取等条件对 `n` 元均值不等式成立, 则当 `n+1`
	元均值不等式取得等号时, 上述推导过程的两个不等式中的等号都应当成立,
	即 `prod_(k=1)^n x_k = x_(n+1) A_(n+1)^(n-1)`,
	且 `x_1 = x_2 = cdots = x_n`.
	记 `x_k^(1//(n-1)) = a_k`, 有
	<span class="formula">
		`x_1^n = x_(n+1) ((n x_1 + x_(n+1))/(n+1))^(n-1)`,<br/>
		`(n+1) a_1^n = a_(n+1) (n x_1 + x_(n+1))`,<br/>
		`n a_1^(n-1) (a_1 - a_(n+1)) + a_1^n - a_(n+1)^n = 0`,<br/>
		`(a_1-a_(n+1))` `(n a_1^(n-1)
		+ sum_(k=0)^(n-1) a_1^k a_(n+1)^(n-k)) = 0`.
	</span>
	这推出 `a_1 = a_(n+1)`, 从而 `x_1 = x_2 = cdots = x_n = x_(n+1)`,
	证毕.
</p>

<p class="corollary">
	设 `x_1, x_2, cdots, x_n gt 0`, 则
	<span class="formula">
		`(1/n sum_(k=1)^n x_k^-1)^-1`
		`le exp(1/n sum_(k=1)^n ln x_k)`
		`le 1/n sum_(k=1)^n x_k`
		`le (1/n sum_(k=1)^n x_k^2)^(1/2)`,
	</span>
	所有等号成立当且仅当 `x_1 = x_2 = cdots = x_n`.
</p>

<ol class="proof">
	<li>对 `x_k^-1`, `k = 1, 2, cdots, n` 应用均值不等式,
		<span class="formula">
			`root n(prod_(k=1)^n x_k^-1) le 1/n sum_(k=1)^n x_k^-1`,
		</span>
		两边取倒数即得第一个不等式.
	</li>
	<li>由 Cauchy 不等式,
		<span class="formula">
			`(sum_(k=1)^n 1 x_k)^2 le (sum_(k=1)^n 1^2)(sum_(k=1)^n
			x_k^2)`,
		</span>
		两边同除以 `n^2` 再开平方即得到第三个不等式.
	</li>
	容易知道, 这些不等式取等号的充要条件都是 `x_1 = x_2 = cdots = x_n`.
</ol>

<p class="remark">
	我们把 `(1/n sum_(k=1)^n x_k^-1)^-1` 称为这 `n`
	个数的<b>调和平均数</b>, `exp(1/n sum_(k=1)^n ln x_k)`
	`= root n(prod_(k=1)^n x_k)`
	称为它们的<b>几何平均数</b>, `1/n sum_(k=1)^n x_k`
	称为它们的<b>算术平均数</b>. 下图展示了二元均值不等式:
</p>

<div class="img md">
	<img src="../img/ag-inequality.svg"/>
</div>

<p class="example">
	设 `a, b gt 0`.
	证明: 数列 `x_n = root(n)((a^n+b^n)/2)` 单调递增.
</p>

<p class="proof">
	(zmx可以从这道题的证明中凭吊高中时代的遗迹)
	只需证对任意正整数 `n`,
	<span class="formula">
		`  root(n)((a^n+b^n)/2)
		le root(n+1)(( a^(n+1) + b^(n+1) )/2)`.
	</span>
	即证
	<span class="formula">
		`(a^n+b^n)^(n+1) le 2( a^(n+1)+b^(n+1) )^n`.
	</span>
	当 `n=1` 时, 上述不等式即 `(a+b)^2 le 2(a^2+b^2)`, 显然成立.
	假设当 `n=k` 时不等式成立, 即

		`(a^k+b^k)^(k+1) / ( a^(k+1)+b^(k+1) )^k le 2`.

	则 `n=k+1` 时, 断言
	<span class="formula">
		`	( a^(k+1)+b^(k+1) )^(k+2) / ( a^(k+2)+b^(k+2) )^(k+1)
		le	(a^k+b^k)^(k+1) / ( a^(k+1)+b^(k+1) )^k`
		<span class="label" id="for-exp-inequality-to-prove"></span>
	</span>
	成立, 这只要证
	<span class="formula">
		`	( a^(k+1)+b^(k+1) )^(2(k+1))
		le	[ (a^k+b^k) ( a^(k+2) + b^(k+2) ) ] ^ (k+1)`,
	</span>
	即证
	<span class="formula">
		`	( a^(k+1)+b^(k+1) )^2
		le	(a^k+b^k)( a^(k+2)+b^(k+2) )`,
	</span>
	即证
	<span class="formula">
		`2(ab)^(k+1) le (ab)^k (a^2+b^2)`.
	</span>
	即证 `2ab le a^2+b^2`. 这显然成立. 所以 <a class="ref"
		href="#for-exp-inequality-to-prove"></a> 成立, 从而
	`n=k+1` 时不等式成立. 再由数学归纳法知原命题成立.
</p>

<ol class="theorem">
	<b>幂平均值不等式</b>
	设 `x_1, x_2, cdots, x_n gt 0`, `alpha in RR uu {+oo, -oo}`, 则函数
	<span class="formula">
		`(1/n sum_(k=1)^n x_k^alpha)^(1/alpha)`
	</span>
	关于参数 `alpha` 单调递增.
	其中 `alpha = 0, +oo, -oo` 的情形考虑极限:
	<span class="formula">
		`lim_(alpha to 0) (1/n sum_(k=1)^n x_k^alpha)^(1/alpha)`
		`= exp(1/n sum_(k=1)^n ln x_k)`
		`= root n(prod_(k=1)^n x_k)`,<br/>
		`lim_(alpha to +oo) (1/n sum_(k=1)^n x_k^alpha)^(1/alpha)`
		`= max_k x_k`,
		`lim_(alpha to -oo) (1/n sum_(k=1)^n x_k^alpha)^(1/alpha)`
		`= min_k x_k`.
	</span>
</ol>

<ol class="proof">
	用 Hölder 不等式来证明, 使用 Jensen 不等式的证法留给读者.
	<li>先设 `0 lt alpha lt beta`.
		取 `p = beta/alpha gt 1`, 又取实数 `q` 使得 `1/p + 1/q = 1`.
		记 `y_k = x_k^alpha`, 则
		由 Hölder 不等式有
		<span class="formula">
			`sum_(k=1)^n y_k * 1
			le (sum_(k=1)^n y_k^p)^(1/p) (sum_(k=1)^n 1^q)^(1/q)`,<br/>
			`(1/n)^(1/q) sum_(k=1)^n y_k
			le (sum_(k=1)^n y_k^p)^(1/p)`,<br/>
			`1/n sum_(k=1)^n y_k
			le (1/n sum_(k=1)^n y_k^p)^(1/p)`,<br/>
			`1/n sum_(k=1)^n x_k^alpha
			le (1/n sum_(k=1)^n x_k^beta)^(alpha/beta)`,
		</span>
		即得到要证的不等式
		<span class="formula">
			`(1/n sum_(k=1)^n x_k^alpha)^(1/alpha)`
			`le (1/n sum_(k=1)^n x_k^beta)^(1/beta)`.
		</span>
	</li>
	<li>再设 `alpha lt beta lt 0`. 对 `0 lt -beta lt -alpha` 和实数
		`x_1^-1, x_2^-1, cdots, x_n^-1` 应用不等式得,
		<span class="formula">
			`(1/n sum_(k=1)^n x_k^alpha)^(-1/alpha) ge (1/n sum_(k=1)^n
			x_k^beta)^(-1/beta)`.
		</span>
		两边取倒数即得到要证的不等式.
	</li>
	<li>最后, 由连续性得到 `alpha` 等于 `0`, `+oo` 或 `-oo` 的情形.
	</li>
</ol>

<p class="remark">
	此定理是均值不等式的推广.
	`x_1, x_2, cdots, x_n` 的函数 `(1/n sum_(k=1)^n x_k^alpha)^(1/alpha)`
	在参数 `alpha` 取 `-oo`, `-1`, `0`, `1`, `+oo`
	时, 分别取得最小值, 调和平均, 几何平均, 算术平均和最大值.
</p>

<h2>三元不等式</h2>

<h3>两个记号</h3>

<p class="definition">
	<b>轮换求和记号</b>
	<span class="formula">
		`sum_"cyc" f(a, b, c) := f(a, b, c) + f(b, c, a) + f(c, a, b)`.
	</span>
	不引起混淆的情况下, `sum_"cyc"` 可简记为 `sum`.
</p>

<ol class="theorem">
	<b>`p q r` 记号</b>
	设 `a, b, c ge 0`,
	<span class="formula">
		`S_2 = a^2 + b^2 + c^2`,
		`quad p = a + b + c`,
		`quad q = a b+b c+c a`,
		`quad r = a b c `,<br/>
		`S_3 = a^3 + b^3 + c^3`,
		`quad q_3 = sum_"cyc" a^2(b+c)`
		`= (a^2 b + b^2 c + c^2 a) + (a b^2 + b c^2 + c a^2)`.
	</span>
	则成立等式
	<span class="formula">
		`S_2 = p^2 - 2q`,
		`quad S_3 = p^3 - 3p q + 3 r`,
		`quad q_3 = p q - 3r`,
		`quad a^-1 + b^-1 + c^-1 = q//r`,
	</span>
	以及以下的三元不等式:
	<li>`3 S_2 ge p^2 ge 3 q ge 9 r^(2/3)`;</li>
	<li>`S_3 ge q_3 - 3r ge 3r`;</li>
	<li>`p q ge 9 r ge 4 p q - p^3`;</li>
</ol>

<ol class="proof enum">
	各等式直接计算验证即可 (`S_2`, `S_3` 可用牛顿公式计算). 下证不等式.
	<li>
	<ol>
		<li>`S_2 = a^2 + b^2 + c^2`
			`= 1/2(a^2 + b^2 + b^2 + c^2 + c^2 + a^2)`
			`ge a b+b c+c a = q`.
		</li>
		<li>在 `S_2 ge q` 两边同时加上 `2q`, 注意到 `p^2 = S_2 + 2 q`,
			得到 `p^2 ge 3 q`.</li>
		<li>在 `S_2 ge q` 左边加上 `2 S_2`, 右边加上 `S_2 + q` 得
			`3 S_2 ge p^2`; 或者, 由 Cauchy 不等式,
			`(1^2+1^2+1^2)(a^2+b^2+c^2)` `ge (a*1+b*1+c*1)^2`.
		</li>
		<li>`q = a b + b c + c a`
			`ge 3 root 3(a b b c c a)`
			`= 3 (a b c)^(2/3) = 3 r^(2/3)`.
		</li>
	</ol>
	</li>

	<li>
	<ol>
		<li>`q_3 = (a^2 b + b^2 c + c^2 a) + (a b^2 + b c^2 + c a^2)`
			`ge 3 root 3(a^2 b b^2 c c^2 a) + 3 root 3(a b^2 b c^2 c a^2)`
			`= 6 a b c = 6r`.
		</li>
		<li>`S_3 ge q_3 - 3 r` 的证明见下一节的<a class="ref" href="#cor-schur"></a>.</li>
	</ol>
	</li>

	<li>
	<ol>
		<li>`p q ge 9 r` 和 `q_3 ge 6r` 等价; 也可由 Cauchy 不等式得到
			`p q//r = (a+b+c) (a^-1 + b^-1 + c^-1) ge 9`.
		</li>
		<li>`9r ge 4p q - p^3` 和 `S_3 ge q_3 - 3r` 等价.</li>
	</ol>
	</li>
</ol>

<h3>Schur 不等式</h3>

<p class="theorem">
	<b>Schur 不等式</b>
	设 `a, b, c ge 0`, `t in RR`, 则
	<span class="formula">
		`sum_"cyc" a^t(a-b)(a-c) ge 0`,
	</span>
	等号成立当且仅当 `a = b = c`, 或其中两数相等且另一数为零.
	特别当 `t` 为非负偶数时, 不等式对任意实数 `a, b, c` 成立.
</p>

<p class="proof">
	由于 `a, b, c` 可以轮换, 不妨设 `b` 的大小在 `a` 和 `c` 中间.
	有两种情形, 先看 `a ge b ge c`. 当 `t gt 0` 时 `a^t ge b^t`,
	`t lt 0` 时 `c^t ge b^t`, 总之有
	<span class="formula">
		`a^t-b^t+c^t ge 0`.
	</span>
	上式在 `a le b le c` 时也成立, 于是
	<span class="formula">`{:
		,  sum_"cyc" a^t(a-b)(a-c);
		=, a^t(a-b)(a-b+b-c) + b^t(b-c)(b-a) + c^t(c-b+b-a)(c-b);
		=, a^t(a-b)^2 + c^t(b-c)^2 + (a^t-b^t+c^t)(a-b)(b-c);
		ge, 0.
	:}`</span>
	分析上式最后一个不等号左边三项, 得到原式等于零当且仅当
	<span class="formula">
		`(a = 0 or a = b)` `and (c = 0 or b = c)` `and (a = b or b = c)`.
	</span>
	从而得到: 等号成立当且仅当 `a = b = c`, 或其中两数相等且另一数为零.
	另外容易看到 `t` 是非负偶数时, 不等式也成立.
</p>

<ol class="corollary" id="cor-schur">
	Schur 不等式最常用的是 `t = 1` 的情形, 此时有
	<li>`S_3 - q_3 + 3r = p^3 - 4 p q + 9 r ge 0`;</li>
	<li>`prod_"cyc" (a+b-c) le a b c`;</li>
</ol>

<ol class="proof">
	<li>由 Schur 不等式,
		<span class="formula">
			`0 le sum a(a-b)(a-c)`
			`= sum a^3 - sum a^2(b+c) + sum a b c`
			`= S_3 - q_3 + 3r`,
		</span>
		再利用等式, 将 `S_3` 和 `q_3` 用 `p, q, r` 来表示即可.
	</li>
	<li>即证 `(p-2a)(p-2b)(p-2c) le r`. 展开左边得
		<span class="formula">
			`p^3 - 2(a + b + c) p^2 + 4(a b+b c+c a)p - 8 a b c`
			`= -p^3 + 4 p q - 8 r le r`.
		</span>
	</li>
</ol>

<ol class="example">
	<li>三角形 ABC 中, `sum_"cyc" cos A le 3//2`;</li>
	<li>三角形的外接圆半径为 `R`, 内接圆半径为 `r`, 则 `R ge 2r`.</li>
</ol>

<ol class="proof">
    <li>
        <span class="formula">
            `sum cos A = sum (b^2+c^2-a^2)/(2b c)`
            `= (sum a(b^2+c^2) - sum a^3)/(2a b c)`
            `= (sum a^2(b+c) - sum a^3)/(2a b c)`.
        </span>
        在 Schur 不等式中取 `t = 1` 有
        <span class="formula">
            `sum a^3 - sum a^2(b+c) ge sum a b c = 3 a b c`,
        </span>
        代入上式即得证.
    </li>
    <li>??</li>
</ol>

<h3>`uvw` 方法</h3>

[参见 <a href="https://brilliant.org/wiki/the-uvw-method">brilliant.org</a>]

<ol class="theorem">
	<b>基本定理</b>
	设 `a, b, c ge 0`,
	<span class="formula">
		`3u = a + b + c`,<br/>
		`3v^2 = a b+b c+c a`,<br/>
		`w^3 = a b c`,
		<span class="label" id="for-uvw"></span>
	</span>
	则 `u ge v ge w`, 其中
	<li>第一个等号成立当且仅当 `a = b = c`;</li>
	<li>第二个等号成立当且仅当 `a b = b c = c a`, 即 `a = b = c`,
		或它们中至少有两个为 `0`.
	</li>
	特别当 `a = b = c` 时, `a, b, c, u, v, w` 六个数均相等.
</ol>

<p class="example">
	已知 `a, b, c gt 0`, `1/a + 1/b + 1/c = 1`, 求 `min(a-1)(b-1)(c-1)`.
</p>

<p class="solution">
	由已知 `a b+b c+c a = a b c`, 所以 `w^3 = 3 v^2 ge 3 w^2`, 得 `w ge
	3`, 从而 `u ge w ge 3`. 所以
	<span class="formula">
		`(a-1)(b-1)(c-1)`
		`= w^3 - 3v^2 + 3u - 1`
		`= 3u-1 ge 8`.
	</span>
	当 `a = b = c = 3` 时, 等号成立.
</p>

<p class="lemma">
	三次多项式 `f(x)` 有三个实根 `a, b, c` 的充要条件是
	<span class="formula">
		`Delta = [(a-b)(b-c)(c-a)]^2 ge 0`.
	</span>
</p>

<p class="theorem">
	<b>可行条件</b>
	设 `u, v, w in RR`, 则存在 `a, b, c in RR` 满足
	<a class="ref" href="#for-uvw"></a> 的充要条件是
	<span class="formula">
		`T(u, v, w) := -4 u^3 w^3 + 3 u^2 v^4 + 6 u v^2 w^3 - 4 v^6 - w^6`
		`ge 0`.
	</span>
	存在 `a, b, c ge 0` 满足 <a class="ref" href="#for-uvw"></a>
	的充要条件是 `T ge 0` 且 `u, v^2, w^3 ge 0`.
</p>

<p class="definition">
	设 `u, v, w ge 0`. 如果存在 `a, b, c ge 0`
	满足 <a class="ref" href="#for-uvw"></a>,
	则称三元组 `(u, v, w)` 是可行的.
</p>

<p class="theorem">
	<b>Tejs 定理</b>
</p>

<h2>杂例</h2>

<p class="example">
	设 `a, b gt 0`, 比较 `a^b` 和 `b^a` 的大小.
</p>

<p class="solution">
	两边取对数, 问题化为比较 `(ln a)/a` 和 `(ln b)/b` 的大小.
	我们来求函数 `f(x) = (ln x)/x` 的单调区间. 因为
	<span class="formula">
		`f'(x) = (1-ln x)/x^2`
	</span>
	在 `x="e"` 处等于零, 在 `(0, "e")` 上大于零, `("e", +oo)` 上小于零,
	所以 `x = "e"` 是 `f` 的唯一极大值点.
	根据这些信息, 在 `a, b` 同大于 `"e"` 或同小于 `"e"`
	时就容易判断 `a^b` 和 `b^a` 的大小. 如 `ln "e"//"e" gt ln pi // pi`,
  因此 `"e"^pi gt pi^"e"`.
</p>

<p class="example">
  `a ge 1`, `n` 为正整数, 证明: `(1+a^n)^(1/n)` 关于 `n` 单调减.
</p>

<p class="proof">
  只需证
  <span class="formula">
    `(1+a^n)^(n+1) gt (1+a^(n+1))^n`
  </span>
  为此, 我们证
  <span class="formula">
    `(1+a^n)^(n+1)/(1+a^(n+1))^n ge (1+a^n)/a^n gt 1`.
  </span>
  即证
  <span class="formula">
    `(1+a^n)/(1+a^(n+1)) ge 1/a`,
  </span>
  即证
  <span class="formula">
    `a + a^(n+1) ge 1 + a^(n+1)`,
  </span>
  显然成立.
</p>

<ol class="example">
	<b>裂项估计 zeta 函数部分和 `sum_(k=1)^n 1/k^s`</b>
	<li>设 `k ge 2`, 有
		<span class="formula">
			`1/k - 1/(k+1) = 1/(k(k+1)) lt 1/k^2 lt 1/(k(k-1)) = 1/(k-1) - 1/k`.
		</span>
		在这个不等式两边求和, 可以得到 `sum_(k=a)^b 1/k^2` 的上下界估计. 如
		<span class="formula">
			`sum_(k=1)^n 1/k^2 gt sum_(k=1)^n 1/(k(k+1)) = 1 - 1/(n+1)`,
			`quad n ge 1`.
		</span>
		然而这个结果没有什么用, 因为仅从第 1 项就可以看出它大于 1.
		但我们可以从第 2 项开始放缩, 得到
		<span class="formula">
			`sum_(k=1)^n 1/k^2 gt 1 + sum_(k=2)^n 1/(k(k+1)) = 3/2 - 1/(n+1)`,
			`quad n ge 2`.
		</span>
		这是一个更好的下界. 现在估计它的上界, 有
		<span class="formula">
			`sum_(k=1)^n 1/k^2 lt 2 - 1/n`, `quad n ge 2`.
		</span>
		若 `n ge 3`, 从第 3 项开始放缩, 上界可降低到 `7/4 - 1/n`.
		若从第 4 项开始放缩, 可进一步降低至 `61/36 - 1/n`.
		事实上, Basel 问题告诉我们,
		<span class="formula">
			`sum_(k=1)^oo 1/k^2 = pi^2/6 = 1.644934...`
		</span>
	</li>
	<li>一般地, 可以用不等式
		<span class="formula">
			`1/(a^2 k^2 + b k + c) lt (或 gt) 1/(a k+u) - 1/(a k+v)`
		</span>
		来得到通项的估计. 为了使不等式右端在求和时各项可以抵消, 要求 `u-v`
		是 `a` 的整数倍. 比如
		<span class="formula">
			`1/k^2 lt 1/(k^2 - 1)` 或 `1/k^2 lt 1/(k^2 - 1/4)`.
		</span>
	</li>
	<li>此外, 还有
		<span class="formula">
			`1/(sqrt k + sqrt(k+1)) lt 1/(2 sqrt k) lt 1/(sqrt
			k + sqrt(k-1))`, `quad k ge 2`,<br/>
			`1/(2 sqrt k) lt 1/(sqrt(k-1/2) + sqrt(k+1/2))`, `quad k ge 2`,
		</span>
		以及
		<span class="formula">
			`ln{:(k+1)/k:} lt 1/k lt ln{:k/(k-1):}`, `quad k ge 2`
			(<a href="../analysis/2.html">证明在这里</a>),<br/>
			`2/(2k+1) lt 1/(sqrt(k(k+1)))` (均值不等式),
		</span>
		两边求和就可得到 `sum_(k=a)^b 1/sqrt k`,
		`sum_(k=a)^b 1/k` 的上下界.
	</li>
</ol>

<p class="example">
	`n` 是正整数, 证明: `sum_(k=1)^n 1/sqrt k lt sqrt n(1+sqrt(n/(n+1)))`.
</p>

<p class="proof">
	记不等式右边为 `a_n`, 则
	<span class="formula">
		`a_n = sqrt n + sqrt(n+1) - 1/sqrt(n+1)`.
	</span>
	作差分
	<span class="formula">
		`Delta a_n = a_n - a_(n-1)`
		`= 1/sqrt n - 1/sqrt(n+1) + sqrt(n+1) - sqrt(n-1)`.
	</span>
	因为 `a_0 = 0`,
	要证 `sum 1/sqrt n lt a_n`, 只需证 `1/sqrt n lt Delta a_n`, 即证
	<span class="formula">
		`1/sqrt n lt 1/sqrt n - 1/sqrt(n+1) + sqrt(n+1) - sqrt(n-1)`,
	</span>
	即证
	<span class="formula">
		`1/sqrt(n+1) lt sqrt(n+1) - sqrt(n-1)`
		`= 2/(sqrt(n+1) + sqrt(n-1))`.
	</span>
	上式是成立的, 因此原不等式成立.
</p>

<ol class="example">
	<b>二元均值不等式应用</b>
	<li>已知 `x, y gt 0`, `x + y = 1`, 求 `min(3/x + 4/y)`;</li>
	<li>已知 `x, y gt 0`, `x + x y + 2y = 30`, 求 `min 1/(x y)`;</li>
	<li>已知 `x^2 + y^2 = 1`, 求 `max(x+1)(y+2)`;</li>
	<li>已知 `x gt -1`, 求 `min(x^2+7x+10)/(x+1)`;</li>
	<li>已知 `x in (0, 1/2)`, 求 `min(2/x + 9/(1-2x))`;</li>
    <li>已知 `x^2 - 4 x y - 5 y^2 = 5`, 求 `min(x^2+2y^2)`;</li>
</ol>

<ol class="solution">
	<li>乘上去.
		<span class="formula">
			`3/x + 4/y = (3/x + 4/y)(x+y)`
			`= 3 + 4 + 3 y/x + 4 x/y`
			`ge 7 + 2 sqrt(3 y/x * 4 x/y)`
			`= 7 + 4 sqrt 3`,
		</span>
		等号成立当且仅当 `3 y/x = 4 x/y`. 联系 `x+y = 1` 可得
		`x = 2 sqrt 3 - 3`, `y = 4 - 2 sqrt 3`.
	</li>
	<li>解关于 `x y` 的不等式.
		<span class="formula">
			`30 = x + 2y + x y ge 2 sqrt(2x y) + x y`,
		</span>
		解得 `sqrt(x y) in [-5sqrt2, 3sqrt2]`,
		因此 `x y le (3sqrt2)^2 = 18`, 即 `1/(x y) ge 1/18`.
		等号成立当且仅当 `x = 2 y`. 联系 `x + x y + 2y = 30` 可得
		`x = 6`, `y = 3`.
	</li>
	<li></li>
	<li>令 `y = x+1`, 则 `y gt 0`,
		<span class="formula">
			`(x^2+7x+10)/(x+1)`
			`= ((y-1)^2 + 7(y-1) + 10)/y`
			`= y + 4/y + 5`
			`ge 2 sqrt (y * 4/y) + 5 = 9`,
		</span>
		等号成立当且仅当 `y = 4/y`, 即 `x = 1`.
	</li>
	<li>两个分母都是正数, 因此使用 "乘上去" 的技巧.
		<span class="formula">
			`2/x + 9/(1-2x)`
			`= (2/x + 9/(1-2x)) [(2x) + (1-2x)]`.
		</span>
		后面的处理是容易的.
	</li>
    <li>通过因式分解, 条件化为 `(x-5y)(x+y) = 5`.
        令 `m = x-5y`, `n = x+y`, 可解出 `x, y`, 进而
        <span class="formula">
            `x^2 + 2 y^2 = (m^2 + 9 n^2 + 2 m n)/12`
            `ge (2 * 3 m n + 2 m n)/12`
            `= 10/3`.
        </span>
    </li>
</ol>

<ol class="example">
	<b>三元均值不等式应用</b>
	<li>已知 `x gt 0`, 求 `min(3x + 1/(2x^2))`;</li>
	<li>已知 `x in (0,2)`, 求 `max x^2(2-x)`;</li>
	<li>已知实数 `x, y` 满足 `x y gt 0`, `x^2 y = 2`, 求 `min(x y + x^2)`;</li>
</ol>

<ol class="solution">
	<li>使用三元均值不等式, 需要拆成三项, 其中两项必须相等,
		否则不满足不等式的取等条件.
		<span class="formula">
			`3x + 1/(2x^2)`
			`= 3/2 x + 3/2 x + 1/(2x^2)`
			`ge 3 root 3 (3/2 x * 3/2 x * 1/(2x^2))`
			`= 3/2 root 3 9`,
		</span>
		等号成立当且仅当 `3/2 x = 1/(2x^2)`, 解得 `x = 1/(root 3 3)`.
	</li>
	<li>
		<span class="formula">
			`(x^2 (2-x))/4`
			`le ((x/2 + x/2 + 2-x)/3)^3 = 8/27`,
		</span>
		因此原式 `le 32/27`, 等号成立当且仅当 `x/2 = 2-x`, 即 `x = 4/3`.
	</li>
	<li>`x y + x^2 = (x y)/2 + (x y)/2 + x^2`. 后面是处理是容易的.</li>
</ol>

<p class="example">
	已知 `a, b, c gt 0`, 则 `(a+b+c)^2 le 3(a^2 + b^2 + c^2)`.
</p>

<p class="proof">
	这个不等式可以直接用 Cauchy 不等式得到.
	现在用二元均值不等式证明之. 原式成立当且仅当
	<span class="formula">
		`a^2 + b^2 + c^2 + 2(a b + b c + c a) le 3(a^2 + b^2 + c^2)`,
	</span>
	即证
	<span class="formula">
		`a b + b c + c a le a^2 + b^2 + c^2`.
	</span>
	上式由 `2 a b le a^2+b^2`, `2 b c le b^2 + c^2` 和 `2 c a le c^2
	+ a^2` 相加得到. 等号成立当且仅当 `a = b = c`.
</p>

<p class="example">
	已知 `a, b, c gt 0` 且 `a b c = 1`, 则 `sqrt a + sqrt b + sqrt
	c le a b + b c + c a`.
</p>

<p class="proof">
	即证
	<span class="formula">
		`1/sqrt(b c) + 1/sqrt(c a) + 1/sqrt(a b)
		le 1/a + 1/b + 1/c`,
	</span>
	上式由
	<span class="formula">
		`1/sqrt(b c) le 1/2(1/b + 1/c)`,
		`quad 1/sqrt(c a) le 1/2(1/c + 1/a)`
		`quad 1/sqrt(a b) le 1/2(1/a + 1/b)`
	</span>
	相加得到. 等号成立当且仅当 `a = b = c = 1/3`.
</p>

<p class="example">
	已知 `a, b, c gt 0` 且 `a + b + c = 4 - sqrt(a b c)`,
	则 `sqrt((b c)/a) + sqrt((c a)/b) + sqrt((a b)/c) ge a + b + c`.
</p>

<p class="proof">
	由 `a + b + c = 4 - sqrt(a b c)` 应用四元均值不等式有
	<span class="formula">
		`5 - sqrt(a b c) = a + b + c + 1`
		`ge 4 root 4(a b c)`,
	</span>
	解得 `root4(a b c) in [-5, 1]`.
	现在证明原不等式. 原式等价于
	<span class="formula">
		`sqrt(a b c) (1/a + 1/b + 1/c) ge 4 - sqrt(a b c)`,
	</span>
	即
	<span class="formula">
		`1/a + 1/b + 1/c + 1 ge 4/sqrt(a b c)`.
	</span>
	由四元均值不等式,
	<span class="formula">
		`1/a + 1/b + 1/c + 1`
		`ge 4/root4(a b c)`
	</span>
	??
</p>

<p class="example">
	已知 `x y^2 (x+y) = 9`, 求 `min(2x+y)`.
</p>

<p class="proof">
	设 `2x+y = a x + b y + b y + c(x+y)`, 我们有:
	<span class="formula">
		`a + c = 2`, `quad 2b + c = 1`,
	</span>
	注意均值不等式的取等条件 `a x = b y = c(x+y)` 必须成立, 因此有
	<span class="formula">
		`a x = c(x+y) = cx(1+a/b)`, 即
		`a = c(1+a/b)`.
	</span>
	从 `a, b, c` 满足的三个方程中解得 `a = 1 + sqrt2/2`, `b = 1/(2sqrt2)`,
	`c = 1-sqrt2/2`. 于是
	<span class="formula">
		`2x+y = (1+sqrt2/2)x + y/(2sqrt2) + y/(2sqrt2) + (1-sqrt2/2)(x+y)`
		`ge 4[(1+sqrt2/2)x * y/(2sqrt2) * y/(2sqrt2)
		* (1-sqrt2/2)(x+y)]^(1//4)`
		`= 4 * root 4 (9/16) = 2sqrt3`.
	</span>
</p>

<p class="example">
  <b>定角构圆问题</b>
  `triangle ABC` 中 `/_ A = 120^@`, `BC = 4`, 求 `max(2AB + 3AC)`.
</p>

<p class="solution">
  设 `x = AB, y = AC`, 由余弦定理 `a^2 = x^2 + y^2 - 2 x y cos A`,
  原问题化为条件极值问题
  <span class="formula">
    `max{2x+3y | x^2+y^2+x y = 16}`.
  </span>
  待定系数配方,
  <span class="formula">
    `x^2+y^2+x y`
    `=a(2x+3y)^2 + b(x-c y)^2`
    `= 3/28(2x+3y)^2+4/7(x-y/4)^2`
    `ge 3/28(2x+3y)^2`,
  </span>
  因此 `2x+3y le 8 sqrt(7/3)`.
</p>

<p class="solution">
  [来自 我是没学过数学的cxz]
  设 `x = AB, y = AC`, 由正弦定理
  <span class="formula">
    `x/(sin C) = y/(sin B) = a/(sin A)`,
  </span>
  令 `m, n` 为常数, 于是
  <span class="formula">
    `m x + n y`
    `= a/(sin A) (m sin C + n sin B)`
    `= a/(sin A) (m sin C + n sin A cos C + n sin C cos A)`
    `= a/(sin A)[(m + n cos A) sin C + n sin A cos C]`.
  </span>
  记 `k_1, k_2, k_3` 分别为 `a/(sin A)`, `m + n cos A`, `n sin A`,
  由辅助角公式, `m x + n y le k_1 sqrt(k_2^2 + k_3^2)`.
  代入题目数值, 得到同样的结果 `8 sqrt(7/3)`.
</p>

<p class="solution">
  [来自 我是函数的单调性]
  延长 `CA` 到 `D` 使得 `(AD)/(AB) = 2/3`, 在 `triangle BAD` 中由正弦定理
  <span class="formula">
    `(sin D)/(sin(D + pi/3)) = 3/2`,
  </span>
  解得 `tan D = 3sqrt3`, 因此 `cos D = 1/sqrt(1+tan^2D) = 1/sqrt(28)`,
  `sin D = sqrt(27/28)`.
  由于 `/_D` 和 `BC` 的长均为定值, `D` 的轨迹为一圆,
  特别当 `CD` 为圆的直径时, 不等式
  <span class="formula">
    `2AB + 3AC = 3(AC + 2/3 AB) = 3 CD`
    `le 3 (BC)/(sin D)`
    `= 8 sqrt(7/3)`.
  </span>
  取得最大值.
</p>

<p class="example">
  已知 `4x^2 + y^2 + x y = 1`, 求 `2x+y` 的范围.
</p>

<p class="solution">
  `2x+y` 取得最值当且仅当直线和椭圆相切, 即直线斜率为 `-2`.
  求导得 `|2x+y| le sqrt(8/5)`.
</p>

<p class="solution">
  配方 `1 = 4x^2 + y^2 + x y`
  `= a(2x+y)^2 + b(x-c y)^2`.
  解得 `a = 5/8`, 于是 `|2x+y| le sqrt(8/5)`.
</p>

<p class="solution">
  化为定角构圆问题: 三角形三边长为 `2x, y, 1`, 其中 `1` 所对的角满足 `cos
  theta = -1/4`, 故
  <span class="formula">
    `max(2x+y) = 1//sin{:theta/2:} = sqrt(8/5)`.
  </span>
</p>

<p class="example">
	三角形的三边长分别为 `a, b, c`, 边 `c` 上的中线长为 `1`, 且 `/_
	C = 45^@`. 求 `max(a+b)`.
</p>

<p class="solution">
	由中线长公式和余弦定理:
	<span class="formula">
		`c^2 = 2(a^2+b^2)-4`, `quad c^2 = a^2+b^2-2a b cos 45^@`.
	</span>
	于是
	<span class="formula">
		`a^2+b^2 = 4 - sqrt 2 a b`,<br/>
		`(a+b)^2 = 4 - (2-sqrt 2)a b`
		`le 4 + (2-sqrt2)((a+b)/2)^2`.
	</span>
	解得 `a+b le 2 sqrt(4-2sqrt2)`, 等号成立当且仅当 `a = b`.
</p>

<p class="example">
	设 `a, b gt 0`, 实数 `x` 满足
	<span class="formula">
		`sqrt(x^2-sqrt2 a x + a^2) + sqrt(x^2-sqrt 2 b x + b^2) le
		sqrt(a^2+b^2)`,
	</span>
	求 `x` 的值.
</p>

<p class="solution">
	不等式左边应用余弦定理, 右边应用勾股定理, 采用几何意义解决问题.
	作一直角三角形 `ABC`, 两斜边 `BC, AC` 分别为 `a, b`,
	又作直角 `C` 的平分线 `CP = x`. 题目条件即化为 `PA + PB le AB`.
	这推出 `P` 位于线段 `AB` 上, `x` 即为角平分线长.
</p>

<script src="../../js/note.js?type=math"></script>
</body>
</html>
