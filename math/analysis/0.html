<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <title>附录</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" type="text/css" href="../../css/note.css" />
</head>
<body>

<h2>微积分表</h2>

<h3>微分表</h3>

<table>
<tr>
	<td>`f(x)`</td>
	<td>`f^'(x)`</td>
	<td>`f(x)`</td>
	<td>`f^'(x)`</td>
</tr>
<tr>
	<td>`sin x`</td>
	<td>`cos x`</td>
	<td>`sinh x`</td>
	<td>`cosh x`</td>
</tr>
<tr>
	<td>`cos x`</td>
	<td>`-sin x`</td>
	<td>`cosh x`</td>
	<td>`sinh x`</td>
</tr>
<tr>
	<td>`tan x`</td>
	<td>`1/(cos^2 x)`</td>
	<td>`tanh x`</td>
	<td>`1/(cosh^2 x)`</td>
</tr>
<tr>
	<td>`cot x`</td>
	<td>`- 1/(sin^2 x)`</td>
	<td>`coth x`</td>
	<td>`- 1/(sinh^2 x)`</td>
</tr>
<tr>
	<td>`arcsin x`</td>
	<td>`1/sqrt(1-x^2)`</td>
	<td>`"arsh "x`</td>
	<td>`1/sqrt(x^2+1)`</td>
</tr>
<tr>
	<td>`arccos x`</td>
	<td>`- 1/sqrt(1-x^2)`</td>
	<td>`"arch "x`</td>
	<td>`1/sqrt(x^2-1)`</td>
</tr>
<tr>
	<td>`arctan x`</td>
	<td>`1/(1+x^2)`</td>
	<td>`"arth "x`</td>
	<td>`1/(1-x^2)`</td>
</tr>
</table>

<h3>积分表</h3>

<table>
<tr>
	<td>`f^'(x)`</td>
	<td>`f(x)`</td>
</tr>
<tr>
	<td>`tan x`</td>
	<td>`-ln |cos x|`</td>
</tr>
<tr>
	<td>`cot x`</td>
	<td>`ln |sin x|`</td>
</tr>
<tr>
	<td>`sec x`</td>
	<td>`ln |sec x + tan x|`,
		`-1/2 ln {:(1-sinx)/(1+sinx):}`</td>
</tr>
<tr>
	<td>`csc x`</td>
	<td>`ln |csc x - cot x|`,
		`1/2 ln {:(1-cosx)/(1+cosx):}, ln |tan{:x/2:}|`</td>
</tr>
<tr>
	<td>`1/sqrt(a^2-x^2)`</td>
	<td>`arcsin{:x/a:}`,
		`-arccos{:x/a:}`</td>
</tr>
<tr>
	<td>`1/(a^2+x^2)`</td>
	<td>`1/a arctan{:x/a:}`</td>
</tr>
<tr>
	<td>`tanh x`</td>
	<td>`ln("e"^x+"e"^-x)`,
		`ln cosh x`</td>
</tr>
<tr>
	<td>`coth x`</td>
	<td>`ln |"e"^x-"e"^-x|`,
		`ln |sinh x|`</td>
</tr>
<tr>
	<td>`1/cosh x`</td>
	<td>`2 arctan "e"^x`,
		`arctan sinh x`</td>
</tr>
<tr>
	<td>`1/sinh x`</td>
	<td>`ln {:|"e"^x-1|/("e"^x+1):}`,
		`1/2 ln {:(coshx-1)/(coshx+1):}`,
		`ln {:(coshx-1) / |sinhx|:}`</td>
</tr>
<tr>
	<td>`1/sqrt(x^2+a^2)`</td>
	<td>`ln (x+sqrt(x^2+a^2))`,
		`"arsh "{:x/a:}`</td>
</tr>
<tr>
	<td>`1/sqrt(x^2-a^2)`</td>
	<td>`ln |x+sqrt(x^2-a^2)|`,
		`sgn x * "arch "{:|x|/a:}`</td>
</tr>
<tr>
	<td>`1/(x^2-a^2)`</td>
	<td>`1/(2a) ln |(x-a)/(x+a)|`,
		`-1/a "arth "(x/a)^(sgn(a-|x|))`</td>
</tr>
</table>

<p class="remark">
	`sinh x = ("e"^x - "e"^-x)/2`
	`quad cosh x = ("e"^x + "e"^-x)/2`,
	`quad tanh x = ("e"^x - "e"^-x)/("e"^x + "e"^-x)`;<br/>
	`"arsh "x = ln (x+sqrt(x^2+1))`, `quad x in RR`,<br/>
	`"arch "x = ln (x+sqrt(x^2-1))`, `quad x ge 1`,<br/>
	`"arth "x = 1/2 ln ((1+x)/(1-x))`, `quad -1 lt x lt 1`.
</p>

<h2>级数与无穷乘积</h2>

<h3>幂级数</h3>

<ol>
	设 `|x| lt 1`, 则
	<li>`sum_(n ge 0) x^n = 1/(1-x)` (几何级数);</li>
	<li>`sum_(n ge 1) x^n/n = -ln(1-x)`;</li>
	<li>`sum_(n ge 1, "odd") x^n/n = "arth "x = 1/2 ln|(1+x)/(1-x)|`;</li>
</ol>

<ol class="proof">
	<li>由等式 `(1-x)(1 + x + cdots + x^n) = 1 - x^(n+1)` 得
		<span class="formula">
			`1 + x + cdots + x^n = (1-x^(n+1))/(1-x)`,
		</span>
		两边令 `n to oo` 即得结论.
	</li>
	<li>由几何级数两边从 `0` 到 `x` 积分即可.</li>
	<li>由 `sum_(n ge 0) t^(2n) = 1/(1-t^2)` 两边从 `0` 到 `x` 积分即可.
	</li>
</ol>

<table>
<tr>
	<td>收敛域</td>
	<td>函数</td>
	<td>级数展开</td>
</tr>
<tr>
	<td>`|x| lt oo`</td>
	<td>`"e"^x`</td>
	<td>`sum_(n ge 0) x^n/(n!) = 1 + x + x^2/(2!) + x^3/(3!) + cdots`</td>
</tr>
<tr>
	<td>`|x| lt 1`</td>
	<td>`1/(1-x)`</td>
	<td>`sum_(n ge 0) x^n = 1 + x + x^2 + x^3 + cdots`</td>
</tr>
<tr>
	<td>`|x| lt 1`</td>
	<td>`(1+x)^alpha`</td>
	<td>`sum_(n ge 0) (alpha;n) x^n = 1 + alpha x + (alpha(alpha-1)) / (2!) x^2 + (alpha(alpha-1)(alpha-2))/(3!) + cdots`</td>
</tr>
<tr>
	<td>`|x| lt 1`</td>
	<td>`ln(1+x)`</td>
	<td>`sum_(n ge 0) (-1)^n x^(n+1)/(n+1) = x - x^2/2 + x^3/3 - x^4/4 + cdots`</td>
</tr>
<tr>
	<td>`|x| lt oo`</td>
	<td>`sinh x`</td>
	<td>`sum_(n ge 0) x^(2n+1)/((2n+1)!) = x + x^3/(3!) + x^5/(5!) + x^7/(7!) + cdots`</td>
</tr>
<tr>
	<td>`|x| lt oo`</td>
	<td>`cosh x`</td>
	<td>`sum_(n ge 0) x^(2n)/((2n)!) = 1 + x^2/(2!) + x^4/(4!) + x^6/(6!) + cdots`</td>
</tr>
<tr>
	<td>`|x| lt 1`</td>
	<td>`"arth "x`</td>
	<td>`sum_(n ge 0) x^(2n+1)/(2n+1) = x + x^3/3 + x^5/5 + x^7/7 + cdots`</td>
</tr>
<tr>
	<td>`|x| lt 1`</td>
	<td>`arcsin x`</td>
	<td>`sum_(n ge 0) ((2n-1)!!)/((2n)!!) x^(2n+1)/(2n+1) = x + 1/6 x^3 + 3/40 x^5 + 5/112 x^7 + 35/1152 x^9 + cdots`</td>
</tr>
<tr>
	<td>`|x| gt 1`</td>
	<td>`"arch "x`</td>
	<td>`ln 2x - sum_(n ge 1) (-1)^n ((2n-1)!!)/((2n)!!) x^(-2n)/(2n) = ln 2x - 1/(4x^2) - 3/(32x^4) - 15/(288x^6) - cdots`</td>
</tr>
<tr>
	<td>`|x| lt pi`</td>
	<td>`coth x`</td>
	<td>`1/x sum_(n ge 0) B_(2n)/((2n)!) (2x)^(2n) = 1/x + 1/3 x - 1/45 x^3 + 2/945 x^5 + cdots`</td>
</tr>
<tr>
	<td>`|x| lt pi/2`</td>
	<td>`tanh x`</td>
	<td>`1/x sum_(n ge 1) B_(2n)/((2n)!) (4^n-1)(2x)^(2n) = x - 1/3 x^3 + 2/15 x^5 - 17/315 x^7 + 62/2835 x^9 - 1382/155925 x^11 + cdots`</td>
</tr>
<tr>
	<td>`|x| lt pi`</td>
	<td>`csc x`</td>
	<td>`1/x sum_(n ge 0) (-1)^n B_(2n)/((2n)!) (2-4^n) x^(2n) = 1/x + 1/6 x + 7/360 x^3 + 31/15120 x^5 + 127/604800 x^7 + 73/3421440 x^9 + cdots`</td>
</tr>
<tr>
	<td>`|x| lt pi/2`</td>
	<td>`1/(cosh x)`</td>
	<td>`sum_(n ge 0) E_(2n)/((2n)!) x^(2n) = 1 - 1/2 x^2 + 5/24 x^4 - 61/720 x^6 - cdots`</td>
</tr>
<tr>
	<td></td>
	<td>`"erf"(x)`</td>
	<td>`2/(sqrt pi) sum_(n ge 0) (-1)^n/(n!) x^(2n+1)/(2n+1)`</td>
</tr>
</table>

<ol class="proof">
<li>在
	<span class="formula">
		`1/sqrt(1-x^2) = sum_(n ge 0) (-1/2; n) (-x^2)^n`
		`= sum_(n ge 0) ((-1/2)(-3/2) cdots (-(2n-1)/2))/(n!) (-x^2)^n`
		`= sum_(n ge 0) ((2n-1)!!)/((2n)!!) x^(2n)`
	</span>
	两边逐项积分, 就得到 `arcsin x` 的展式.
</li>
<li>将 `"erf"(x) = 2/sqrt pi int_0^x "e"^(-t^2) dt` 
	的被积函数展开并逐项积分, 就得到 `"erf"(x)` 的展式.
</li>
</ol>

<ol class="remark">
	<li>
	`B_(2n)` 是 <a href="../number/10.html">Bernoulli 数</a>.
	`E_(2n)` 是 Euler 数, 它是正负号交错的整数:
	<span class="formula">
		`E_0 = 1, E_2 = -1, E_4 = 5, E_6 = -61, E_8 = 1385, E_10
		= -50521`.
	</span>
	由 `E_(2n)` 的生成函数知道,
	<span class="formula">
		`1 = cos h x sum_(k ge 0) E_(2k)/((2k)!) x^(2k)`
		`= (sum_(j ge 0) x^(2j)/((2j)!)) ( sum_(k ge 0) E_(2k)/((2k)!)
		x^(2k))`
		`= sum_(n ge 0) sum_(k=0)^n E_(2k)/((2k)!(2n-2k)!)`
		`= sum_(n ge 0) x^(2n)/((2n)!) sum_(k=0)^n (2n;2k) E_(2k)`
	</span>
	比较等式两边的各次项系数, 得到递推公式:
	<span class="formula">
		`sum_(k=0)^n (2n;2k) E_(2k) = 0`, `quad n ge 1`.
	</span>
	</li>
	<li>
	三角函数与其对应的双曲三角函数有简单联系
	<span class="formula">
		`cos x = cosh("i"x)`, `quad cosh x = cos("i"x)`,<br/>
		`sin x = -"i" sinh("i"x)`, `quad sinh x = -"i" sin("i"x)`,<br/>
		`tan x = -"i" tanh("i"x)`, `quad tanh x = -"i" tan("i"x)`,<br/>
		`cot x = "i" coth("i"x)`, `quad coth x = "i" cot("i"x)`,<br/>
		`arccos x = "arch "x("i"x)`, `quad "arch "x = arccos("i"x)`,<br/>
		`arcsin x = -"i arsh "x("i"x)`, `quad "arsh "x = -"i"arcsin("i"x)`,<br/>
		`arctan x = -"i arth "x("i"x)`, `quad "arth "x = -"i"arctan("i"x)`,
	</span>
	因此只需将一个三角函数的级数从第二项起交错改变符号,
	就得到对应的双曲三角函数的级数, 反之亦然. 如
	<span class="formula">
		`cos x = sum_(n ge 0) (-1)^n x^(2n)/((2n)!)`,<br/>
		`"arsh "x = sum_(n ge 0) (-1)^n ((2n-1)!!)/((2n)!!)
		x^(2n+1)/(2n+1)`,<br/>
		`cot x = 1/x sum_(n ge 0) (-1)^n B_(2n)/((2n)!) (2x)^(2n)`.
	</span>
	</li>
</ol>

<p class="example">
    由 <a href="8.html">digamma 函数</a>的展式得
    <span class="formula">
        `sum_(n ge 1)(1/n - 1/(n+s)) = psi(s+1) + gamma`.
    </span>
</p>

<p class="example">
	<span class="formula">
		`prod_(n ge 1) (1-x^2/n^2) = (sin pi x)/(pi x)`,
	</span>
	两边取对数再求导, 整理得
	<span class="formula">
		`sum_(n ge 1) 1/(n^2-x^2) = 1/(2x^2) (1 - pi x cot pi x)`.
	</span>
	容易得到
	<span class="formula">
		`sum_(n ge 1) 1/(n^2+1) = pi/2 "coth "pi - 1/2`.
	</span>
	此外可以裂项得到
	<span class="formula">
		`sum_(n ge 2) 1/(n^2-1) = 3/4`.
	</span>
</p>

<ol class="example">
    求 `f(x) = sum_(n ge 0) x^n/(n!!)` (`0!! = 1`).
</ol>

<p class="solution">
    `f(0) = 1`, 且 `f` 适合微分方程 `y' = x y + 1`. 解得
    <span class="formula">
        `f(x) = sqrt(2/pi) int_(-oo)^x "e"^((x^2-t^2)/2) dt`.
    </span>
    利用 Wallis 公式知道, 收敛半径为 `oo`.
</p>

<h3>Fourier 级数</h3>

<p class="remark">
    [TODO: 错误计算] 以下两例从发散级数出发, 却凑巧得到有用的结论...??
</p>
<div class="collapse">
<ol class="example">
	设 `x in (0, 2pi)`, 则
	<li>`sum_(n ge 1) cos n x = -1/2` (然而此级数除特殊点外处处发散);</li>
	<li>`sum_(n ge 1) (sin n x)/n = (pi-x)/2`;</li>
	<li>`sum_(n ge 1) (cos n x)/n^2 = x^2/4 - (pi x)/2 + pi^2/6`.</li>
	<li>`sum_(n ge 1) (sin n x)/n^3 = x^3/12 - (pi x^2)/4 + (pi^2 x)/6`.</li>
	在 2. 中把 `x` 换成 `pi-x`, 就得到 `x` 在 `|x| lt pi` 上的 Fourier
	展开.  类似地, 由 3, 4 分别得 `x^2, x^3` 的 Fourier 展开.
</ol>

<ol class="proof">
	<li>利用 Euler 公式, 原式等于
		<span class="formula">
			`sum_(n ge 1) ("e"^(n x"i") + "e"^(-n x"i"))/2`
			`= 1/2 ("e"^(x"i")/(1-"e"^(x"i"))
			+ "e"^(-x"i")/(1-"e"^(-x"i")))`
            `= 1/2 ("e"^(x"i"//2)/("e"^(-x"i"//2)-"e"^(x"i"//2))
            + "e"^(-x"i"//2)/("e"^(x"i"//2)-"e"^(-x"i"//2)))`
			`= -1/2`.
		</span>
	</li>
	<li>由 1. 两边积分,
		<span class="formula">
			`int_pi^x sum_(n ge 1) cos n t dt`
			`= sum_(n ge 1) int_pi^x cos n t dt`
			`= sum_(n ge 1) (sin n x)/n`,<br/>
			`int_pi^x (-1/2) dt = (pi-x)/2`.
		</span>
	</li>
	<li>由 2. 两边积分,
		<span class="formula">
			`int_0^x sum_(n ge 1) (sin n t)/n dt`
			`= sum_(n ge 1) int_0^x (sin n t)/n dt`
			`= sum_(n ge 1) (1-cos n x)/n^2`,<br/>
			`int_0^x (pi-t)/2 dt = pi/2 x - x^2/4`,
		</span>
		再利用 `sum_(n ge 1) n^-2 = pi^2//6` 即得结论.
	</li>
	<li>由 3. 两边积分,
		<span class="formula">
			`int_pi^x sum_(n ge 1) (cos n t)/n^2 dt`
			`= sum_(n ge 1) (sin n x)/n^3`,<br/>
			`int_pi^x (t^2/4 - (pi t)/2 + pi^2/6) dx`
			`= x^3/12 - pi/4 x^2 + pi^2/6 x`.
		</span>
	</li>
</ol>

<ol class="example">
    类似上题有
    <li>`sum_(n ge 1) sin n x = 1/2 cot {:x/2:}`;
        (然而此级数除特殊点外处处发散)
    </li>
    <li>`sum_(n ge 1) (cos n x)/n = -ln(2 sin{:x/2:})`;</li>
    <li>`sum_(n ge 1) (sin n x)/n^2 = -int_pi^x ln(2 sin{:t/2:}) dt`;<br/>
    </li>
    令 `x = pi-x`, 又得到
    <li>`sum_(n ge 1) (-1)^(n-1) sin n x = 1/2 tan {:x/2:}`
        (然而此级数除特殊点外处处发散);
    </li>
    <li>`sum_(n ge 1) (-1)^n (cos n x)/n = -ln(2 cos{:x/2:})`;</li>
    <li>`sum_(n ge 1) (-1)^(n-1) (sin n x)/n^2 = int_0^x ln(2 cos{:t/2:}) dt`;<br/>
        `x = 0, pi` 时, 等式两边等于 `0`;
        `x = pi/2` 时, 等于 Calatan 常数 `K`.
    </li>
</p>
</div>

<p>一般地, `f` 在 `(-pi,pi)` 上的 Fourier 级数可以由以下公式计算:
	<span class="formula">
		`f(x) = a_0/2 + sum_(n ge 1) (a_n cos n x + b_n sin n x)`,<br/>
		`a_n = 1/pi int_(-pi)^pi f(x) cos n x dx`,
		`quad b_n = 1/pi int_(-pi)^pi f(x) sin n x dx`.
	</span>
</p>

<table>
<tr>
	<td>收敛域</td>
	<td>函数</td>
	<td>Fourier 展开</td>
</tr>
<tr>
	<td>`|x| lt pi`</td>
	<td>`x`</td>
	<td>`2 sum_(n ge 1) (-1)^(n-1) (sin n x)/n`</td>
</tr>
<tr>
	<td>`|x| le pi`</td>
	<td>`x^2`</td>
	<td>`pi^2/3 + 4 sum_(n ge 1) (-1)^n (cos n x)/n^2`</td>
</tr>
<tr>
	<td>`|x| lt pi`</td>
	<td>`x^3`</td>
	<td>`sum_(n ge 1) (12-2n^2 pi^2)/n^3 (-1)^n sin n x`</td>
</tr>
<tr>
	<td>`|x| lt pi`</td>
	<td>`"sgn "x`</td>
	<td>`4/pi sum_(n ge 1, "odd") (sin n x)/n`</td>
</tr>
<tr>
	<td>`|x| le pi`</td>
	<td>`|x|`</td>
	<td>`pi/2 - 4/pi sum_(n ge 1, "odd") (cos n x)/n^2`</td>
</tr>
<tr>
	<td>`|x| le pi`</td>
	<td>`x sin x`</td>
	<td>`1 - (cos x)/2 - 2 sum_(n ge 2) (-1)^n (cos n x)/(n^2-1)`</td>
</tr>
<tr>
	<td>`|x| lt pi`</td>
	<td>`x cos x`</td>
	<td>`-(sin x)/2 + 2 sum_(n ge 2) (-1)^n (n sin n x)/(n^2-1)`</td>
</tr>
<tr>
	<td>`|x| lt oo`</td>
	<td>`|sin x|`</td>
	<td>`2/pi - 4/pi sum_(n ge 1, "even") (cos n x)/(n^2 - 1)`</td>
</tr>
<tr>
	<td>`|x| lt oo`</td>
	<td>`|cos x|`</td>
	<td>`2/pi - 4/pi sum_(n ge 1, "even") "i"^n (cos n x)/(n^2 - 1)`</td>
</tr>
<tr>
	<td>`|x| lt pi`</td>
	<td>`sinh a x`</td>
	<td>`-2/pi sinh a pi sum_(n ge 1) (-1)^n (n sin n x)/(n^2+a^2)`</td>
</tr>
<tr>
	<td>`|x| le pi`</td>
	<td>`cosh a x`</td>
	<td>`2/pi sinh a pi(1/(2a) + sum_(n ge 1) (-1)^n (a cos n x)/(n^2+a^2))`</td>
</tr>
<tr>
	<td>`|x| lt pi`</td>
	<td>`"e"^(a x)`</td>
	<td>`2/pi sinh a pi(1/(2a) + sum_(n ge 1) (-1)^n (a cos n x - n sin
		n x)/(n^2 + a^2))`
	</td>
</tr>
</table>

<p class="remark">
	提示: 1. `x sin x` 和 `x cos x` 积分时需借助积化和差;
	2. `"e"^(a x) = sinh a x + cosh a x`.
</p>

<p class="remark">
    在 `x` 的展式中取 `x = pi/2`, 得到 `pi//4 = sum_(n ge 1)
    (-1)^(n-1)/(2n-1)`;
    在 `x^2` 的展式中取 `x = pi`, 得到 `sum_(n ge 1) n^-2 = pi^2//6`.
</p>

<h2>连分数</h2>

<script src="../../js/note.js?type=math"></script>
</body>
</html>
