<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <title>多元数量函数微分学</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" type="text/css" href="../../css/note.css" />
</head>
<body>

<p class="example">
	<b>Jacobi 矩阵</b>
    的意义是向量对向量的偏导数, 它表示向量微元间的线性变换.
    我们从一个简单例子入手:
	设 `f(x,y)` 二阶连续可微, 令 `x = a u + b v`, `y = c u + d v`,
	`a, b, c, d` 为常数, 则
	<span class="formula">
		`(del f)/(del u) = a(del f)/(del x) + c(del f)/(del y)`,
		`quad (del f)/(del v) = b(del f)/(del x) + d(del f)/(del y)`.
	</span>
	如果记 `del/(del u) = a del/(del x) + c del/(del y)`,
	`del/(del v) = b del/(del x) + d del/(del y)`, 容易验证
	<span class="formula">
		`del^2/(del u^2) = (a del/(del x) + c del/(del y))^2`
		`= a^2 del^2/(del x^2) + 2a c del^2/(del x del y)
		+ c^2 del^2/(del y^2)`,<br/>
		`del^2/(del u del v) = (a del/(del x) + c del/(del y))
		(b del/(del x) + d del/(del y))`
		`= a b del^2/(del x^2) + (a d+b c) del^2/(del x del y)
		+ c d del^2/(del y^2)`,<br/>
		`del^2/(del v^2) = (b del/(del x) + d del/(del y))^2`
		`= b^2 del^2/(del x^2) + 2b d del^2/(del x del y)
		+ d^2 del^2/(del y^2)`.
	</span>
    以上结论可用矩阵简洁地表示: 注意虽然 `x = x(u, v)`, `y = y(u, v)`
    可能为非线性变换, 但在 `f` 可微的条件下, 向量微元 `(dx, dy)`
    和 `("d"u, "d"v)` 之间的变换是线性的. 这个线性变换记为:
    <span class="formula">
        `[dx;dy] = J ["d"u;"d"v]`, `quad J = (del(x, y))/(del(u,v))`.
    </span>
    定义数量函数对向量的偏导数,
    `del/(del(u, v)) = (del/(del u), del/(del v))`, `del/(del(x, y))
    = (del/(del x), del/(del y))`, 则有
    <span class="formula">
        `del/(del(u, v)) = del/(del(x,y)) (del(x,y))/(del(u,v))`
        `= del/(del(x,y)) J`,<br/>
        `H_((u,v)) = [del^2/(del u^2), del^2/(del u del v);
            del^2/(del v del u), del^2/(del v^2)]`
        `= (del/(del u), del/(del v))^T (del/(del u), del/(del v))`
        `= J^T (del/(del x), del/(del y))^T (del/(del x), del/(del y)) J`
        `= J^T H_((x,y)) J`,
        <br/>
        `dx^2 + dy^2 = ("d"u, "d"v) J^T J ["d"u; "d"v]`,
    </span>
    等等. 矩阵 `J` 称为 <b>Jacobi 矩阵</b>, `H` 称为 <b>Hessian 矩阵</b>.
</p>

<p class="example">
	设 `f(x, y)` 二阶连续可微, 且满足方程
	<span class="formula">
		`a(del^2 f)/(del x^2) + b(del^2 f)/(del x del y) + c(del^2 f)/(del
		y^2) = 0`,
	</span>
	其中 `a, b, c` 为常数, `a != 0`.
	若特征方程 `a z^2 + b z + c = 0` 有两个不同的根 `alpha, beta`,
	作变元代换 `u = alpha x + y`, `v = beta x + y`,
	验证 `(del^2 f)/(del u del v) = 0`.
</p>

<p class="solution">
	<span class="formula">
		`(del f)/(del x) = alpha (del f)/(del u) + beta (del f)/(del
		v)`,
		`quad (del f)/(del y) = (del f)/(del u) + (del f)/(del v)`,<br/>
		`(del^2 f)/(del x^2) = alpha^2 (del^2 f)/(del u^2) + 2 alpha beta
		(del^2 f)/(del u del v) + beta^2 (del^2 f)/(del v^2)`,<br/>
		`(del^2 f)/(del x del y) = alpha (del^2 f)/(del u^2) +
		(alpha+beta) (del^2 f)/(del u del v) + beta (del^2 f)/(del
		v^2)`,<br/>
		`(del^2 f)/(del y^2) = (del f^2)/(del u^2) + 2(del^2 f)/(del u del
		v) + (del^2 f)/(del v^2)`.
	</span>
	代入方程, 并利用 Vieta 定理得
	<span class="formula">
		`0 = [a(2alpha beta) + b(alpha+beta) + 2c] (del^2 f)/(del u del v)`
		`= (4a c - b^2)/a (del^2 f)/(del u del v)`.
	</span>
	由于特征方程有两根, 判别式 `b^2 - 4 a c != 0`, 最终得到
	<span class="formula">
		`(del^2 f)/(del u del v) = 0`.
	</span>
</p>

<p class="example">
	设 `f` 二阶连续可微, `z = f(x+y, f(x, y))`. 求 `(del^2 z)/(del x del
	y)`.
</p>

<p class="solution">
	记 `u = x+y`, `v = f(x, y)`, 则
	<span class="formula">
		`(del z)/(del y)`
		`= (del z)/(del u)(del u)/(del y)+(del z)/(del v)(del v)/(del y)`
		`= (del z)/(del u) + (del z)/(del v) (del v)/(del y)`,<br/>
		`(del^2 z)/(del x del y)`
		`= (del^2 z)/(del u^2) (del u)/(del x) + (del^2 z)/(del v del u)
		(del v)/(del x)`
		`+ ((del^2 z)/(del u del v) (del u)/(del x) + (del^2 z)/(del v^2)
		(del v)/(del x)) (del v)/(del y)`
		`+ (del z)/(del v) (del^2 v)/(del x del y)`
		`= f_(11)''(u, v) + f_(12)''(u, v) f_1'(x, y)`
		`+ (f_(21)''(u, v) + f_(22)''(u, v) f_1'(x, y))f_2'(x, y)`
		`+ f_2'(u, v) f_(21)''(x, y)`.
	</span>
	再将 `u, v` 用 `x, y` 代回, 即得到最终结果.
</p>

<p class="example">
	讨论二元数量函数的极坐标表示和三元数量函数的球坐标表示.
</p>

<ol class="solution">
	<li>设 `u(x, y)` 可微, 令 `x = r cos theta`, `y = r sin theta`, 则
		<span class="formula">
			`(del u)/(del r) = (del u)/(del x) cos theta
			+ (del u)/(del y) sin theta`,<br/>
			`(del u)/(del theta) = r (-(del u)/(del x) sin theta
			+ (del u)/(del y) cos theta)`.
		</span>
		代换的 Jacobi 行列式为
		<span class="formula">
			`|(del x)/(del r), (del x)/(del theta);
			  (del y)/(del r), (del y)/(del theta)| = r`.
		</span>
		解线性方程组得
		<span class="formula">
			`grad u = ((del u)/(del x), (del u)/(del y))`
			`= ((del u)/(del r) cos theta
			- 1/r (del u)/(del theta) sin theta,
			(del u)/(del r) sin theta
			+ 1/r (del u)/(del theta) cos theta)`
			`= (x/r, y/r) (del u)/(del r)
			+ 1/r (-y/r, x/r) (del u)/(del theta)`
			`:= (del u)/(del r) bm e_r
			+ 1/r (del u)/(del theta) bm e_theta`.
		</span>
		其中 `bm e_r = ((x","y))/r` 表示极径 `r` 方向的单位向量,
		`bm e_theta = ((-y","x))/r` 表示极角 `theta` 方向的单位向量.
	</li>
	<li>设 `u(x, y, z)` 可微, 令 `x = r cos theta cos varphi`,
		`y = r sin theta cos varphi`, `z = r sin varphi`, 则
		<span class="formula">
			`(del u)/(del r) = (del u)/(del x) cos theta cos varphi`
			`+ (del u)/(del y) sin theta cos varphi`
			`+ (del u)/(del z) sin varphi`,<br/>
			`(del u)/(del theta) = -(del u)/(del x) r sin theta cos
			varphi`
			`+ (del u)/(del y) r cos theta cos varphi`,<br/>
			`(del u)/(del varphi) = -(del u)/(del x) r cos theta sin
			varphi`
			`- (del u)/(del y) r sin theta sin varphi`
			`+ r cos varphi`.
		</span>
		代换的 Jacobi 行列式为
		<span class="formula">
			`|(del x)/(del r), (del x)/(del theta), (del x)/(del varphi);
			(del y)/(del r), (del y)/(del theta), (del y)/(del varphi);
			(del z)/(del r), (del z)/(del theta), (del z)/(del varphi)|`
			`= r^2 cos varphi`.
		</span>
		解线性方程组得
		<span class="formula">
			`grad u = ((del u)/(del x), (del u)/(del y), (del u)/(del z))`
			`= 1/(r^2 cos varphi)`
			`((del u)/(del r) r^2 cos theta cos^2 varphi`
			`- (del u)/(del theta) r sin theta`
			`- (del u)/(del varphi) r cos theta cos varphi sin varphi,`
			`(del u)/(del r) r^2 sin theta cos^2 varphi`
			`+ (del u)/(del theta) r cos theta`
			`- (del u)/(del varphi) r sin theta cos varphi sin varphi,`
			`(del u)/(del r) r^2 cos varphi sin varphi`
			`+(del u)/(del varphi) r cos^2 varphi)`
			`= (del u)/(del r) (cos theta cos varphi, sin theta cos
			varphi, sin varphi)`
			`+ 1/(r cos varphi) (del u)/(del theta) (-sin theta, cos
			theta, 0)`
			`+ 1/r (del u)/(del varphi) (-cos theta sin varphi, -sin theta
			sin varphi, cos varphi)`
			`:= (del u)/(del r) bm e_r + 1/(r cos varphi) (del u)/(del
			theta) bm e_theta + 1/r (del u)/(del varphi) bm e_varphi`.
		</span>
		以 `bm alpha_1` 记与 `bm alpha` 同向的单位向量,
		其中
		<span class="formula">
			`bm e_r = (x_r, y_r, z_r)_1 = (cos theta cos varphi, sin
			theta cos varphi, sin varphi) = ((x","y","z))/r`,<br/>
			`bm e_theta = (x_theta, y_theta, z_theta)_1 = (-sin theta, cos
			theta, 0) = ((-y","x","0))/sqrt(x^2+y^2)`,<br/>
			`bm e_varphi = (x_varphi, y_varphi, z_varphi)_1 = (-cos theta
			sin varphi, -sin theta sin varphi, cos varphi)`
			`= ((-x z","-y z","x^2+y^2))/(r sqrt(x^2+y^2))`.
		</span>
		三者分别表示 `r, theta, varphi` 方向的单位向量.
		(注: 如果作变换 `x = r cos theta sin varphi`, `y = r sin theta sin
		varphi`, `z = r cos varphi`, 上面的行列式应该等于 `-r^2 sin
		varphi`)
	</li>
</ol>

<p class="example">
	分别在柱坐标与球坐标下计算 `"d"l^2 = dx^2 + dy^2 + dz^2`.
</p>

<ol class="solution">
	<li>柱坐标 `x = r cos theta`, `y = r sin theta` 下,
		<span class="formula">
			`dx = cos theta "d"r - r sin theta "d"theta`,
			`quad dy = sin theta "d"r + r cos theta "d"theta`.
		</span>
		于是 `dx^2 + dy^2 + dz^2 = "d"r^2 + r^2 "d"theta^2 + dz^2`.
		也可以由 Jacobi 矩阵 `bm J = (del(x, y))/(del(r, theta))`
		直接得到
		<span class="formula">
			`dx^2 + dy^2 = ["d"r, "d"theta] bm(J' J) ["d"r; "d"theta]`.
		</span>
	</li>
	<li>对球坐标 `x = r sin varphi cos theta`,
		`y  = r sin varphi sin theta`, `z = r cos varphi`
		也作类似 1. 的计算, 得
		<span class="formula">
			`"d"l^2 = "d"r^2 + r^2(sin varphi"d"theta^2 + "d"varphi^2)`.
		</span>
	</li>
</ol>

<p class="example">
  [来自 同济高数第七版]
  已知两个连续可微函数 `f, F`, 满足 `y = f(x, t)`,
  且 `F(x, y, t) = 0` 确定一个隐函数 `t(x, y)`. 求 `dy/dx`.
</p>

<p class="solution">
  由隐函数定理知 `(del t)/(del x) = -F_1' // F_3'`,
  `(del t)/(del y) = -F_2' // F_3'`.
  使用全微分的链式法则,
  <span class="formula">
    `dy/dx = f_1' + f_2' dt/dx`
    `= f_1' + f_2'((del t)/(del x) + (del t)/(del y) dy/dx)`.
  </span>
  解得
  <span class="formula">
    `dy/dx = (f_1' + f_2' (del t)/(del x))/(1 - f_1'(del t)/(del y))`
    `= (f_1' F_3' - f_2' F_1')/(F_3' + f_2' F_2')`.
  </span>
</p>

<ol class="theorem">
  <b>齐次函数的 Euler 定理</b>
  设 `f(bm x)` 是 `D sube RR^n` 到 `RR` 的可微函数, `alpha in RR`, 则
  <li>若 `f` 是 `alpha` 次齐次函数, 即 `f` 满足以下函数方程:
    <span class="formula">
      `f(k bm x) = k^alpha f(bm x)`, `quad AA k in RR`,
      <span class="label" id="eq-homogeneous"></span>
    </span>
    则 `(del f)/(del bm x)
    := ((del f)/(del x_1), cdots, (del f)/(del x_n))`
    是 `alpha-1` 次齐次函数.
  </li>
  <li>`f` 是齐次函数当且仅当它满足下面的偏微分方程 (Euler 方程):
    <span class="formula">
      `(del f)/(del bm x) * bm x = alpha f(bm x)`.
      <span class="label" id="eq-euler"></span>
    </span>
  </li>
</ol>

<ol class="proof">
  <li>在函数方程 <a class="ref" href="#eq-homogeneous"></a>
    两边对 `bm x` 求导,
    <span class="formula">
      `k (del f)/(del bm x) (k bm x) = k^alpha (del f)/(del bm x)`,
    </span>
    这指出 `(del f)/(del bm x)` 是 `alpha-1` 次齐次的.
  </li>
  <li>先设 `f` 为 `alpha` 次齐次函数.  在函数方程
    <a class="ref" href="#eq-homogeneous"></a> 两边对 `k` 求导,
    <span class="formula">
      `(del f)/(del bm x)(k bm x) * bm x = alpha k^(alpha-1) f(bm x)`,
    </span>
    取 `k = 1` 即得 <a class="ref" href="#eq-euler"></a>.<br/>
    再设 Euler 方程成立, 取 `bm x = k bm x` 有
    <span class="formula">
      `(del f)/(del bm x)(k bm x) * (k bm x) = alpha f(k bm x)`,
    </span>
    于是
    <span class="formula">
      `"d"/("d"k) f(k bm x)`
      `= (del f)/(del bm x)(k bm x) * bm x`
      `= alpha/k f(k bm x)`.
    </span>
    这是关于函数 `g(k) = f(k bm x)` 的常微分方程, 通解为
    <span class="formula">
      `f(k bm x) = c k^alpha`.
    </span>
    取 `k = 1` 即得 `c = f(bm x)`, 因此
    <span class="formula">
      `f(k bm x) = k^alpha f(bm x)`.
    </span>
  </li>
</ol>

<p class="example">
  `f(x, y) = x^2 + 3 x y + y^2` 是二次齐次函数, 我们有
  <span class="formula">
    `(del f)/(del x) x + (del f)/(del y) y = 2 f`.
  </span>
</p>

<p class="example">
  [来自 我是得不到的i]
  若 `f(x, y)` 是可微的零阶齐次函数, `y != 0`,
  则存在一元可微函数 `varphi` 使得 `f = varphi(x/y)`.
</p>

<p class="proof">
  设 `u = x/y`, `v = y`, 换元得 `f(x, y) = varphi(u, v)`. 下证 `(del
  varphi)/(del v) = 0`, 从而 `varphi` 仅依赖于 `u`. 事实上, 由 Euler 方程
  <span class="formula">
    `0 = x (del f)/(del x) + y (del f)/(del y)`
    `= x ((del varphi)/(del u) 1/y + (del varphi)/(del v) * 0)
    + y ((del varphi)/(del u) (-x/y^2) + (del varphi)/(del v))
    `= y (del varphi)/(del v)`.
  </span>
</p>

<script src="../../js/note.js?type=math"></script>
</body>
</html>
