<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <title>多元函数微分学</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" type="text/css" href="../../css/note.css" />
</head>
<body>

<h2>数量函数</h2>

<h3>偏导数与微分</h3>

<p class="definition">
  <b>偏导数</b>
  将 `n` 元数量函数 `f` 视为其中一个变元 `x^i`
  的函数, 其它变元固定, 就得到一元函数
  `varphi: x^i mapsto f(x^1, cdots, x^n)`. 定义 `f` 关于变元 `x^i`
  的偏导数为 `(del f)/(del x^i) = varphi'(x^i)`, 即
  <span class="formula">
    `(del f)/(del x^i)|_(x_0)`
    `= lim_(h to 0) (f(x_0^1, cdots, x_0^i + h, cdots, x_0^n)
    - f(x_0^1, cdots, x_0^i, cdots, x_0^n)) / h`.
  </span>
</p>

<p class="definition">
  <b>微分</b>
  设 `n` 元数量函数 `f` 在 `x_0 in RR^n` 的邻域上有定义, 若 `f` 在 `x_0`
  附近的变化 `f(x_0 + h) - f(x_0)` 近似于一个线性函数 `varphi: h mapsto
  alpha * h`, 其中 `alpha, h in RR^n`, "`*`" 表示向量内积:
  <span class="formula">
    `f(x_0 + h) = f(x_0) + alpha * h + o(|h|)`, `quad h to 0`,
    <span class="label" id="for-diff-def"></span>
  </span>
  即
  <span class="formula">
    `lim_(h to 0) (f(x_0+h) - f(x_0) - alpha * h)/|h| = 0`,
  </span>
  就称 `f` 在 `x_0` 可微.
  线性函数 `varphi: h mapsto alpha * h` 称为 `f` 在 `x_0` 的微分,
  一般用 `"d"f` 表示因变元, `dx` 表示自变元, 记为
  <span class="formula">
    `"d"f(x_0) = alpha * dx = alpha_1 dx^1 + cdots + alpha_n dx^n`.
  </span>
</p>

<p class="corollary">
  <b>可微必连续</b>
  设 `f` 在 `x_0` 处可微, 在 <a class="ref" href="#for-diff-def"></a>
  两边令 `h to 0` 就得到 `lim_(h to 0) f(x_0 + h) = f(x_0)`.
</p>

<p class="corollary">
  <b>可微则偏导数存在</b>
  设 `f` 在 `x_0` 处可微, 在 <a class="ref" href="#for-diff-def"></a>
  中取 `h = (0, cdots, h_i, cdots, 0)` 就有
  <span class="formula">
    `f(x_0 + h) = f(x_0) + alpha_i h_i + o(|h_i|)`
  </span>
  故
  <span class="formula">
    `(del f)/(del x^i)(x_0) = lim_(h to 0) (f(x_0 + h) - f(x_0))/h_i
    = alpha_i`.
  </span>
</p>

<p class="corollary">
  <b>偏导连续则可微</b>
  设 `f` 在 `x_0` 的邻域上关于各变元存在偏导数, 且这些偏导数在 `x_0`
  处连续, 则 `f` 在 `x_0` 可微.
</p>

<p class="proof">
  记号简单起见, 以二元函数为例.
  在 `(x_0, y_0)` 的邻域上应用一元函数的微分中值定理,
  <span class="formula">
    `f(x, y) - f(x_0, y_0)`
    `= f(x, y) - f(x_0, y) + f(x_0, y) - f(x_0, y_0)`
    `= (del f)/(del x)(xi, y)(x-x_0) + (del f)/(del y)(x_0, eta)(y-y_0)`,
  </span>
  其中 `xi` 在 `x_0` 与 `x` 之间, `eta` 在 `y_0` 与 `y` 之间.
  由于偏导数连续, 当 `(x, y) to (x_0, y_0)` 时,
  <span class="formula">
    `(del f)/(del x)(xi, y) to (del f)/(del x)(x_0, y_0)`,
    `quad (del f)/(del y)(x_0, eta) to (del f)/(del y)(x_0, y_0)`.
  </span>
  从而
  <span class="formula">
    `f(x, y) - f(x_0, y_0)`
    `= (del f)/(del x)(x_0, y_0)(x-x_0) + o(|x-x_0|)`
    `+ (del f)/(del y)(x_0, y_0)(y-y_0) + o(|y-y_0|)`
    `= (del f)/(del x)(x_0, y_0)(x-x_0)
    + (del f)/(del y)(x_0, y_0)(y-y_0) + o(r)`,
  </span>
  其中 `r = sqrt((x-x_0)^2 + (y-y_0)^2)`, 即 `f` 在 `(x_0, y_0)` 可微.
</p>

<p class="remark">
  若 `f` 在定义域 `D` 上关于各变元有连续的偏导数,
  就称它<b>连续可微</b>, 记为 `f in C^1(D)`.
</p>

<h3>混合偏导数</h3>

<p class="theorem">
  <b>一阶偏导可微则混合偏导相等 (Young)</b>
  设二元函数 `f` 在 `P_0(x_0, y_0)` 的邻域上存在偏导数, 且 `f_x`, `f_y`
  都在 `P_0` 可微, 则
  <span class="formula">
    `f_(x y)(x_0, y_0) = f_(y x)(x_0, y_0)`.
  </span>
</p>

<p class="proof">
  构造函数
  <span class="formula">
    `g(h) = f(x_0+h,y_0+h) - f(x_0+h,y_0) - f(x_0,y_0+h) + f(x_0,y_0)`,
  </span>
  下证
  <span class="formula">
    `g(h) = f_(y x)(x_0,y_0) h^2 + o(h^2)`
    `= f_(x y)(x_0,y_0) h^2 + o(h^2)`,
    `quad h to 0`,
  </span>
  从而得到定理的结论. 事实上对固定的充分小的 `h`, 令
  <span class="formula">
    `varphi(x) = f(x, y_0 + h) - f(x, y_0)`,
  </span>
  则由微分中值定理,
  <span class="formula">
    `g(h) = varphi(x_0+h) - varphi(x_0)`
    `= varphi'(x_0 + theta h) h`
    `= [f_x(x_0 + theta h, y_0 + h) - f_x(x_0 + theta h, y_0)]h`.
  </span>
  注意在 `P_0` 处 `f_x` 可微, 故成立
  <span class="formula">
    `(g(h))/h`
    `= (f_x + f_(x x)theta h + f_(y x) h + o(h))`
    `- (f_x + f_(x x)theta h + o(h))`
    `= f_(y x) h + o(h)`
    `quad h to 0`.
  </span>
  同理考虑函数 `psi(y) = f(x_0 + h, y) - f(x_0, y)` 可得另一个等式.
</p>

<p class="theorem">
  <b>混合偏导连续则相等 (Schwartz)</b>
  设二元函数 `f` 在 `P_0(x_0, y_0)` 的邻域上存在二阶混合偏导数 `f_(x y)`,
  `f_(y x)`, 且两个混合偏导数在 `P_0` 连续, 则
  <span class="formula">
    `f_(x y)(x_0, y_0) = f_(y x)(x_0, y_0)`.
  </span>
</p>

<p class="proof">
  记 `g(h, k) = f(x_0+h,y_0+k) - f(x_0+h,y_0) - f(x_0,y_0+k)
  + f(x_0,y_0)`,
  则
  <span class="formula">
    `f_(x y)(x_0,y_0) = lim_(h to 0) lim_(k to 0) (g(h, k))/(h k)`,<br>
    `f_(y x)(x_0,y_0) = lim_(k to 0) lim_(h to 0) (g(h, k))/(h k)`.
  </span>
  下面证明这两个累次极限可交换.
  对固定的充分小的 `k`, 令
  <span class="formula">
    `varphi(x) = f(x, y_0 + k) - f(x, y_0)`,
  </span>
  运用两次微分中值定理有
  <span class="formula">
    `g(h, k)`
    `= varphi(x_0+h) - varphi(x_0)`
    `= varphi'(x_0 + theta_1 h) k`
    `= [f_x(x_0 + theta_1 h, y_0 + k) - f_x(x_0 + theta_1 h, y_0)] k`
    `= f_(y x)(x_0 + theta_1 h, y_0 + theta_2 k) h k`.
  </span>
  令 `(h, k) to (0, 0)`, 由 `f_(y x)` 在 `P_0` 连续得
  <span class="formula">
    `lim_((h,k) to (0,0)) g(h, k)/(h k) to f_(y x)(x_0, y_0)`.
  </span>
  同理考虑函数 `psi(y) = f(x_0+h, y) - f(x_0, y)` 可得
  <span class="formula">
    `lim_((h,k) to (0,0)) g(h, k)/(h k) to f_(x y)(x_0, y_0)`.
  </span>
  因此两个混合偏导数在 `(x_0, y_0)` 相等.
</p>

<ol class="definition">
  <li><b>`k` 阶可微</b>
    若 `n` 元数量函数 `f` 在 `x_0` 的邻域上存在各个 `k-1` 阶偏导数 (`k ge
    2`),
    且所有 `k-1` 阶偏导数在 `x_0` 可微, 则称 `f` 在 `x_0` 是
    `k` 阶可微的.
  <li><b>`k` 阶可微蕴涵 `k-1` 阶可微</b>
    若 `f` 在 `x_0` 处二阶可微, 由定义 `f` 的所有一阶偏导数连续, 从而 `f`
    在 `x_0` 处可微. 一般地, `k` 阶可微蕴涵 `k-1` 阶可微.
  </li>
  <li><b>`k` 阶连续可微</b>
    若 `f` 在定义域 `D` 上有 `k` 阶偏导数, 且所有 `k` 阶偏导数在 `D`
    上连续, 于是 `f` 在 `D` 上的 `k-1` 阶偏导数均可微,
    我们称 `f` 在 `D` 上 `k` 阶连续可微, 记为 `f in C^k(D)`.
    `k` 阶连续可微蕴涵 `k` 阶可微.
  </li>
</ol>

<p class="corollary">
  由 Young 定理得: 若 `f` 在 `x_0` 处 `k` 阶可微, 则它在该点直到 `k`
  阶的所有混合偏导数都与次序无关.
</p>

<h3>隐函数</h3>

<p class="example">
  [来自 同济高数第七版]
  已知两个连续可微函数 `f, F`, 满足 `y = f(x, t)`,
  且 `F(x, y, t) = 0` 确定一个隐函数 `t(x, y)`. 求 `dy/dx`.
</p>

<p class="solution">
  由隐函数定理知 `(del t)/(del x) = -F_1' // F_3'`,
  `(del t)/(del y) = -F_2' // F_3'`.
  使用全微分的链式法则,
  <span class="formula">
    `dy/dx = f_1' + f_2' dt/dx`
    `= f_1' + f_2'((del t)/(del x) + (del t)/(del y) dy/dx)`.
  </span>
  解得
  <span class="formula">
    `dy/dx = (f_1' + f_2' (del t)/(del x))/(1 - f_1'(del t)/(del y))`
    `= (f_1' F_3' - f_2' F_1')/(F_3' + f_2' F_2')`.
  </span>
</p>

<h3>齐次函数</h3>

<ol class="theorem">
  <b>齐次函数的 Euler 定理</b>
  设 `f(bm x)` 是 `D sube RR^n` 到 `RR` 的可微函数, `alpha in RR`, 则
  <li>若 `f` 是 `alpha` 次齐次函数, 即 `f` 满足以下函数方程:
    <span class="formula">
      `f(k bm x) = k^alpha f(bm x)`, `quad AA k in RR`,
      <span class="label" id="eq-homogeneous"></span>
    </span>
    则 `(del f)/(del bm x)
    := ((del f)/(del x_1), cdots, (del f)/(del x_n))`
    是 `alpha-1` 次齐次函数.
  </li>
  <li>`f` 是齐次函数当且仅当它满足下面的偏微分方程 (Euler 方程):
    <span class="formula">
      `(del f)/(del bm x) * bm x = alpha f(bm x)`.
      <span class="label" id="eq-euler"></span>
    </span>
  </li>
</ol>

<ol class="proof">
  <li>在函数方程 <a class="ref" href="#eq-homogeneous"></a>
    两边对 `bm x` 求导,
    <span class="formula">
      `k (del f)/(del bm x) (k bm x) = k^alpha (del f)/(del bm x)`,
    </span>
    这指出 `(del f)/(del bm x)` 是 `alpha-1` 次齐次的.
  </li>
  <li>先设 `f` 为 `alpha` 次齐次函数.  在函数方程
    <a class="ref" href="#eq-homogeneous"></a> 两边对 `k` 求导,
    <span class="formula">
      `(del f)/(del bm x)(k bm x) * bm x = alpha k^(alpha-1) f(bm x)`,
    </span>
    取 `k = 1` 即得 <a class="ref" href="#eq-euler"></a>.<br/>
    再设 Euler 方程成立, 取 `bm x = k bm x` 有
    <span class="formula">
      `(del f)/(del bm x)(k bm x) * (k bm x) = alpha f(k bm x)`,
    </span>
    于是
    <span class="formula">
      `"d"/("d"k) f(k bm x)`
      `= (del f)/(del bm x)(k bm x) * bm x`
      `= alpha/k f(k bm x)`.
    </span>
    这是关于函数 `g(k) = f(k bm x)` 的常微分方程, 通解为
    <span class="formula">
      `f(k bm x) = c k^alpha`.
    </span>
    取 `k = 1` 即得 `c = f(bm x)`, 因此
    <span class="formula">
      `f(k bm x) = k^alpha f(bm x)`.
    </span>
  </li>
</ol>

<p class="example">
  `f(x, y) = x^2 + 3 x y + y^2` 是二次齐次函数, 我们有
  <span class="formula">
    `(del f)/(del x) x + (del f)/(del y) y = 2 f`.
  </span>
</p>

<p class="example">
  [来自 我是得不到的i]
  若 `f(x, y)` 是可微的零阶齐次函数, `y != 0`,
  则存在一元可微函数 `varphi` 使得 `f = varphi(x/y)`.
</p>

<p class="proof">
  设 `u = x/y`, `v = y`, 换元得 `f(x, y) = varphi(u, v)`. 下证 `(del
  varphi)/(del v) = 0`, 从而 `varphi` 仅依赖于 `u`. 事实上, 由 Euler 方程
  <span class="formula">
    `0 = x (del f)/(del x) + y (del f)/(del y)`
    `= x ((del varphi)/(del u) 1/y + (del varphi)/(del v) * 0)
    + y ((del varphi)/(del u) (-x/y^2) + (del varphi)/(del v))`
    `= y (del varphi)/(del v)`.
  </span>
</p>

<h2>向量函数</h2>

<p class="example">
	<b>Jacobi 矩阵</b>
    的意义是向量对向量的偏导数, 它表示向量微元间的线性变换.
    我们从一个简单例子入手:
	设 `f(x,y)` 二阶连续可微, 令 `x = a u + b v`, `y = c u + d v`,
	`a, b, c, d` 为常数, 则
	<span class="formula">
		`(del f)/(del u) = a(del f)/(del x) + c(del f)/(del y)`,
		`quad (del f)/(del v) = b(del f)/(del x) + d(del f)/(del y)`.
	</span>
	如果记 `del/(del u) = a del/(del x) + c del/(del y)`,
	`del/(del v) = b del/(del x) + d del/(del y)`, 容易验证
	<span class="formula">
		`del^2/(del u^2) = (a del/(del x) + c del/(del y))^2`
		`= a^2 del^2/(del x^2) + 2a c del^2/(del x del y)
		+ c^2 del^2/(del y^2)`,<br/>
		`del^2/(del u del v) = (a del/(del x) + c del/(del y))
		(b del/(del x) + d del/(del y))`
		`= a b del^2/(del x^2) + (a d+b c) del^2/(del x del y)
		+ c d del^2/(del y^2)`,<br/>
		`del^2/(del v^2) = (b del/(del x) + d del/(del y))^2`
		`= b^2 del^2/(del x^2) + 2b d del^2/(del x del y)
		+ d^2 del^2/(del y^2)`.
	</span>
    以上结论可用矩阵简洁地表示: 注意虽然 `x = x(u, v)`, `y = y(u, v)`
    可能为非线性变换, 但在 `f` 可微的条件下, 向量微元 `(dx, dy)`
    和 `("d"u, "d"v)` 之间的变换是线性的. 这个线性变换记为:
    <span class="formula">
        `[dx;dy] = J ["d"u;"d"v]`, `quad J = (del(x, y))/(del(u,v))`.
    </span>
    定义数量函数对向量的偏导数,
    `del/(del(u, v)) = (del/(del u), del/(del v))`, `del/(del(x, y))
    = (del/(del x), del/(del y))`, 则有
    <span class="formula">
        `del/(del(u, v)) = del/(del(x,y)) (del(x,y))/(del(u,v))`
        `= del/(del(x,y)) J`,<br/>
        `H_((u,v)) = [del^2/(del u^2), del^2/(del u del v);
            del^2/(del v del u), del^2/(del v^2)]`
        `= (del/(del u), del/(del v))^T (del/(del u), del/(del v))`
        `= J^T (del/(del x), del/(del y))^T (del/(del x), del/(del y)) J`
        `= J^T H_((x,y)) J`,
        <br/>
        `dx^2 + dy^2 = ("d"u, "d"v) J^T J ["d"u; "d"v]`,
    </span>
    等等. 矩阵 `J` 称为 <b>Jacobi 矩阵</b>, `H` 称为 <b>Hessian 矩阵</b>.
</p>

<p class="example">
	设 `f(x, y)` 二阶连续可微, 且满足方程
	<span class="formula">
		`a(del^2 f)/(del x^2) + b(del^2 f)/(del x del y) + c(del^2 f)/(del
		y^2) = 0`,
	</span>
	其中 `a, b, c` 为常数, `a != 0`.
	若特征方程 `a z^2 + b z + c = 0` 有两个不同的根 `alpha, beta`,
	作变元代换 `u = alpha x + y`, `v = beta x + y`,
	验证 `(del^2 f)/(del u del v) = 0`.
</p>

<p class="solution">
	<span class="formula">
		`(del f)/(del x) = alpha (del f)/(del u) + beta (del f)/(del
		v)`,
		`quad (del f)/(del y) = (del f)/(del u) + (del f)/(del v)`,<br/>
		`(del^2 f)/(del x^2) = alpha^2 (del^2 f)/(del u^2) + 2 alpha beta
		(del^2 f)/(del u del v) + beta^2 (del^2 f)/(del v^2)`,<br/>
		`(del^2 f)/(del x del y) = alpha (del^2 f)/(del u^2) +
		(alpha+beta) (del^2 f)/(del u del v) + beta (del^2 f)/(del
		v^2)`,<br/>
		`(del^2 f)/(del y^2) = (del f^2)/(del u^2) + 2(del^2 f)/(del u del
		v) + (del^2 f)/(del v^2)`.
	</span>
	代入方程, 并利用 Vieta 定理得
	<span class="formula">
		`0 = [a(2alpha beta) + b(alpha+beta) + 2c] (del^2 f)/(del u del v)`
		`= (4a c - b^2)/a (del^2 f)/(del u del v)`.
	</span>
	由于特征方程有两根, 判别式 `b^2 - 4 a c != 0`, 最终得到
	<span class="formula">
		`(del^2 f)/(del u del v) = 0`.
	</span>
</p>

<p class="example">
  设 `f` 二阶连续可微, `z = f(x+y, f(x, y))`. 求 `part^2 z (x y)`.
</p>

<p class="solution">
  记 `u = x+y`, `v = f(x, y)`, 则
  <span class="formula">
    `part z y`
    `= part z u part u y + part z v part v y`
    `= part z u + part z v part v y`,<br/>
    `part^2 z (x y)`
    `= part^2 z u^2 part u x + part^2 z (v u) part v x`
    `+ (part^2 z (u v) part u x + part^2 z v^2 part v x ) part v y`
    `+ part z v part^2 v (x y)`
    `= f_(11)''(u, v) + f_(12)''(u, v) f_1'(x, y)`
    `+ (f_(21)''(u, v) + f_(22)''(u, v) f_1'(x, y))f_2'(x, y)`
    `+ f_2'(u, v) f_(21)''(x, y)`.
  </span>
  再将 `u, v` 用 `x, y` 代回, 即得到最终结果.
</p>

<p class="example">
	讨论二元数量函数的极坐标表示和三元数量函数的球坐标表示.
</p>

<ol class="solution">
	<li>设 `u(x, y)` 可微, 令 `x = r cos theta`, `y = r sin theta`, 则
		<span class="formula">
			`(del u)/(del r) = (del u)/(del x) cos theta
			+ (del u)/(del y) sin theta`,<br/>
			`(del u)/(del theta) = r (-(del u)/(del x) sin theta
			+ (del u)/(del y) cos theta)`.
		</span>
		代换的 Jacobi 行列式为
		<span class="formula">
			`|(del x)/(del r), (del x)/(del theta);
			  (del y)/(del r), (del y)/(del theta)| = r`.
		</span>
		解线性方程组得
		<span class="formula">
			`grad u = ((del u)/(del x), (del u)/(del y))`
			`= ((del u)/(del r) cos theta
			- 1/r (del u)/(del theta) sin theta,
			(del u)/(del r) sin theta
			+ 1/r (del u)/(del theta) cos theta)`
			`= (x/r, y/r) (del u)/(del r)
			+ 1/r (-y/r, x/r) (del u)/(del theta)`
			`:= (del u)/(del r) bm e_r
			+ 1/r (del u)/(del theta) bm e_theta`.
		</span>
		其中 `bm e_r = ((x","y))/r` 表示极径 `r` 方向的单位向量,
		`bm e_theta = ((-y","x))/r` 表示极角 `theta` 方向的单位向量.
	</li>
	<li>设 `u(x, y, z)` 可微, 令 `x = r cos theta cos varphi`,
		`y = r sin theta cos varphi`, `z = r sin varphi`, 则
		<span class="formula">
			`(del u)/(del r) = (del u)/(del x) cos theta cos varphi`
			`+ (del u)/(del y) sin theta cos varphi`
			`+ (del u)/(del z) sin varphi`,<br/>
			`(del u)/(del theta) = -(del u)/(del x) r sin theta cos
			varphi`
			`+ (del u)/(del y) r cos theta cos varphi`,<br/>
			`(del u)/(del varphi) = -(del u)/(del x) r cos theta sin
			varphi`
			`- (del u)/(del y) r sin theta sin varphi`
			`+ r cos varphi`.
		</span>
		代换的 Jacobi 行列式为
		<span class="formula">
			`|(del x)/(del r), (del x)/(del theta), (del x)/(del varphi);
			(del y)/(del r), (del y)/(del theta), (del y)/(del varphi);
			(del z)/(del r), (del z)/(del theta), (del z)/(del varphi)|`
			`= r^2 cos varphi`.
		</span>
		解线性方程组得
		<span class="formula align">
          `grad u = ((del u)/(del x), (del u)/(del y), (del u)/(del z))`<br>
            `= 1/(r^2 cos varphi)
            ((del u)/(del r) r^2 cos theta cos^2 varphi
            - (del u)/(del theta) r sin theta
            - (del u)/(del varphi) r cos theta cos varphi sin varphi;
            (del u)/(del r) r^2 sin theta cos^2 varphi
            + (del u)/(del theta) r cos theta
            - (del u)/(del varphi) r sin theta cos varphi sin varphi;
            (del u)/(del r) r^2 cos varphi sin varphi
            +(del u)/(del varphi) r cos^2 varphi)`<br>
            `= (del u)/(del r) (cos theta cos varphi, sin theta cos
            varphi, sin varphi)`<br>
            `+ 1/(r cos varphi) (del u)/(del theta) (-sin theta, cos
            theta, 0)`<br>
            `+ 1/r (del u)/(del varphi) (-cos theta sin varphi, -sin theta
            sin varphi, cos varphi)`<br>
            `:= (del u)/(del r) bm e_r + 1/(r cos varphi) (del u)/(del
            theta) bm e_theta + 1/r (del u)/(del varphi) bm e_varphi`.
		</span>
		以 `bm alpha_1` 记与 `bm alpha` 同向的单位向量,
		其中
		<span class="formula">
			`bm e_r = (x_r, y_r, z_r)_1 = (cos theta cos varphi, sin
			theta cos varphi, sin varphi) = ((x","y","z))/r`,<br/>
			`bm e_theta = (x_theta, y_theta, z_theta)_1 = (-sin theta, cos
			theta, 0) = ((-y","x","0))/sqrt(x^2+y^2)`,<br/>
			`bm e_varphi = (x_varphi, y_varphi, z_varphi)_1 = (-cos theta
			sin varphi, -sin theta sin varphi, cos varphi)`
			`= ((-x z","-y z","x^2+y^2))/(r sqrt(x^2+y^2))`.
		</span>
		三者分别表示 `r, theta, varphi` 方向的单位向量.
		(注: 如果作变换 `x = r cos theta sin varphi`, `y = r sin theta sin
		varphi`, `z = r cos varphi`, 上面的行列式应该等于 `-r^2 sin
		varphi`)
	</li>
</ol>

<p class="example">
	分别在柱坐标与球坐标下计算 `"d"l^2 = dx^2 + dy^2 + dz^2`.
</p>

<ol class="solution">
	<li>柱坐标 `x = r cos theta`, `y = r sin theta` 下,
		<span class="formula">
			`dx = cos theta "d"r - r sin theta "d"theta`,
			`quad dy = sin theta "d"r + r cos theta "d"theta`.
		</span>
		于是 `dx^2 + dy^2 + dz^2 = "d"r^2 + r^2 "d"theta^2 + dz^2`.
		也可以由 Jacobi 矩阵 `bm J = (del(x, y))/(del(r, theta))`
		直接得到
		<span class="formula">
			`dx^2 + dy^2 = ["d"r, "d"theta] bm(J' J) ["d"r; "d"theta]`.
		</span>
	</li>
	<li>对球坐标 `x = r sin varphi cos theta`,
		`y  = r sin varphi sin theta`, `z = r cos varphi`
		也作类似 1. 的计算, 得
		<span class="formula">
			`"d"l^2 = "d"r^2 + r^2(sin varphi"d"theta^2 + "d"varphi^2)`.
		</span>
	</li>
</ol>

<h2>多重指标</h2>

<p class="definition">
  设 `alpha = (alpha_1, alpha_2, cdots, alpha_n)`,
  `beta = (beta_1, beta_2, cdots, beta_n)` 是非负整数组成的 `n` 维向量,
  `x = (x_1, x_2, cdots, x_n) in RR^n`. 定义
  <span class="formula">
    `|alpha| = alpha_1 + alpha_2 + cdots + alpha_n`,<br>
    `alpha! = alpha_1! alpha_2! cdots alpha_n!`,<br>
    `alpha +- beta = (alpha_1 +- beta_1, cdots, alpha_n +- beta_n)`,<br>
    `beta le alpha iff beta_1 le alpha_1, beta_2 le alpha_2, cdots, beta_n le alpha_n`,<br>
    `(alpha;beta) = (alpha_1;beta_1)(alpha_2;beta_2)cdots(alpha_n;beta_n)`,<br>
    `x^alpha = x_1^(alpha_1) x_2^(alpha_2) cdots x_n^(alpha_n)`,
  </span>
  有了这套多重指标的记号, 就可大大简化我们的书写. 设 `|alpha| = k`, `n` 元数量函数 `f` 在定义域上 `k` 次可微, 则 `f` 直到 `k` 阶的偏导数都与求导次序无关, 可以简记
  <span class="formula">
    `del^alpha = (del^|alpha|)/(del x_1^(alpha_1) cdots del x_n^(alpha_n))`
  </span>
</p>

<p class="example">
  <b>多重二项公式</b>
  <span class="formula">
    `(x + y)^alpha = sum_(beta le alpha) (alpha; beta) x^(alpha-beta) y^beta`,
  </span>
  其中 `x, y in RR^n`, `alpha, beta` 是 `n` 重指标.
</p>

<p class="proof">
  左边等于
  <span class="formula">
    `(x_1+y_1)^(alpha_1) cdots (x_n+y_n)^(alpha_n)`
    `= sum_(beta_1 le alpha_1) (alpha_1;beta_1)x_1^(alpha_1-beta_1) y_1^(beta_1) cdots sum_(beta_n le alpha_n) (alpha_n;beta_n)x_n^(alpha_n-beta_n) y_n^(beta_n)`
    `= sum_(beta_1 le alpha_1) cdots sum_(beta_n le alpha_n) (alpha_1;beta_1) cdots (alpha_n;beta_n) x_1^(alpha_1-beta_1) cdots x_n^(alpha_n-beta_n) y_1^(beta_1) cdots y_n^(beta_n)`
  </span>
  等于右边.
</p>

<ol class="example">
  用 `epsi_i` 表示第 `i` 个分量为 1, 其余分量都为 0 的 `n` 重指标,
  用 `0` 表示各分量全为 0 的 `n` 重指标, 则
  <li>`|epsi_i| = 1`; 若 `alpha le epsi_i`, 则 `alpha = epsi_i` 或 `alpha = 0`;</li>
  <li>Pascal 恒等式 `(alpha-epsi_i;beta-epsi_i) + (alpha-epsi_i;beta) = (alpha; beta)`.</li>
</ol>

<p class="example">
  <b>Leibniz 公式</b>
  <span class="formula">
    `del^alpha(f g) = sum_(beta le alpha) (alpha;beta) del^(alpha-beta) f del^beta g`.
  </span>
</p>

<p class="proof">
  对 `|alpha|` 进行归纳. 若 `|alpha| = 1`, 由乘积的求导法则知结论成立;
  现在设 `|alpha| gt 1`, `epsi_i le alpha`, 记 `gamma = alpha-epsi_i`,
  则左边等于
  <span class="formula">
    `del^(epsi_i) del^gamma(f g)`
    `= del^(epsi_i) sum_(beta le gamma) (gamma;beta) del^(gamma-beta) f del^beta g`
    `= sum_(beta le gamma) (alpha-epsi_i;beta) del^(alpha-beta) f del^beta g`
    `+ sum_(epsi_i le beta le alpha) (alpha-epsi_i;beta-epsi_i) del^(alpha-beta) f del^beta g`
  </span>
  等于右边.
</p>

<h3>多元 Taylor 公式</h3>

<p class="theorem">
  <span class="formula">
    `f(x) = sum_(|alpha| le n) 1/alpha! del^alpha f(x) h^alpha + R_(n+1)`<br>
    `= sum_(k le n) 1/k! (h * grad)^k f(a) + R_(n+1)`
  </span>
  其中余项有三种形式:
  <span class="formula">
    `R_(n+1) = sum_(|alpha| = n+1) 1/alpha! del^alpha f(a + theta h) h^alpha`
    `= 1/(n+1)! (h * grad)^(n+1) f(a + theta h)`,
    `theta in (0, 1)`
    <span class="label">(Lagrange 余项)</span>
  </span>
  <span class="formula">
    `R_(n+1) = sum_(|alpha| = n+1) (n+1) h^alpha/alpha! int_0^1 (1-t)^n del^alpha f(a + t h) dt`
    `= 1/n! int_0^1 (1-t)^n (h * grad)^(n+1) f(a + t h) dt`
    <span class="label">(积分余项)</span>
  </span>
  <span class="formula">
    `R_(n+1) = O(|h|^(n+1))`
    <span class="label">(Peano 余项)</span>
  </span>
</p>

<script src="../../js/note.js?type=math"></script>
</body>
</html>
