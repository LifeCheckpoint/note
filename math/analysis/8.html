<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <title>特殊函数 (1): Gamma 函数, Euler 和, 指对数积分</title>
  <meta charset="utf-8" />
  <link rel="stylesheet" type="text/css" href="../../css/note.css" />
</head>
<body>

<h2>Euler 积分</h2>

<h3>第一类 Euler 积分: Beta 函数</h3>

<span class="formula">
	`B(p, q) = int_0^1 x^(p-1) (1-x)^(q-1) dx`.
</span>

<p class="property">
	`0`, `1` 是 Beta 函数积分的瑕点; `B(p, q)` 在 `p, q gt 0` 时收敛.
</p>

<p class="property">
	<b>对称性</b>
	作区间再现 `x mapsto 1-x` 可得 `B(p, q) = B(q, p)`.
</p>

<p class="property">
	<b>递推公式</b>
	`B(p+1, q) = p/(p+1) B(p, q)`.
</p>

<p class="proof">
	分部积分,
	<span class="formula align">
      `B(p+1, q)`
      `= -1/q x^p (1-x)^q |_0^1 + p/q int_0^1 (1-x)^q x^(p-1) dx`<br>
      `= p/q (int_0^1 (1-x)^(q-1) x^(p-1) dx - int_0^1 (1-x)^(q-1) x^p dx)`<br>
      `= p/q (B(p, q) - B(p+1, q))`.
	</span>
	移项整理即得结论.
</p>

<p class="corollary">
  `p, q` 为非负整数时,
  <span class="formula">
    `B(p, q) = ((p-1)! (q-1)!)/((p+q-1)!)`.
  </span>
  下文将证明一般的公式
  <span class="formula">
    `B(p, q) = (Gamma(p) Gamma(q))/(Gamma(p+q))`.
  </span>
</p>

<ol class="property">
	<b>Beta 函数的其它形式</b>
	<li>令 `x = sin^2 theta`, 则
    <span class="formula">
      `B(p, q) = 2 int_0^(pi//2) sin^(2p-1) theta
      cos^(2q-1) theta "d"theta`.
    </span>
	</li>
	<li>令 `x = t/(1+t)`, 则
    <span class="formula">
      `B(p, q) = int_0^oo t^(p-1)/(1+t)^(p+q) dt`.
    </span>
	</li>
</ol>

<p class="example">
  在 Beta 函数的表达式中取 `p = s`, `q = 1-s` 得
  <span class="formula">
    `B(s, 1-s) = int_0^oo t^(s-1)/(1+t) dt`.
  </span>
  由后面的余元公式知道这个积分的值为 `pi/sin(pi s)`.  推论:
  <span class="formula">
    `int_0^oo t^(s-1)/(x+t) dt = x^(s-1) pi/sin(pi s)`,<br>
    `int_0^oo t^(s-1)/(x^2+t^2) x dt = x^(s-1) (pi//2)/sin(pi s//2)`,<br>
    `int_0^oo t^(s-1) ln(1+1/t) dt = 1/s pi/sin(pi s)`.
  </span>
</p>

<p class="example">
  <b>点火公式</b>
	给出 Beta 函数在半整数点的取值: 对非负整数 `m, n`,
  <span class="formula">
    `1/2 B((m+1)/2, (n+1)/2)`
    `= int_0^(pi/2) sin^m x cos^n x dx`
    `= ((m-1)!!(n-1)!!)/((m+n)!!) * s`,
  </span>
  其中 `m, n` 都为偶数时 `s = pi//2`, 否则 `s = 1`.
  特别取 `m = 0` 得
  <span class="formula">
    `I_n = int_0^(pi/2) sin^n x dx`
    `= int_0^(pi/2) cos^n x dx`
    `= ((n-1)!!)/(n!!) * s`.
  </span>
</p>

<p class="solution">
	利用第 6 章的<a href="6.html#exp-int-sin-n-x">例题</a>, 容易得到
  `I_n = (n-1)/n I_(n-2)`; 而 `I_0 = pi/2`, `I_1 = 1`, 即得到上面的结论.
</p>

<p class="example" id="for-wallis">
	<b>Wallis 公式</b>
  `lim_(n to oo) {:(2n)!!:}^2/((2n-1)!!(2n+1)!!) = pi/2`.
	尽管只有乘除法因而计算简便, 但 Wallis 公式的收敛速度不快,
	不适合直接用来计算 `pi`.
</p>

<p class="proof">
  利用
	<span class="formula">
		`sin^(2n+1) x le sin^(2n) x le sin^(2n-1) x`, `quad 0 le x le
		pi/2`,
	</span>
	在 `[0, pi//2]` 积分得
	<span class="formula">
		`((2n)!!)/((2n+1)!!) le ((2n-1)!!)/((2n)!!) pi/2 le ((2n-2)!!)/((2n-1)!!)`.
	</span>
	于是
	<span class="formula">
    `pi/2 (2n)/(2n+1) le {:(2n)!!:}^2/((2n-1)!!(2n+1)!!) le pi/2`.
	</span>
	由两边夹法则立即得到结论.
</p>

<h3>第二类 Euler 积分: Gamma 函数</h3>

<div class="img fit" title="Gamma 函数">
  <canvas id="img-gamma" width="300" height="400"></canvas>
</div>

<span class="formula">
  `Gamma(s) = int_0^oo x^(s-1) "e"^-x dx`.
</span>

<p class="remark">
  记忆: Mellin 变换定义为
  <span class="formula">
    `cc M[f(x)] = int_0^oo x^(s-1) f(x) dx`,
  </span>
  于是 `Gamma(s) = cc M["e"^-x]`, `B(p, q) = cc M[(1+x)^(-p-q)]`.
</p>

<p class="property">
	`Gamma(s)` 在 `s gt 0` 时收敛, 可在积分号下求任意阶导数:
	<span class="formula">
		`Gamma^((n))(s) = int_0^oo x^(s-1) "e"^-x ln^n x dx`.
	</span>
</p>

<p class="property">
	<b>函数方程</b>
	<span class="formula">
		`Gamma(s+1) = s Gamma(s)`.
	</span>
  特别 `n` 为非负整数时,
  <span class="formula">
    `Gamma(n+1) = n!`.
  </span>
	利用函数方程, Gamma 函数的定义域可推广到除零和负整数外的所有实数:
	<span class="formula">
		`Gamma(s) = (Gamma(s+n+1))/(s(s+1)cdots(s+n))`.
	</span>
</p>

<p class="proof">
	分部积分,
	<span class="formula">
    `Gamma(s+1)`
    `= int_0^oo x^s "e"^-x dx`
    `= -x^s "e"^-x |_0^oo + s int_0^oo x^(s-1) "e"^-x dx`
		`= s Gamma(s)`.
	</span>
</p>

<p class="remark">
  Bohr-Mollerup 定理指出, 满足上述函数方程的所有函数中, 只有 Gamma
  函数是对数凸的, 即 `ln Gamma (z)` 是凸函数.
</p>

<p class="corollary">
	令 `x = t^2` 得到:
	<span class="formula">
		`Gamma(s) = 2 int_0^oo "e"^(-t^2) t^(2s-1) dt`.
	</span>
	利用 Euler-Poisson 积分知 `Gamma(1/2) = sqrt pi`,
  再由函数方程递推可得 Gamma 函数在半整数点的取值:
	<span class="formula">
		`Gamma((2n+1)/2) = ((2n-1)!!)/2^n sqrt pi`.
	</span>
</p>

<p class="example">
	`I_n = int_(-oo)^oo "e"^(-x^2) x^n dx`
	`= { 0, if n" is odd"; Gamma((n+1)/2), if n" is even" :}`
</p>

<p class="solution">
	`n` 是奇数时, 被积函数为奇函数, 积分为零;
	`n` 是偶数时, 被积函数为偶函数, 利用 Gamma 函数的变化形式知
	`I_n = Gamma((n+1)/2)`.
	(也可以利用第 6 章的<a href="6.html#exp-possion-integral">这个例题</a>).
</p>

<p class="property">
	<b>Dirichlet 公式</b>
	`B(p, q) = (Gamma(p)Gamma(q))/(Gamma(p+q))`.
</p>

<p class="proof">
	应用 Gamma 函数与 Beta 函数的变化形式, 并在极坐标下积分:
	<span class="formula align">
      `Gamma(p) Gamma(q)`
      `= 4 int_0^oo "e"^(-x^2) x^(2p-1) dx
      int_0^oo "e"^(-y^2) y^(2q-1) dy`<br>
      `= 4 int_0^oo int_0^oo "e"^-(x^2+y^2) x^(2p-1) y^(2q-1) dx dy`<br>
      `= 4 int_0^(pi//2) cos^(2p-1) theta sin^(2q-1) theta "d"theta`
      `int_0^oo "e"^(-r^2) r^(2p+2q-1) "d"r`<br>
      `= B(p, q) Gamma(p+q)`.
	</span>
</p>

<h3>Gamma 函数的乘积表示</h3>

<p class="property">
	<b>Euler-Gauss 乘积公式</b>
	<span class="formula">
		`Gamma(s) = lim_(n to oo) (n^s n!)/(s(s+1) cdots (s+n))`.
	</span>
  使用 Gauss 的记号 `Pi(s) = Gamma(s+1)`,
	此结论简记为 `Pi(s+n) // Pi(n) ~ n^s`.
</p>

<p class="proof">
  只需证 `Gamma(s) = lim_(n to oo) n^s B(s, n+1)`:
	<span class="formula">
		`Gamma(s) = int_0^oo "e"^-t t^(s-1) dt`
		`overset ? = lim_(n to oo) int_0^n (1-t/n)^n t^(s-1) dt`
		`= lim_(n to oo) n^s int_0^1 (1-u)^n u^(s-1) "d"u`
		`= lim_(n to oo) n^s B(s, n+1)`.
	</span>
	下面证明问号处的等式. 考虑
	<span class="formula">
		`|int_0^oo "e"^-t t^(s-1) dt - int_0^n (1-t/n)^n t^(s-1) dt|`
		`le |int_0^oo ["e"^-t - (1-t/n)^n] t^(s-1) dt|`
		`+ |int_n^oo (1-t/n)^n t^(s-1) dt|`.
	</span>
	先看第一项. 由于
	<span class="formula">
		`ln (1-t/n)^n`
		`= n ln(1-t/n)`
		`= n (-t/n + O(1/n^2))`
		`= -t + O(1/n)`,
	</span>
	从而
	<span class="formula">
		`"e"^-t-(1-t/n)^n`
		`= "e"^-t(1-"e"^(O(1/n)))`
		`= "e"^-t O(1/n)`.
	</span>
	第一项等于
	<span class="formula">
		`|O(1/n) int_0^oo "e"^-t t^(s-1) dt|`
		`= O(1/n) Gamma(s) to 0`.
	</span>
	再看第二项, 由均值不等式
	<span class="formula">
		`root(n+1)((1-t/n)^n)`
		`le (n-t+1)/(n+1)`
		`= 1-t/(n+1)`
	</span>
	知道, 数列 `(1-t/n)^n` 单调递增趋于 `"e"^-t`, 即 `"e"^-t`
	是它的一个上界. 从而第二项小于等于
	<span class="formula">
		`|int_n^oo "e"^-t t^(s-1) dt|`,
	</span>
	它是收敛的 Gamma 积分的尾部, 因此当 `n to oo` 时上式趋于零.
	综上有
	<span class="formula">
		`|int_0^oo "e"^-t t^(s-1) dt - int_0^n (1-t/n)^n t^(s-1) dt|`
		`to 0`.
	</span>
</p>

<p class="proof">
	只需证
	<span class="formula">
		`lim_(n to oo) (n!)/(Gamma(s+n+1)) n^s = 1`.
	</span>
	用 Striling 公式, 上式左边等于
	<span class="formula">
		`lim_(n to oo) (sqrt n (n/"e")^n)/(sqrt(s+n) ((s+n)/"e")^(s+n)) n^s`
		`= lim_(n to oo) ("e"^s)/(1+s/n)^n (n/(s+n))^(s+1/2) = 1`.
	</span>
</p>

<p class="theorem">
  <b>Gamma 函数的解析延拓</b>
  乘积公式右边的极限, 只要分母不为零, 对任意复数 `s` 都收敛.
  因此借助此公式, 可以将 `Gamma(s)` 的定义拓展到复平面上,
  `s != 0, -1, -2, cdots`. `Gamma(s)` 没有零点, 它的倒数
  `1/(Gamma(s))` 在 `CC` 上解析.
</p>

<p class="proof">
  用 `(n+1)^s` 等价代替乘积公式的 `n^s`, 记
  <span class="formula">
    `f(n) = (n!)/(s(s+1)cdots(s+n)) (n+1)^s`,
  </span>
  将公式写为无穷乘积
  <span class="formula">
    `Gamma(s) = f(0) prod_(n ge 1) (f(n))/(f(n-1))`
    `= 1/s prod_(n ge 1) n/(s+n) ((n+1)/n)^s`
    `= 1/s prod_(n ge 1) (1+s/n)^-1 (1+1/n)^s`.
  </span>
  (收敛性的说明??)
</p>

<p class="theorem">
  <b>Weierstrass 公式</b>
  <span class="formula">
    `1/(Gamma(s)) = "e"^(gamma s) s prod_(n ge 1) (1+s/n) "e"^(-s/n)`.
  </span>
  `gamma` 为 Euler-Mascheroni 常数.
</p>

<p class="proof">
    利用乘积公式, 左边等于
    <span class="formula">
        `lim_(n to oo) (s(s+1)cdots(s+n))/(n^s n!)`
        `= lim_(n to oo) "e"^(-s ln n) * s prod_(1 le k le n) (1 + s/k)`
        `= lim_(n to oo) "e"^(s (gamma - H_n)) * s prod_(1 le k le n) (1 + s/k) =` 右边.
    </span>
</p>

<p class="property">
	<b>余元公式</b>
  `Gamma(s) Gamma(1-s) = pi/(sin pi s)`.
  这是复变量正弦函数的乘积公式.
</p>

<p class="proof">
	利用乘积公式有
  <span class="formula">
    `Gamma(1+s) Gamma(1-s)`
    `= lim_(n to oo) n^s/((1+s)(1+s/2) cdots (1+s/n))`
    `n^(1-s)/((1-s)(1-s/2) cdots (1-s/n)) 1/(n+s)`
    `= lim_(n to oo) n/(n+s) prod_(k=1)^n (1-s^2/k^2)^-1`.
  </span>
  再用 Euler 无穷乘积公式
	<span class="formula">
		`prod_(n=1)^oo (1-s^2/n^2) = (sin pi s)/(pi s)`
	</span>
	即得结论.
</p>

<p class="proof">
  [来自 无懈可击99]
  我们通过计算下面的积分来证明余元公式:
	<span class="formula">
		`Gamma(s) Gamma(1-s)`
		`= B(s, 1-s) Gamma(1)`
		`= int_0^oo x^(s-1)/(1+x) dx`.
  </span>
  积分写为 `int_0^1 + int_1^oo`, 第二项作倒代换 `x mapsto 1//x` 得
  <span class="formula">
    `int_0^1 (x^(s-1) + x^-s)/(1+x) dx`.
  </span>
  用几何级数展开为
  <span class="formula align">
    `int_0^1 (x^(s-1) + x^-s) sum_(n ge 0) (-x)^n dx`<br>
    `= sum_(n ge 0) (-1)^n int_0^1 (x^(s-1) + x^-s) x^n dx`<br>
    `= sum_(n ge 0) (-1)^n (1/(n+s) + 1/(n-s+1))`<br>
    `= 1/s + sum_(n ge 1) (-1)^n (1/(n+s) - 1/(n-s))`<br>
    `= 1/s - 2s sum_(n ge 1) (-1)^n 1/(n^2-s^2)`.
  </span>
  比较 `cos s x` 的 Fourier 展式
  <span class="formula">
    `cos s x = (sin pi s)/pi (1/s - 2s sum_(n ge 1) (-1)^n (cos
    n x)/(n^2-s^2))`
  </span>
  就得到结论.
</p>

<ol class="property">
	<b>Gauss-Legendre 倍元公式</b>
	<li>`Gamma(x) Gamma(x+1/2) = (Gamma(2x))/2^(2x) 2 sqrt pi`;</li>
	<li>`prod_(0 le k lt n) Gamma(x+k/n) = (Gamma(n x))/n^(n x) sqrt n (2pi)^((n-1)/2)`.</li>
    令 `x = z + b//n` 得
    <span class="formula">
        `Gamma(n z + b) = n^(n z+b-1//2) (2pi)^((1-n)//2) prod_(0 le k lt
        n) Gamma(z + (b+k)/n)`.
    </span>
</ol>

<ol class="proof">
	<li>由于
		<span class="formula">
			`Gamma(m + 3/2)`
			`= Gamma((2m+3)/2)`
			`= (2m+1)/2 (2m-1)/2 cdots 3/2 1/2 Gamma(1/2)`
			`= ((2m+1)!)/(2^(2m+1) m!) sqrt pi`,
		</span>
		即 `(m! 2^(2m+1))/((2m+1)!) = sqrt pi /(Gamma(n+3/2)`.
		利用 Gamma 函数的 Euler 乘积表示进行计算, 我们有
		<span class="formula">
		`{:
			 , Gamma(x) Gamma(x+1/2);
       ~, (m^(2x+1/2) {:m!:}^2)/(x(x+1/2) cdots (x+m)(x+m+1/2)) quad (m to oo);
       ~, (m^(2x+1/2) {:m!:}^2 2^(2m+2))/(2x(2x+1)cdots(2x+2m+1));
       ~, (Gamma(2x))/((2m+1)^(2x)(2m+1)!) m^(2x+1/2) {:m!:}^2 2^(2m+2);
			~, (Gamma(2x))/2^(2x) (2 sqrt m m! sqrt pi)/(Gamma(n+1+1/2));
			~, (Gamma(2x))/2^(2x) 2 sqrt pi.
		:}`
		</span>
	</li>
	<li>利用三角恒等式
		<span class="formula">
			`prod_(0 lt k lt n) sin{:(k pi)/n:} = (2n)/2^n`.
		</span>
		由余元公式有
		<span class="formula">
			`prod_(0 lt k lt n) Gamma(k/n)`
			`= sqrt(prod_(0 lt k lt n) Gamma(k/n) Gamma(1-k/n))`
			`= sqrt(pi^(n-1)/(prod_(0 lt k lt n) sin{:(k pi)/n:}))`
			`= (2pi)^((n-1)/2) / sqrt n`,
		</span>
		计算
		<span class="formula">
			`prod_(0 le k lt n) Gamma(m+1+k/n)`
			`= m! prod_(0 lt k lt n) (m n+k)/n ((m-1)n+k)/n cdots (n+k)/n k/n Gamma(k/n)`
			`= ((n m+n-1)!)/n^(n m+n-1) prod_(0 lt k lt n) Gamma(k/n)`
		</span>
		我们得到
		<span class="formula">
			`n^(n m+n-1)/((n m+n-1)!)
			= (2pi)^((n-1)/2)/(sqrt n prod_(0 le k lt n) Gamma(m+1+k/n))`.
		</span>
		注意 `sum_(0 lt k lt n) k/n = (n-1)/2`, 于是
		<span class="formula">
		`{:
			,prod_(0 le k lt n) Gamma(x+k/n);
      ~, lim_(m to oo) (m^(n x + (n-1)/2) {:m!:}^n) / (x(x+1/n) cdots (x
			+ m + (n-1)/n)) quad (m to oo);
      ~, (m^(n x + (n-1)/2) {:m!:}^n n^(n(m+1))) / (n x(n x+1) cdots (n
			x+ n m + n - 1));
			~, (Gamma(n x))/((n m+n-1)^(n x) (n m+n-1)!) m^(n x+(n-1)/2)
      {:m!:}^n n^(n(m+1));
      ~, (Gamma(n x))/n^(n x) {:m!:}^n sqrt n (2pi m)^((n-1)/2)
			/( prod_(0 le k lt n) Gamma(m+1+k/n));
			~, (Gamma(n x))/n^(n x) sqrt n (2pi)^((n-1)/2).
		:}`
		</span>
	</li>
</ol>

<p class="example">
  <b>Raabe 积分</b> [来自 积分的方法与技巧]
  <span class="formula">
    `R(a) = int_a^(a+1) ln Gamma(x) dx`
    `= a(ln a - 1) + ln sqrt(2pi)`.
  </span>
</p>

<p class="proof">
  对参数 `a` 求导,
  <span class="formula">
    `R'(a) = ln Gamma(a+1) - ln Gamma(a) = ln a`.
  </span>
  区间再现, 利用余元公式
  <span class="formula">
    `R(0) = int_0^1 ln Gamma(x) dx`
    `= 1/2 int_0^1 ln Gamma(x) Gamma(1-x) dx`
    `= 1/2 int_0^1 ln{:pi/(sin pi x):} dx`
    `= 1/2 ln pi - 1/(2 pi) int_0^pi ln sin x dx`
    `= 1/2 ln pi + 1/2 ln 2`.
  </span>
  最后
  <span class="formula">
    `R(a) = int_0^a R'(x) dx + R(0)`
    `= a(ln a - 1) + ln sqrt(2pi)`.
  </span>
</p>

<ol class="example">
	<li>`1 - 1/(n!) int_0^n t^n "e"^-t dt = "e"^-n sum_(k=0)^n n^k/(k!)`;
	</li>
	<li>(Dobiński 公式) `n to oo` 时上式两边趋于 `1/2`.</li>
</ol>

<ol class="proof">
	<li>一种做法是对左边反复分部积分. 第二种做法从右边出发,
		利用 gamma 函数定义及二项式定理有
		<span class="formula">
			`"e"^-n sum_(k=0)^n n^k/(k!)`
			`= "e"^-n/(n!) sum_(k=0)^n (n;k) n^k (n-k)!`
			`= "e"^-n/(n!) sum_(k=0)^n (n;k) n^k int_0^oo t^(n-k) "e"^-t
			dt`
			`= "e"^-n/(n!) int_0^oo (n+t)^n "e"^-t dt`
			`= 1/(n!) int_n^oo t^n "e"^-t dt`
			`= 1 - 1/(n!) int_0^n t^n "e"^-t dt`.
		</span>
	</li>
	<li>利用等式
		<span class="formula">
			`sum_(k=0)^n n^k/(k!) = sum_(k=0)^n (k^k (n-k)^(n-k))/(k!
			(n-k)!)`, (规定 `0^0 = 1`) (??)
		</span>
		有
		<span class="formula">
			`lim_(n to oo) "e"^-n sum_(k=0)^n n^k/(k!)`
			`= lim_(n to oo) "e"^-n sum_(k=1)^(n-1) ("e"^k
			"e"^(n-k))/(sqrt(2pi k) sqrt(2pi(n-k)) O(1+1/k) O(1+1/(n-k)))`
			`= lim_(n to oo) 1/(2 pi n) sum_(k=1)^(n-1) 1/sqrt(k/n
			(1-k/n))`
			`= 1/(2pi) int_0^1 dx/sqrt(x(1-x))`
			`= 1/(2pi) (Gamma(1/2)^2)/(Gamma(1)) = 1/2`.
		</span>
	</li>
</ol>

<p class="proof">
	2. 的另一证法. 设 `X_1, X_2, cdots, X_n` 独立服从参数为 1 的 Poisson
	分布, 则 `X = X_1 + X_2 + cdots + X_n` 服从参数为 `n` 的 Poisson 分布.
	<span class="formula">
		`P{X le n} = "e"^-n sum_(k=0)^n n^k/(k!)`.
	</span>
	令 `n to oo`, 由中心极限定理
	<span class="formula">
		`(X-n)/sqrt n to Z`, `quad Z ~ N(0, 1)`,
	</span>
	于是 `P{X le n} to P{Z le 0} = 1/2`.
</p>

<h3>Digamma 函数</h3>

<p class="definition">
	Gamma 函数的对数的导数称为 <b>digamma 函数</b>:
	<span class="formula">
		`psi(s) = "d"/("d"s) ln Gamma(s)`
		`= (Gamma'(s))/(Gamma(s))`,
    `quad s gt 0`.
	</span>
	digamma 函数的高阶导数 `psi^((n))` 称为 polygamma 函数.
</p>

<ol class="proposition">
  <li>函数方程 `psi(s+1) = psi(s) + 1//s`;</li>
  <li>余元公式 `psi(1-s) - psi(s) = pi cot pi s`;</li>
  <li>倍元公式 [来自群友 d]
    `psi(n s) = 1/n sum_(k=0)^(n-1) psi(s + k/n) + ln n`.
  </li>
  <li>级数表示 `psi(s+1) = -gamma + sum_(n ge 1) (1/n - 1/(n+s))`;
    特别 `psi(n+1) = -gamma + H_n`.
  </li>
  <li>高阶导数 `psi^((n))(s) = sum_(k ge 0) (n!(-1)^(n+1))/(k+s)^(n+1)`;
    特别 `psi` 在 1 附近有 Taylor 展开
    <span class="formula">
      `psi(s+1) = -gamma + sum_(n ge 1) (-1)^(n+1) zeta(n+1) s^n`.
    </span>
  </li>
  <li>极限表示 `psi(a) = lim_(b to oo) [Gamma(b) - B(a, b)]`.</li>
  <li>积分表示 [来自 积分的方法与技巧]
    <span class="formula">
      `psi(s) = int_0^oo ("e"^-x - (1+x)^-s) dx/x`
      `= int_0^oo (("e"^-x)/x - "e"^((1-s)x)/("e"^x-1)) dx`.
    </span>
    特别 `int_0^oo ("e"^-x/x - "e"^(-x)/(1-"e"^-x)) dx = psi(1) = -gamma`.
  </li>
</ol>

<ol class="proof">
  <li>
		`psi(s+1) = "d"/("d"s) ln Gamma(s+1)`
		`= "d"/("d"s)(ln s + ln Gamma(s))`
		`= 1/s + psi(s)`.
  </li>
  <li>由 Gamma 函数的余元公式取对数再求导即可.</li>
  <li>由 Gamma 函数的倍元公式取对数再求导即可.</li>
  <li>由函数方程
    <span class="formula">
      `psi(n+1) = psi(1) + sum_(k=1)^n 1/k = psi(1) + H_n`.
    </span>
    为求出 `psi(1)`, 使用 Weierstrass 公式:
    <span class="formula">
      `ln Gamma(s) = -gamma s - ln s + sum_(n ge 1)(s/n - ln(1+s/n))`,
      <br/>
      `psi(s) = -gamma - 1/s + sum_(n ge 1)(1/n - 1/(n+s))`,<br/>
      即 `psi(s+1) = -gamma + sum_(n ge 1)(1/n - 1/(n+s))`.
    </span>
    因此 `psi(1) = -gamma`.<br/>
    从另一角度, 交换积分与求和,
    <span class="formula">
        `int_0^1 sum_(n ge 1) (1/n - 1/(n+s)) "d"s`
        `= sum_(n ge 1) (1/n - ln(1+1/n))`
        `= lim_(n to oo) H_n - ln(n+1)`
        `= gamma`.
    </span>
    但 `int_0^1 psi(s+1) "d"s = ln Gamma(2) - ln Gamma(1) = 0`,
    两式相减, 再次印证了 `psi(1) = -gamma`.
  </li>
  <li>直接求导即可.</li>
  <li>
    <span class="formula">
      `Gamma(b) - B(a, b)`
      `= Gamma(b)(1 - (Gamma(a))/(Gamma(a+b)))`
      `= (Gamma(b+1))/(Gamma(a+b)) (Gamma(a+b) - Gamma(a))/b`,
    </span>
    令 `b to 0` 即得 `(Gamma'(a))/(Gamma(a)) = psi(a)`.
  </li>
  <li>将 Gamma 函数与 Beta 函数的积分形式代入上题的极限表示,
    <span class="formula">
      `psi(s) = lim_(h to 0) int_0^oo ("e"^-x - (x+1)^(-s-h)) x^(h-1) dx`
      `= int_0^oo ("e"^-x - (x+1)^-s) dx/x`.
    </span>
    第二项令 `1 + x = "e"^y` 就得到第二个积分.
  </li>
</ol>

<h3>Stirling 公式</h3>

<p>	下文推导阶乘函数的 Stirling 公式, 为此先证明一个 (冗长但实用的) 引理.</p>

<p class="lemma">
	<b>Laplace 方法</b>
	设 `f in C^2[a,b]`.  `x_0 in (a,b)` 是 `f` 唯一的极大值点, `f''(x_0)
	= -lambda lt 0`, 则
	<span class="formula">
		`int_a^b "e"^(M f(x)) dx\ ~\ "e"^(M f(x_0)) sqrt((2pi)/(M lambda))`,
		`quad M to oo`.
	</span>
	这意味着 `"e"^(M f(x))` 在整个区间上的积分值几乎都集中在 `x_0` 附近,
	且可以用 `f` 的二阶 Taylor 展开
	<span class="formula">
		`int_(-oo)^oo "e"^(M f(x_0) - M lambda(x-x_0)^2/2) dx`
	</span>
	来估计.
</p>

<p class="proof">
	将 `f` 在 `x_0` 处展开, 因为是极大值点, `f'(x_0) = 0`, 有
	<span class="formula">
		`f(x) = f(x_0) + f''(x_0+theta(x-x_0)) (x-x_0)^2/2`.
	</span>
	由二阶导数连续, 对任意 `epsi gt 0`, 当 `x` 与 `x_0` 充分接近时,
	<span class="formula">
		`f''(x_0)-epsi le f''(x_0+theta(x-x_0)) le f''(x_0)+epsi`,
	</span>
	从而
	<span class="formula">
		`f(x_0) - (lambda+epsi) (x-x_0)^2/2`
		`le f(x)`
		`le f(x_0) - (lambda-epsi) (x-x_0)^2/2`.
	</span>
	取 `delta gt 0` 充分小. 一方面, 注意到 `int_(-oo)^oo "e"^(-y^2/2) dy
	= sqrt (2pi)`, 有
	<span class="formula">
		`int_a^b "e"^(M f(x)) dx`
		`ge int_(x_0-delta)^(x_0+delta)
		"e"^(M f(x_0)-M(lambda+epsi)(x-x_0)^2/2) dx`
		`= int_(-delta sqrt(M(lambda+epsi)))^(delta sqrt(M(lambda+epsi)))
		"e"^(M f(x_0) - y^2/2)/sqrt(M(lambda+epsi)) dy`
		`~ "e"^(M f(x_0)) sqrt((2pi)/(M(lambda+epsi)))`;
	</span>
	另一方面, 由 `x_0` 是唯一的极大值点知, 存在 `eta gt 0` 使得
	<span class="formula">
		`f(x) le f(x_0)-eta`, `quad |x-x_0| ge delta`.
		<span class="label" id="for-eta-condition"></span>
	</span>
	不妨设 `lambda-epsi gt 0`, 得到
	<span class="formula">
		`int_a^b "e"^(M f(x)) dx`
		`= int_a^(x_0-delta) + int_(x_0-delta)^(x_0+delta)
		+ int_(x_0+delta)^b`
		`le (b-a)"e"^(M(f(x_0)-eta)) + int_(x_0-delta)^(x_0+delta)
		"e"^(M f(x_0)-M(lambda-epsi)(x-x_0)^2/2) dx`
		`~ "e"^(M f(x_0)) ((b-a)"e"^(-M eta) + sqrt((2pi)/(M(lambda-epsi))))`
		`~ "e"^(M f(x_0)) sqrt((2pi)/(M(lambda-epsi)))`.
	</span>
	令 `epsi to 0`, 由两边夹法则即得结论.
</p>

<p class="remark">
	若 `[a, b]` 是无限区间, 要使引理成立, 还需两个充分条件. 一是满足条件
	<a class="ref" href="#for-eta-condition"></a> 的 `eta` 存在,
	二是存在 `M_0 gt 0`, 使得 `int_a^b "e"^(M_0 f(x)) dx lt oo`.
	此时有
	<span class="formula">
		`int_a^(x_0-delta) "e"^(M f(x)) dx + int_(x_0+delta)^b "e"^(M
		f(x)) dx`
		`le int_a^b "e"^(M_0 f(x)) "e"^((M-M_0) f(x)) dx`
		`le int_a^b "e"^(M_0 f(x)) "e"^((M-M_0) (f(x_0)-eta)) dx`
		`= O("e"^((M-M_0) (f(x_0)-eta)))`,
	</span>
	代入前面的证明, 得到相同的结果.
</p>

<p class="theorem">
	<b>Stirling 公式</b> `n! ~ sqrt(2pi n) (n/"e")^n`, `quad n to oo`.
</p>

<p class="proof">
	利用 Gamma 函数,
	<span class="formula">
		`n! = Gamma(n+1)`
		`= int_0^oo "e"^(-t) t^n dt`
		(令 `t = n x`)
		`= n^(n+1) int_0^oo "e"^(-n x) x^n dx`
		`= n^(n+1) int_0^oo "e"^(n(ln x-x)) dx`.
	</span>
	应用 Laplace 方法, 其中
	<span class="formula">
		`f(x) = ln x-x`, `quad f'(x) = 1/x-1`, `quad f''(x)
		  = -1/x^2`,<br/>
		`f'(1) = 0`, `quad f(1) = f''(1) = -1`.
	</span>
	有
	<span class="formula">
		`n! ~ n^(n+1) "e"^-n sqrt((2pi)/n)`
		`= sqrt(2pi n) (n/"e")^n`.
	</span>
</p>

<h2>Riemann zeta 函数</h2>

<table>
  <tr>
    <td>Riemann zeta 函数</td>
    <td>`zeta(s) = sum_(n ge 1) 1/n^s`</td>
  </tr>
  <tr>
    <td>Dirichlet eta 函数</td>
    <td>`eta(s) = sum_(n ge 1) (-1)^(n+1)/n^s` `= (1-2^(1-s)) zeta(s)`</td>
  </tr>
  <tr>
    <td>Dirichlet beta 函数</td>
    <td>`beta(s) = sum_(n ge 0) (-1)^n/(2n+1)^s`</td>
  </tr>
</table>

<p class="theorem">
  <b>积分表达式</b>
  [来自 论文哥] 对 `s gt 0` 有
  <span class="formula">
    `zeta(s) Gamma(s) = int_0^oo x^(s-1)/("e"^x-1) dx`,<br>
    `eta(s) Gamma(s) = int_0^oo x^(s-1)/("e"^x+1) dx`,<br>
    `eta(s) Gamma(s) = int_0^1 int_0^1 [-ln(x y)]^(s-2)/(1+x y) dx dy`,<br>
    `beta(s) Gamma(s) = int_0^1 int_0^1 [-ln(x y)]^(s-2)/(1+x^2 y^2) dx dy`.
  </span>
</p>

<p class="proof">
  记第一个公式右边的积分为 `I`. 化为几何级数并逐项积分有
  <span class="formula">
    `I = int_0^oo x^(s-1) sum_(n ge 1) "e"^(-n x) dx`
    `= sum_(n ge 1) 1/n^s int_0^oo t^(s-1) "e"^-t dt`
    `= zeta(s) Gamma(s)`.
  </span>
  第二个公式的证明类似.
</p>

<p class="theorem">
  <b>函数方程</b>
  <span class="formula">
    `zeta(1-s) = 2/(2pi)^s cos{:(pi s)/2:} Gamma(s) zeta(s)`,<br>
    `beta(1-s) = (2/n)^s sin{:(pi s)/2:} Gamma(s) beta(s)`.
  </span>
</p>

<h3>Dirichlet beta 函数</h3>

<p class="example" id="exp-lem-beta">
  [来自 壹零叁] `int_0^oo (ln^2 t)/(t^2+1) dt = pi^3/8`.
</p>

<p class="proof">
  取围道 `C = C_1 + C_2 + C_3 + C_4`, 其中
  <span class="formula">
    `C_1: [r, R]`,
    `quad C_2: R "e"^("i"theta), theta in [0, pi]`,<br>
    `C_3: [-R, -r]`,
    `quad C_4: r "e"^(-"i"theta), theta in [pi,2pi]`.
  </span>
  `"i"` 是围道中唯一极点, 故
  <span class="formula">
    `int_C (ln^2 t)/(1+t^2) dt`
    `= 2pi"i" "Res"(t="i")`
    `= 2pi"i" lim_(t to "i") (ln^2 t)/(1+t^2) (t-"i")`
    `= -pi^3/4`.
  </span>
  由长大不等式, 当 `R to oo` 和 `r to 0^+` 时,
  大小两圆弧上积分为零.
  再看 `C_1` 和 `C_3`, 有
  <span class="formula">
    `int_(C_1) to I`,<br>
    `int_(C_3)`
    `to int_-oo^0 (ln^2 t)/(1+t^2) dt`
    `= int_0^oo (ln t + pi"i")^2/(1+t^2) dt`
    `= I + int_0^oo (2 pi "i"ln t - pi^2)/(1+t^2) dt`
    `= I + 0 - pi^3/2`.
  </span>
  综上 `2I - pi^3/2 = -pi^3/4`, `I = pi^3/8`.
</p>

<p class="example">
  记 `I_n = int_0^oo (ln^n t)/(1+t^2) dt`,
  则 `I_奇 = 0`,
  <span class="formula">
    `I_(2n) = (-1)^n E_(2n) (pi/2)^(2n+1)`,
  </span>
  其中 `E_(2n)` 为 Euler 数.
</p>

<p class="proof">
  我们已经计算过 `I_0 = pi/2`, `I_2 = pi^3/8`.
  完全类似计算 `I_2` 的方法, 用留数法可得递推公式
  <span class="formula">
    `I_(2n) + sum_(k=0)^n (2n;2k) I_(2n-2k) (pi "i")^(2k)`
    `= ((pi "i")/2)^(2n) * pi`.
  </span>
  或者, 记 `a_(2n) = (-1)^n/pi^(2n+1) I_(2n)`, 则
  <span class="formula">
    `a_(2n) + sum_(k=0)^n (2n;2k) a_(2k) = 1/2^(2n)`.
  </span>
  两边同乘 `x^(2n)/(2n)!` 并求和, 右边等于 `cosh(x/2)`, 而左边等于
  <span class="formula align">
    `sum_(n ge 0) a_(2n) x^(2n)/(2n)!`
    `+ sum_(n ge 0) sum_(k=0)^n (2n; 2k) a_(2k) x^(2n)/(2n)!`<br>
    `= sum_(n ge 0) a_(2n) x^(2n)/(2n)!`
    `+ sum_(j ge 0) x^(2j)/(2j)! sum_(k ge 0) a_(2k) x^(2k)/(2k)!`<br>
    `= (1 + cosh x) sum_(n ge 0) a_(2n) x^(2n)/(2n)!`.
  </span>
  我们求得 `a_n` 的生成函数
  <span class="formula">
    `sum_(n ge 0) a_(2n) x^(2n)/(2n)!`
    `= cosh(x/2)/(1+cosh x)`
    `= 1/(2 cosh(x/2))`.
  </span>
  而 Euler 数的生成函数为
  <span class="formula">
    `sum_(n ge 0) E_(2n) x^(2n)/(2n)!`
    `= 1/(cosh x)`.
  </span>
  这推出 `a_(2n) = E_(2n)/(2^(2n+1))`.
</p>

<p class="corollary">
  <b>Dirichlet beta 函数的特殊值</b>
  <span class="formula">
    `beta(2k+1) = 1/2 (-1)^k E_(2k)/(2k!) (pi/2)^(2k+1)`,
  </span>
  如 `beta(1) = pi/4`, `beta(3) = pi^3/32` 等等.
</p>

<p class="proof">
  利用结论
  <span class="formula">
    `int_0^1 x^(n-1) ln^m x dx`
    `= (-1)^m m!/n^(m+1)`,
  </span>
  将上题的积分展开为
  <span class="formula">
    `int_0^oo (ln^(2k) t)/(1+t^2) dt`
    `= 2 int_0^1 (ln^(2k) t)/(1+t^2) dt`
    `= 2 sum_(n ge 0) (-1)^n int_0^1 t^(2n) ln^(2k) t dt`
    `= 2(2k)! sum_(n ge 0) (-1)^n/(2n+1)^(2k+1)`
    `= 2(2k)! beta(2k+1)`.
  </span>
</p>

<h3>Catalan 常数</h3>

<ol class="example">
	[来自 论文哥]
	`beta(2) = sum_(n ge 0) (-1)^n/(2n+1)^2` 称为 <b>Catalan 常数</b>:
	<span class="formula">
		`G = 0.915965594177...`
	</span>
  也有用 `K` 或 `C` 表示 Catalan 常数的. 由此计算:
	<li>`int_0^1 int_0^1 1/(1+x^2 y^2) dx dy = G`;</li>
	<li>`int_0^1 (arctan x)/x dx = G`;</li>
	<li>`int_0^1 (ln x)/(1+x^2) dx`
		`= -1/2 int_0^(pi/2) x csc x dx`
		`= int_0^(pi/4) ln tan x dx`
		`= -G`;
	</li>
	<li>`int_0^(pi/4) ln sin x dx` 和 `int_0^(pi/4) ln cos x dx`;</li>
    <li>`int_0^(pi/2) ln(1+cos x) dx` `= int_0^(pi/2) ln(1+sin x) dx`;</li>
	<li>`int_0^(sqrt2/2) (ln x)/sqrt(1-x^2) dx`,
		`int_0^(sqrt 2/2) (arcsin x)/x dx` 和 `int_0^(pi/4) x cot x dx`;
	</li>
	<li>`int_0^(1/2) Gamma(1+x)Gamma(1-x) dx`.</li>
</ol>

<ol class="solution">
	<li>将分母以几何级数展开, 收敛域为 `[-1, 1]`, 可以逐项积分.  原式等于
		<span class="formula">
			`int_0^1 int_0^1 sum_(n ge 0) (-x^2 y^2)^n dx dy`
			`= sum_(n ge 0) (-1)^n
			int_0^1 x^(2n) dx int_0^1 y^(2n) dy`
			`= sum_(n ge 0) (-1)^n/(2n+1)^2 = G`.
		</span>
	</li>
	<li>利用 `arctan x = sum_(n ge 0) (-1)^n x^(2n+1)/(2n+1)`, 原式等于
		<span class="formula">
			`int_0^1 sum_(n ge 0) (-1)^n x^(2n)/(2n+1) dx`
			`overset ? = sum_(n ge 0) (-1)^n/(2n+1) int_0^1 x^(2n) dx`
			`= sum_(n ge 0) (-1)^n/(2n+1)^2`
			`= G`.
		</span>
	</li>
	<li>分部积分,
		<span class="formula">
			`int_0^1 (arctan x)/x dx = - int_0^1 (ln x)/(1+x^2) dx`.
		</span>
		令 `t = arctan x`,
		<span class="formula">
			`int_0^1 (arctan x)/x dx = int_0^(pi/4) t/(sin t cos t) dt`
			`= 1/2 int_0^(pi/2) (t dt)/(sin t)`,<br/>
			`int_0^1 (ln x)/(1+x^2) dx = int_0^(pi/4) ln tan t dt`.
		</span>
	</li>
	<li>两个积分分别记为 `I, J`, 于是
		<span class="formula">
			`I+J = int_0^(pi/4) ln{:(sin 2x)/2:} dx`
			`= 1/2 int_0^(pi/2) ln sin x dx - pi/4 ln 2`
			`= - pi/2 ln 2`,<br/>
			`I-J = int_0^(pi/4) ln tan x dx = -G`.
		</span>
		解线性方程组即得到 `I, J = -pi/4 ln 2 &mp; G/2`.
	</li>
    <li>由上题易得结果为 `2G - pi/2 ln 2`.</li>
	<li>令 `x = sin t`,
		<span class="formula">
			`int_0^(sqrt2/2) (ln x)/sqrt(1-x^2) dx`
			`= int_0^(pi/4) ln sin t dt`.
		</span>
		另外两个积分的处理方法和
    <a href="7.html#exp-pi-ln2">`int_0^(pi/2) ln sin x dx`</a>
    一样, 先换元再分部积分, 得
		<span class="formula">
			`int_0^(sqrt2/2) (arcsin x)/x dx`
			`= int_0^(pi/4) t cot t dt`
			`= -pi/8 ln 2 - int_0^(pi/4) ln sin t dt`
			`= pi/8 ln 2 + G/2`.
		</span>
	</li>
	<li>原式等于
		<span class="formula">
			`int_0^(1/2) x Gamma(x) Gamma(1-x) dx`
			`= int_0^(1/2) (pi x)/(sin pi x) dx` (余元公式)
			`= 2/pi G` (由 3).
		</span>
	</li>
</ol>

<h3>Euler 和 (调和和)</h3>

<p>我们称 `H_n = sum_(k=1)^n 1/k` 为调和数, `H_n^((m)) = sum_(k=1)^n 1/k^m` 为广义调和数.</p>

<p class="example">
  对整数 `b gt a ge 0` 有
  `sum_(k ge 1) 1/((a+k)(b+k)) = (H_b - H_a)/(b - a)`.
</p>

<p class="proof">
  左边等于
    `1/(b-a) sum_(k ge 1) (1/(a+k) - 1/(b+k))`
  等于右边.
</p>

<p class="example">
  <b>`ln^2(1-x)` 的展开</b>
  `ln^2 (1-x) = sum_(n ge 2) (2H_(n-1))/n x^n`.
</p>

<p class="proof">
  左边等于
  <span class="formula">
    `(sum_(n ge 1) x^n/n)^2`
    `= sum_(n ge 2) x^n sum_(k=1)^(n-1) 1/(k(n-k))`.
  </span>
  裂项得
  <span class="formula">
    `sum_(k=1)^(n-1) 1/(k(n-k))`
    `= 1/n sum_(k=1)^(n-1) (1/k + 1/(n-k))`
    `= (2H_(n-1))/n`.
  </span>
</p>

<p class="example">
  `sum_(k ge 1) 1/k (H_(n+k) - H_k)`
  `= sum_(j=1)^n H_j/j`
  `= sum_(k ge 2) (1/k - 1/(n+k)) H_(k-1)`.
</p>

<ol class="proof">
  等式记为 `(1) = (2) = (3)`. 其中
  <li>
    <span class="formula">
      `(1) = sum_(k ge 1) 1/k sum_(j=1)^n 1/(k+j)`
      `= sum_(j=1)^n sum_(k ge 1) 1/(k(k+j))`
      `= (2)`.
    </span>
  </li>
  <li>[来自 乐正垂星]
    <span class="formula">
      `(2) = sum_(j=1)^n sum_(k ge 1) 1/(k(k+j))`
      `==^(m=j+k) sum_(m ge 2) 1/m sum_(j=1)^s 1/(m-j)`
      `= sum_(m ge 2) 1/m (H_(m-1) - H_(m-s))`
      `overset ? = (3)`.
    </span>
    其中 `s = min(n, m-1)`. 我们用极限说明最后一个等号成立:
    这只需证
    <span class="formula">
      `sum_(k ge 2) (H_(k-s)/k - H_(k-1)/(n+k)) = 0`.
    </span>
    事实上对任意充分大的 `N`,
    <span class="formula align">
      `0 le S_N = sum_(k=2)^N H_(k-s)/k - sum_(k=2)^N H_(k-1)/(n+k)`<br>
      `= sum_(k=2)^(n+1) H_0/k + sum_(k=n+2)^N H_(k-n-1)/k - sum_(k=2)^N
      H_(k-1)/(n+k)`<br>
      `= sum_(j=2)^(N-n) H_(j-1)/(j+n) - sum_(k=2)^N H_(k-1)/(n+k)`<br>
      `= sum_(j=N-n+1)^N H_(j-1)/(j+n)`<br>
      `le n H_(N-1)/(N-1)`.
    </span>
    上式两边令 `N to oo` 得 `S_N to 0`.
  </li>
</ol>

<p class="example">
  `sum_(k=1)^(n-1) H_k/(k+1) = sum_(k=1)^(n-1) (n H_k - k H_n)/(k(n-k))`.
</p>

<p class="proof">
  从等式
  <span class="formula">
    `sum_(k ge 1) 1/k (H_(n+k-1) - H_k) = sum_(k ge 1) (1/(k+1) - 1/(n+k)) H_k`
  </span>
  出发, 上式右边写为
  <span class="formula">
    `sum_(k ge 1) (H_k/(k+1) - H_(n+k-1)/(n+k))`
    `+ 1/(n+k)(H_(n+k-1) - H_k)`
    `= S_1 + S_2`.
  </span>
  于是 `S_1` 等于左边减 `S_2`, 即
  <span class="formula">
    `sum_(k=1)^(n-1) H_k/(k+1)`
    `= sum_(k ge 1) (1/k - 1/(n+k)) sum_(j=1)^(n-1) 1/(k+j)`
    `= sum_(j=1)^(n-1) (H_j/j - (H_n-H_j)/(n-j))`
    `= sum_(j=1)^(n-1) (n H_j - j H_n)/(j(n-j))`.
  </span>
</p>

<p class="example">
  `sum_(k=1)^n H_k/k = 1/2 (H_n^2 + H_n^((2)))`.
</p>

<p class="proof">
  上式左边记为 `S`, 分部求和,
  <span class="formula align">
    `S = [H_k H_(k-1)]_1^(n+1) - sum_(k=1)^n H_k/(k+1)`<br>
    `= H_(n+1) H_n - H_n/(n+1) - sum_(k=1)^(n-1) H_k/(k+1)`<br>
    `= H_n^2 + sum_(k=1)^(n-1) 1/(k+1)^2 - sum_(k=1)^(n-1)
    H_(k+1)/(k+1)`<br>
    `= H_n^2 + H_n^((2)) - S`.
  </span>
</p>

<ol class="example">
  <li>`int_0^1 x^(n-1) ln^m x dx = (-1)^m m!/n^(m+1)`;</li>
  <li>`int_0^1 x^(n-1) ln (1-x) dx = -H_n/n`.</li>
  <li>`int_0^1 x^(n-1) ln^2(1-x) dx = 2/n sum_(k=1)^n H_k/k = (H_n^2
    + H_n^((2)))/n`.</li>
</ol>

<ol class="solution">
  <li>分部积分即可.</li>
  <li>左边等于
    <span class="formula">
      `- int_0^1 x^(n-1) sum_(k ge 1) x^k/k dx`
      `= -sum_(k ge 1) 1/k int_0^1 x^(n+k-1) dx`
      `= -sum_(k ge 1) 1/(k(n+k))`
      `= -1/n sum_(k ge 1) (1/k - 1/(n+k)) = `
      右边.
    </span>
    利用 Beta 函数, 结论可以记为
      `del/(del y) B(n, y)|_(y=1) = -H_n/n`.
  </li>
  <li>利用 `ln^2(1-x)` 的展开,
    左边等于
    <span class="formula">
      `sum_(k ge 2) (2H_(k-1))/k int_0^1 x^(n+k-1) dx`
      `= sum_(k ge 2) (2H_(k-1))/(k(n+k))`
      `= 2/n sum_(k ge 2) (1/k - 1/(n+k)) H_(k-1)`.
    </span>
    利用前面的例题, 上式等于 `2/n sum_(k=1)^n H_k/k`,
    再利用 `sum_(k=1)^n H_k/k = 1/2 (H_n^2 + H_n^((2)))` 得到第二式.
  </li>
</ol>

<h2>超越函数的积分</h2>

<h3>多重对数积分</h3>

<p class="definition">
  `n` 阶多重对数积分在单位圆盘上定义为
  <span class="formula">
    `"Li"_n(z) = sum_(k ge 1) z^k/k^n`, `quad n in ZZ, |z| lt 1`,
  </span>
  通过解析延拓可以将定义域扩展到整个复平面.
</p>

<ol class="corollary">
  <li>`"Li"_(-1)(x) = x/(1-x)^2`,
    `"Li"_0(x) = x/(1-x)`,
    `"Li"_1(x) = -ln(1-x)`;</li>
  <li>`"Li"_n(1) = zeta(n)`, `"Li"_n(-1) = -eta(n)`;</li>
  <li>`"Li"_n(x) = int_0^x ("Li"_(n-1)(t))/t dt`;
    换言之 `"Li"_n'(x) = "Li"_(n-1)(x) // x`.
  </li>
</ol>

<p class="proof">
  只证最后一个结论:
  <span class="formula">
    `"Li"_n(x) = sum_(k ge 1) int_0^x t^(k-1)/k^(n-1) dt`
    `= int_0^x sum_(k ge 1) t^k/k^(n-1) dt/t`
    `= int_0^x ("Li"_(n-1)(t))/t dt`.
  </span>
</p>

<ol class="example">
  <li>`"Li"_2(x) + "Li"_2(1-x) = pi^2/6 - ln x ln(1-x)`, 特别
  `"Li"_2(1/2) = pi^2/12 - (ln^2 2)/2`;</li>
  <li>`"Li"_3(1/2) = (ln^3 2)/6 - pi^2/12 ln 2 + 7/8 zeta(3)`;</li>
  <li>`int_0^(pi/2) x ln sin x dx = 7/16 zeta(3) - pi^2/8 ln 2`;</li>
</ol>

<ol class="proof">
  <li>
    两边求导,
    <span class="formula">
      `("Li"_1(x))/x - ("Li"_1(1-x))/(1-x)`
      `= -ln(1-x)/x + ln x/(1-x)`
    </span>
    等号成立; 且 `x to 0^+` 时原式等号成立, 证毕.
  </li>
  <li></li>
  <li>[来自某数学系 dalao] 利用 Fourier 展开
    <span class="formula">
      `ln sin x = -ln 2 - sum_(n ge 1) (cos 2 n x)/n`
    </span>
    逐项积分, 原式等于
    <span class="formula">
      `- pi^2/8 ln 2 - sum_(n ge 1) 1/n int_0^(pi/2) x cos 2 n x dx`
      `= - pi^2/8 ln 2 - sum_(n ge 1) 1/n ((-1)^n - 1)/(4n^2)`
      `= - pi^2/8 ln 2 + 1/4 (zeta(3) + eta(3))`
      `= - pi^2/8 ln 2 + 7/16 zeta(3)`.
    </span>
  </li>
</ol>

<h3>多重对数积分与 Euler 和*</h3>

<p>以下介绍的多重对数积分与 Euler 和最终可以用 `zeta` 函数在整数点的取值表示.</p>

<p class="example">
  [来自 <a href="https://zhuanlan.zhihu.com/p/396955692">知乎</a>] 定义
  <span class="formula">
    `bb(i a b c 0) = int_0^1 (ln^a(1-x) ln^b ln^c(1+x))/(1-x) dx`,<br>
    `bb(i a b c 1) = int_0^1 (ln^a(1-x) ln^b ln^c(1+x))/x dx`,<br>
    `bb(i a b c 2) = int_0^1 (ln^a(1-x) ln^b ln^c(1+x))/(1+x) dx`.
  </span>
  其中 `a + b + c + 1 := n` 称为这个积分的权 (weight).
  权为 `n` 的多重对数积分的值可以用 `"Li"_k(1) = zeta(k)` 和
  `"Li"_k(1/2)` 表示, 其中 `k le n`. 我们仅举一例:
  <span class="formula">
    `bb(i n 001)`
    `==^(x mapsto 1-x) bb(i0n00)`
    `==^(x mapsto "e"^-x) (-1)^n Gamma(n+1)zeta(n+1)`.
  </span>
</p>

<ol class="example">
  [来自 (Almost) Impossible Integrals, Sums, and Series]
  <li>`int_0^x (ln^2(1-t))/t dt`;</li>
  <li>`int_0^x (ln^2(1+t))/t dt`.</li>
</ol>

<ol class="solution">
  <li>分部积分, 原式等于
    <span class="formula">
      `ln x ln^2(1-x) + 2 int_0^x (ln t ln(1-t))/(1-t) dt`
    </span>
    其中
    <span class="formula">
      `int_0^x (ln t ln(1-t))/(1-t) dt`
      `= int_(1-x)^1 (ln t ln (1-t))/t dt`
      `= int_0^1 - int_0^(1-x)`.
    </span>
    第一项
    <span class="formula">
      `int_0^1 (ln t ln(1-t))/t dt`
      `= int_0^1 ln t ( ln t/(1-t) - ln(1-t)/t ) dt`
      `= - I + int_0^1 (ln^2 t)/(1-t) dt`
      `= 1/2 int_0^oo x^2/("e"^x - 1) dx`
      `= 1/2 Gamma(3) zeta(3)`
      `= zeta(3)`.
    </span>
    第二项分部积分
    <span class="formula">
      `int_0^x (ln t ln(1-t))/t dt`
      `= "Li"_3(x) - ln x "Li"_2(x)`.
    </span>
    综上
    <span class="formula">
      `int_0^x (ln^2(1-t))/t dt`
      `= ln x ln^2(1-x)`
      `+ 2 zeta(3) - 2 "Li"_3(1-x) + 2 ln(1-x) "Li"_2(1-x)`.
    </span>
  </li>
  <li>方法和上题类似, 分部积分后, 使用换元 `s = 1/(1+t)`.
    结果为 `ln x ln^2(1+x) - 2 "Li"_3(1/(1+x)) - 2 ln(1+x)"Li"_2(1/(1+x))`
    `- 2/3 ln(1+x) + 2 zeta(3)`.
  </li>
</ol>

<p class="definition">
  对正整数 `a ge 1, b ge 2`, <b>Euler 和</b>定义为
  <span class="formula">
    `s_n(a, b) = sum_(n ge 1) (H_n^a)/(n+1)^b`,<br>
    `sigma_n(a, b) = sum_(n ge 1) H_n^((a))/(n+1)^b`,
  </span>
  其中 `H_n^((a)) = sum_(k=1)^n 1/k^a` 是<b>广义调和数</b>.
</p>

<p class="corollary">
  <span class="formula">
    `sum_(n ge 1) H_n^((a))/n^b = sigma_h(a, b) + zeta(a + b)`,<br>
    `sum_(n ge 1) H_n^2/n^b = s_h(2, n) + 2s_h(1, n+1) + zeta(n+2)`.
  </span>
</p>

<table>
  <tr>
    <th>`a`</th>
    <th>`sum_(n ge 1) H_n/n^a`</th>
  </tr>
  <tr>
    <td>`1`</td>
    <td>`oo`</td>
  </tr>
  <tr>
    <td>`2`</td>
    <td>`2 zeta(3)`</td>
  </tr>
  <tr>
    <td>`3`</td>
    <td>`5/4 zeta(4)`</td>
  </tr>
  <tr>
    <td>`4`</td>
    <td>`3 zeta(5) - zeta(2) zeta(3)`</td>
  </tr>
  <tr>
    <td>`5`</td>
    <td>`7/4 zeta(6) - 1/2 zeta(3)^2`</td>
  </tr>
  <tr>
    <td>`6`</td>
    <td>`4 zeta(7) - zeta(2) zeta(5) - zeta(3) zeta(4)`</td>
  </tr>
  <tr>
    <td>`7`</td>
    <td>`9/4 zeta(8) - zeta(3) zeta(5)`</td>
  </tr>
  <tr>
    <td>`8`</td>
    <td>`5 zeta(9) - zeta(2) zeta(7) - zeta(3) zeta(6) - zeta(4) zeta(5)`</td>
  </tr>
</table>

<div class="p example">
  [来自 我是不万能的洛必达]
  <span class="formula">
    `sum_(n ge 1) H_n/n^2`
    `= 2 sum_(n ge 2) H_(n-1)/n^2`
    `= sum_(m, n ge 1) 1/(m n(m+n))`
    `= 2 zeta(3)`.
  </span>
  前三个级数收敛缓慢, 取一万项后仍与目标有较大差距; 但 zeta(3) 收敛较快.
<pre>
&gt;&gt;&gt; sum(1/n**3 for n in range(1, 10000))
1.202056898159098
&gt;&gt;&gt; sum(sum(1/(m*n*(m+n)) for m in range(1, 100)) for n in range(1, 100))
2.293828375511741
</pre>
</div>

<ol class="proof">
  上式记为 (1) = (2) = (3) = (4).
  <li>令 `t = m + n` 得
    <span class="formula">
      `(2) = sum_(t ge 2) 1/t^2 sum_(n=1)^(t-1) (1/n + 1/(t-n))`
      `= sum_(t ge 2) sum_(n=1)^(t-1) 1/(t n (t-n))`
      `= (3)`.
    </span>
  </li>
  <li>利用积分 `int_0^oo "e"^(-lambda x) dx = 1/lambda` 得
    <span class="formula">
      `(3) = sum_(m, n ge 1) 1/(m n) int_0^oo "e"^(-(m+n)x) dx`
      `= int_0^oo (sum_(n ge 1) "e"^(-n x)/n)^2 dx`
      `= int_0^oo ln^2 (1-"e"^-x) dx`
      `= -int_(-oo)^0 t^2 "d"ln (1-"e"^t)`
      `= int_(-oo)^0 t^2 "e"^t/(1-"e"^t) dt`
      `= int_0^oo t^2 "e"^-t/(1-"e"^-t) dt`
      `= zeta(3) Gamma(3) = (4)`.
    </span>
  </li>
  <li>
    最后
    <span class="formula">
      `(1) - zeta(3)`
      `= sum_(n ge 1) (H_n - 1//n)/n^2`
      `= sum_(n ge 2) H_(n-1)/n^2 = (2)//2`.
    </span>
    于是 (1) = (2).
  </li>
</ol>

<p class="example">
  <b>Au-Yeung 级数</b>
  `sum_(n ge 1) H_n^2/n^2 = 17/4 zeta(4) = 17/360 pi^4`.
</p>

<h3>多重指数积分</h3>

<p class="definition">
	设 `n` 为非负整数, (Schlömilch's) `n` 阶指数积分定义为
	<span class="formula">
		`E_n(x) = int_1^oo "e"^(-x t)/t^n dt`, `quad x gt 0`.
	</span>
  特别 `E_0(x) = "e"^-x/x`, `E_n(x) = x^(n-1) int_x^oo "e"^-u/u "d"u` (`n
  ge 1`).
</p>

<p class="proposition">
	分部积分可证, `n E_(n+1)(z) = "e"^-z - z E_n(z)`.
</p>

<p class="proposition">
	设 `x gt 0`, `n ge 1`, 则
	<span class="formula">
		`1/(x+n) lt "e"^x E_n(x) lt 1/(x+n-1)`.
	</span>
  此外 `n = 0` 时左边的等号成立.
</p>

<p class="proof">
	对任意 `t gt 1` 有 `t-1 gt ln t`, 因此
	<span class="formula">
		`-x(t-1) lt -x ln t`,
	</span>
	取指数,
	<span class="formula">
		`"e"^(x(1-t)) lt t^-x`,
	</span>
	积分
	<span class="formula">
		`"e"^x E_n(x) = int_1^oo "e"^(x(1-t))/t^n dt`
		`lt int_1^oo t^(-n-x) dt`
		`= 1/(n+x-1)`.
	</span>
  利用已证得的 `E_(n+1)(x) lt ("e"^-x)/(x+n)`, `n ge 1`, 有
  <span class="formula">
    `E_n(x) = ("e"^-x - n E_(n+1)(x))/x`
    `gt "e"^-x/x (1 - n/(x+n))`
    `= "e"^-x/(x+n)`, `quad n ge 1`.
  </span>
</p>

<h3>指数积分与对数积分</h3>

<ol class="definition">
    <li><b>指数积分</b> `"Ei"(x) = -E_1(-x) = int_(-oo)^x "e"^t/t dt`.
      `x gt 0` 时, 取 Cauchy 主值 `lim_(epsi to 0+)
      int_(-oo)^-epsi + int_epsi^x`. 在复平面上, `"Ei"(z)` 有唯一极点
      `z = 0`.
    </li>
    <li><b>对数积分</b> `"li"(x) = int_0^x dt/(ln t)`.
      `x gt 1` 时, 取 Cauchy 主值
      `lim_(epsi to 0^+) int_0^(1-epsi) + int_(1+epsi)^x`.
      在复平面上, `"li"(z)` 有唯一极点 `z = 1`.
    </li>
    <li><b>正弦积分</b> `"Si"(x) = int_0^x (sin t)/t dt`.  </li>
    <li><b>余弦积分</b> `"Ci"(x) = gamma + ln x + int_0^x (cos t - 1)/t dt`.
    </li>
</p>

<ol class="proposition">
    <li>`"li"(x) = "Ei"(ln x)`;</li>
    <li>`"Ei"("i"x) = "Ci"(x) + "i"(pi/2 + "Si"(x))`;</li>
</ol>

<p class="proposition">
    `"Ei"(z) = gamma + ln z + sum_(k ge 1) z^k/(k * k!)`.
</p>

<p class="proof">
    `"Ei"(z) = int_(-oo)^x "e"^t/t dt`
    `= int_(-oo)^x sum_(n ge 0) t^(n-1)/(n!) dt`
    `overset ? = sum_(n ge 0) int_(-oo)^x t^(n-1)/(n!) dt`
    `= ln x - ln (-oo) + sum_(n ge 1) x^n(n*n!)` ??
</p>

<p class="theorem">
  <b>素数定理</b>
  记 `pi(x)` 为不超过 `x` 的素数个数,
  则 `x to oo` 时 `pi(x) ~ "li"(x) ~ x/(ln x)`.
</p>

<script src="../../js/note.js?type=math"></script>
<script src="../../js/plot.js"></script>
<script>
const Gamma = s => {
  const N = 1000
  let ret = N**s/s
  for (let n = 1; n <= N; ++n) {
    ret *= n / (s+n)
  }
  return ret
}

new Plot('img-gamma')
  .geometry({xmin: -5, xmax: 5, ymin: -5, ymax: 7}).axis({ytick: 2})
  .plot(Gamma, {continuity: 1e3})
</script>
</body>
</html>
