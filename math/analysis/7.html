<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <title>定积分与广义积分</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" type="text/css" href="../../css/note.css" />
</head>
<body>

<h2>定积分的定义与理论*</h2>

<h3>定积分的定义</h3>

<p class="definition">
  <b>Riemann 积分的经典定义</b>
  设函数 `f` 定义在 `[a, b]` 上. 若存在实数 `I`, `AA epsi gt 0`,
  对于 `[a, b]` 的任意<b>分割 (partition)</b>
  <span class="formula">
    `Delta = {x_0, x_1, cdots, x_n}`,
    `quad a = x_0 lt x_1 cdots lt x_n = b`
  </span>
  和关于此分割的任意<b>介点集</b>
  <span class="formula">
    `Xi = {xi_1, xi_2, cdots, xi_n}`,
    `quad xi_k in [x_(k-1), x_k]`,
  </span>
  都存在 `delta gt 0`, 使当<b>分割的模</b>
  <span class="formula">
    `||Delta||`
    `= max_(1 le k le n) Delta x_k`
    `= max_(1 le k le n) (x_k - x_(k-1))`
  </span>
  满足 `||Delta|| lt delta` 时, 有
  <span class="formula">
    `|sum_(k=1)^n f(xi_k) Delta x_k - I| lt epsi`,
  </span>
  则称 `f` 在 `[a, b]` 上<b>Riemann 可积</b>, 记作 `f in R[a, b]`.
  `I` 称为 `f` 在 `[a, b]` 上的<b>积分</b>, 记作
  <span class="formula">
    `int_a^b f(x) dx = I`.
  </span>
  Riemann 可积的定义也可以用极限的语言写作
  <span class="formula">
    `lim_(||Delta|| to 0) sum_(k=1)^n f(xi_k) Delta x_k = I`,
  </span>
  其中, `S = sum_(k=1)^n f(xi_k) Delta x_k` 称为 <b>Riemann 和</b>.
</p>

<p class="remark">
  定积分是一个数, 与积分区间 `[a, b]` 和被积函数 `f` 有关,
  但与被积函数的变元无关. 因此 `int_a^b f(x) dx = int_a^b f(t) dt`.
  如果视函数 `f` 为变元, 也可以说定积分是函数的函数, 即泛函.
</p>

<p class="remark">
  Riemann 积分理论有其局限性和不便之处, 为此, 提出了新的积分理论——
  Lebesgue 积分, 这种积分将在实变函数中介绍.
</p>

<ol class="definition">
  <b>Riemann 积分的第二定义</b>
  <li>记 `I_k = [x_(k-1), x_k]`. 分别称
    <span class="formula">
      `bar S(f, Delta) = sum_(k=1)^n underset (x in I_k)"sup" f(x) |I_k|`,
      `quad ul S(f, Delta) = sum_(k=1)^n underset (x in I_k)"inf" f(x) |I_k|`
    </span>
    为 `f` 关于分割 `Delta` 的 (Darbux) <b>上和</b>与<b>下和</b>.
    这里的上、下确界取广义实值, 上确界可以取 `+oo`, 下确界可以取 `-oo`.
  </li>
  <li>对介点集加细, 会使上和减小, 下和增加.  这是因为
    <span class="formula">
      `underset ([a, b])"sup" f ge max(underset ([a,c])"sup" f, underset
      ([c, b])"sup" f)`.
    </span>
  </li>
  <li>任意一个上和总是大于任意一个下和. 比较 `bar S(f, Delta_1)` 和 `ul
    S(f, Delta_2)`, 只需取 `Delta_1, Delta_2` 的公共加细 `Delta`, 则
    <span class="formula">
      `bar S(f, Delta_1)`
      `ge bar S(f, Delta)`
      `ge ul S(f, Delta)`
      `ge ul S(f, Delta_2)`.
    </span>
    这指出上和有下界, 下和有上界.  定义上和的下确界为<b>上积分</b>,
    下和的上确界为<b>下积分</b>:
    <span class="formula">
      `bar(int_a^b) f(x) dx = underset Delta "inf" bar S(f, Delta)`
      `ge ul(int_a^b) f(x) dx = underset Delta "sup" ul S(f, Delta)`.
    </span>
    如果上积分等于下积分, 就称 `f` 的积分存在, 且等于上、下积分的值.
  </li>
  <li>
    上和与下和的差记为
    <span class="formula">
      `omega(f, Delta) = bar S(f, Delta) - ul S(f, Delta)`.
    </span>
    关于所有分割取下确界, 称为 `f` 在区间上的<b>振幅</b>:
    <span class="formula">
      `omega(f) = underset Delta "inf" omega(f, Delta)`
      `= underset Delta "inf" sum_(k=1)^n omega(f, I_k) |I_k|`,
    </span>
    其中
    <span class="formula">
      `omega(f, I_k) = underset (x in I_k)"sup" f(x) - underset (x in I_k)
      "inf" f(x)`.
    </span>
    因此 `f` Riemann 可积当且仅当 `omega(f) = 0`.
  </li>
</ol>

<p class="corollary">
  <b>可积必有界</b>
  若 `f in R[a, b]`, 则 `f` 在 `[a, b]` 上有界.
</p>

<p class="proof">
  若 `f` 在 `[a, b]` 上无界, 考虑区间的任一分割,
  `f` 至少在其中一个子区间 `I_k` 上无界. 从而 `omega(f, I_k) ge 1//|I_k|`,
  进而 `omega(f) ge omega(f, I_k) |I_k| ge 1`. 这说明 `f` 不可积.
</p>

<p class="corollary">
  <b>连续必可积</b>
  若 `f in C[a, b]`, 则 `f in R[a, b]`.
</p>

<p class="proof">
  闭区间 `[a, b]` 上的连续函数是一致连续的:
  对任意 `epsi gt 0`, 存在 `delta gt 0`, 使得
  <span class="formula">
    `|f(x) - f(y)| lt epsi`, `quad AA |x-y| lt delta`.
  </span>
  因此只要分割足够细 (小于 `delta`), 在每个区间上的振幅就小于 `epsi`,
  从而总的振幅小于 `epsi(b-a)`.
</p>

<p class="corollary">
  <b>挖去有限个点, 不影响可积性</b>
  设 `f` 在 `[a, b]` 上有界, `c in [a, b]`, 且对任意小的 `delta gt 0`, `f`
  分别在 `[a, c-delta]`, `[c+delta, b]` 上可积, 则 `f` 在 `[a, b]` 上可积.
</p>

<p class="proof">
  设 `|f| le M`. 对任意 `epsi gt 0`, 取 `delta lt epsi // M`, 下面说明
  区间 `[c-delta, c+delta]` 长度足够小, 且 `f` 在 `[a, c-delta] uu
  [c+delta, b]` 上的振幅足够小.<br>
  事实上, 存在 `[a, c-delta]` 和 `[c+delta, b]` 的分割 `Delta_1, Delta_2`
  使得
  <span class="formula">
    `omega(f, Delta_i) lt epsi`, `quad i = 1, 2`.
  </span>
  取 `Delta_1, Delta_2` 的公共加细, 并加入 `c-delta, c+delta` 两个分点,
  组成的分割记为 `Delta`, 则
  <span class="formula">
    `omega(f, Delta) lt 2epsi + 2delta * 2M lt 3epsi`.
  </span>
</p>

<p class="example">
  Dirichlet 函数 `D(x) = chi_QQ = { 0, if x !in QQ; 1, if x in QQ :}`
  在 `[0, 1]` 上不可积. 原因是无论分割取得多细, 每个小区间上的振幅始终等于
  1.
</p>

<h3>定积分的性质</h3>

<ol class="property">
  <b>定积分的基本性质</b> 设 `f, g` 在 `[a, b]` 上可积, 则
  <li>`int_a^b c f(x) dx = c int_a^b f(x) dx`, `c` 为常数;</li>
  <li>`int_a^b [f(x) + g(x)] dx = int_a^b f(x) dx + int_a^b g(x) dx`;</li>
  1, 2 称为积分的线性性.
  <li>区间可加性. 若 `f in R[a,c] uu R[c,b]`, 则 `f in R[a, b]`,
    且 `int_a^b f(x) dx = int_a^c f(x) dx + int_c^b f(x) dx`;</li>
  <li>保序性. 若 `f(x) le g(x)`, 则 `int_a^b f(x) dx le int_a^b g(x) dx`;</li>
</ol>

<p class="lemma">
  设 `f in R[a, b]`, 则 `f` 有界, 设它的值域含于 `[c, d]`;
  又设 `varphi in C[c, d]`, 则复合函数 `varphi @ f in R[a, b]`.
</p>

<ol class="proof">
  <li>由于 `varphi` 在 `[c, d]` 上一致连续, 对任意 `epsi gt 0`, 存在 `delta
    gt 0`, 使得对任意 `s, t in [c, d]`, 只要 `|s - t| lt delta`, 就有
    `|varphi(s) - varphi(t)| lt epsi`.
  </li>
  <li>考虑 `[a, b]` 的一个分割 `Delta`, 将 `[a, b]` 的子区间分为两类:
    <span class="formula">
      `k in {Lambda, if omega(f, I_k) lt delta; Lambda', otherwise:}`
    </span>
    我们来证明, 第一类区间上的振幅足够小, 而第二类区间的长度足够小.
  </li>
  <li>对于 `k in Lambda`, 有 `omega(f, I_k) lt delta`,
    则 `omega(varphi @ f, I_k) lt epsi`.
    另一方面, 若 `k in Lambda'`, 则
    <span class="formula">
      `delta sum_(k in Lambda') |I_k|`
      `le sum_(k in Lambda') omega(f, I_k) |I_k|`
    </span>
    由 `f` 可积, 可以取分割足够细, 使得上式右边 `le delta^2`, 从而
    `sum_(k in Lambda') |I_k| le delta`.
  </li>
  <li>
    综上有
    <span class="formula">
      `omega(varphi @ f, Delta) le epsi(b-a) + delta * 2 B`,
    </span>
    其中 `B` 是 `varphi` 在 `[c, d]` 上的界.
    我们可以取 `delta lt epsi`, 从而 `varphi @ f` 可积.
  </li>
</ol>

<ol class="corollary">
  <li>乘积的可积性. 若 `f, g in R[a, b]`, 则 `f g in R[a, b]`;
    这保证了内积 `f * g = int_a^b f(t) g(t) dt` 和卷积 `f ** g = int_a^b f(t) g(x-t) dt`
    的存在性.
  </li>
  <li>绝对可积. 若 `f in R[a, b]` 则  `|f| in R[a, b]`,
    且 `|int_a^b f(x) dx| le int_a^b |f(x)| dx`.</li>
</ol>

<ol class="proof">
  <li>取 `varphi(t) = t^2`, 则 `(f + g)^2`, `(f - g)^2 in R[a, b]`,
    进而 `f g = [(f + g)^2 - (f - g)^2]//4 in R[a, b]`.
  </li>
  <li>若 `f` 可积, 取 `varphi(t) = |t|` 知 `|f|` 也可积.
    利用不等式 `-|f| le f le |f|` 和保序性知道 `|int_a^b f(x) dx| le
    int_a^b |f(x)| dx`.
  </li>
</ol>

<p class="remark">
  反之若 `|f|` 可积, 则 `f` 不一定可积. 如 `D(x) - 1//2`, `D(x)` 是
  Dirichlet 函数. 这个问题将在 Lebesgue 积分中解决.
</p>

<h3>Riemann 积分与测度</h3>

<p>我们已经看到连续必可积. 反之, 可积函数对连续性也有一定的要求, 比如
  Dirichlet 函数处处不连续, 性质不好, 导致它不可积. 那么如果对 Riemann
  可积函数的连续性作出适当的刻画?  本节将证明, 有界函数 `f` 在 `[a, b]`
  上可积当且仅当它几乎处处连续.
</p>

<ol class="definition">
  <b>零测集与几乎处处</b>
  <li>设 `E sube RR`, 若一列开区间 `I = {I_k}_(k=1)^oo` 满足
    `E sube uuu_(k ge 1) I_k`, 则称它为 `E` 的一个可数开区间覆盖.
    `||I|| = sum_(k ge 1) |I_k|` 称为这个覆盖的模.
  </li>
  <li>关于 `E` 的所有可数开区间覆盖 `I` 的模取下确界, 称为 `E`
    的<b>外测度</b>: `m^**(E) = underset (I) "inf"||I||`.
    之所以叫外测度, 是因为我们从 `E` 的外部对它的大小进行度量.
  </li>
  <li>
    若 `m^**(E) = 0`, 则称 `E` 为<b>零测集</b>. 换言之, `E`
    为零测集当且仅当对任意 `epsi gt 0`, 存在一列开区间 `{I_k}`, 满足
    <span class="formula">
      `E sube uuu_(k ge 1) I_k`,
      `quad sum_(k ge 1) |I_k| lt epsi`.
    </span>
  </li>
  <li>若函数 `f` 在 `[a, b]` 上有定义, 且在一个零测集之外, 即在 `[a, b]\\E`
    上处处具有性质 `P`, 则称 `f` <b>几乎处处</b>具有性质 `P`,
    如几乎处处连续, 几乎处处可微等.
  </li>
</ol>

<p class="corollary">
  可数个零测集的并是零测集.
</p>

<p class="proof">
  设 `{E_n}` 是一列零测集, 对每个正整数 `n` 取 `E_n` 的覆盖
  `{I_(n, k)}_(k=1)^oo`, 使得 `sum_(k ge 1) |I_(n,k)| le 2^-n epsi`.
  于是 `uuu_(n ge 1) E_n sube uuu_(n, k ge 1) I_(n,k)`, 且
  <span class="formula">
    `sum_(n, k ge 1) |I_(n,k)| le sum_(n ge 1) 2^-n epsi = epsi`.
  </span>
</p>

<p class="theorem">
  <b>Lebesgue 定理</b>
  `[a, b]` 上的有界函数 `f` Riemann 可积当且仅当它几乎处处连续, 换言之,
  `f` 的不连续点的集合是零测集.
</p>

<h2>积分换元</h2>

<h3>利用对称性</h3>

<p>设下面的各个 `f` 在积分区间上有定义且可积.</p>

<p>
  <b>偶函数</b>
  如果 `f` 有对称轴 `x = u`, 即 `f(x) = f(2u-x)`, 那么
  <span class="formula">
    `int_(u-a)^u f(x) dx = int_u^(u+a) f(x) dx`.
  </span>
  特别若 `f` 是偶函数, 则
  <span class="formula">
    `int_(-a)^a f(x) dx = 2 int_0^a f(x) dx`.
  </span>
</p>

<p>
  <b>奇函数</b>
  如果 `f` 有对称中心 `(u, v)`, 即 `f(x) = 2v - f(2u-x)`, 那么
  <span class="formula">
    `int_(u-a)^u f(x) dx + int_u^(u+a) f(x) dx = 2va`.
  </span>
  特别若 `f` 是奇函数, 则
  <span class="formula">
    `int_(-a)^a f(x) dx = 0`.
  </span>
</p>

<p>
  <b>周期函数</b>
  如果 `f` 是以 `T` 为周期的周期函数, 则对任意常数 `a`,
  <span class="formula">
    `int_a^(a+T) f(x) dx = int_0^T f(x) dx`.
  </span>
  且 `int_a^x f(t) dt` 以 `T` 为周期当且仅当 `int_0^T f(t) dt = 0`.
</p>

<ol class="proof">
	<li>结论一: 由周期性,
		<span class="formula">
			`int_T^(a+T) f(x) dx`
			`= int_0^a f(y+T) dy`
			`= int_0^a f(y) dy`.
		</span>
		因此
		<span class="formula">
			`int_a^(a+T) = int_a^0 + int_0^T + int_T^(a+T)`
			`= int_a^0 + int_0^T + int_0^a`
			`= int_0^T`.
		</span>
		事实上, 若 `f` 连续, 则
		<span class="formula">
			`"d"/("d"a) int_a^(a+T) f(x) dx`
			`= f(a+T) - f(a) = 0`,
		</span>
		这说明 `int_a^(a+T) f(x) dx` 与 `a` 的取值无关.
		下证结论二.
		<span class="formula">
			`int_a^(x+T) f(t) dt = int_a^x f(t) dt`
			`iff int_x^(x+T) f(t) dt = 0`
			`iff int_0^T f(t) dt = 0`.
		</span>
	</li>
</ol>

<p>
  <b>区间再现</b> 作变元替换 `x = a+b-t`, 有
  <span class="formula">
    `int_a^b f(x) dx = int_a^b f(a+b-t) dt`.
  </span>
  这个公式的一个推论是, 对任意使得 `f(sin x), f(cos x)` 可积的函数
  `f`,
  <span class="formula">
    `int_0^(pi/2) f(sin x) dx = int_0^(pi/2) f(cos x) dx`.
  </span>
  如果 `f` 和 `g` 在同一区间上的积分相等, 我们可以用 `(f+g)//2`
  的积分来替代它, 例如
  <span class="formula">
    `int_0^pi x f(sin x) dx`
    `= int_0^pi (pi-x) f(sin(pi-x)) dx`
    `= pi/2 int_0^pi f(sin x) dx`.
  </span>
</p>

<p class="remark">
  利用积分区域对称性的技巧, 在一元积分中只有一种, 就是区间再现.
  多元积分中, 对称性的使用会更加复杂多样.
</p>

<p class="example">
  `int_0^oo x^a/(1+x^a) dx/(1+x^2)`
</p>

<p class="solution">
  令 `x = tan y`, 原式等于
  <span class="formula">
    `int_0^(pi/2) (sin^a y)/(cos ^a y + sin^a y) dy`
    `= 1/2 int_0^(pi/2) (cos^a y + sin^a y)/(cos^a y + sin^a y) dy`
    `= pi/4`.
  </span>
</p>

<h3>杂例</h3>

<ol class="example">
	<li>`I_1 = int dx / sqrt((a+x)(b-x))`;</li>
	<li>`I_2 = int_h^(R sin phi)
			arccos{: (x cot phi) / sqrt(R^2-x^2) :} dx`,
		`0 lt h lt R sin phi`, `phi in [0, pi/2)`;
	</li>
	<li>`I_3 = int sqrt((a^2x-b^2) / (1-x)) dx/x`;</li>
	<li>`I_4 = int_(h_1)^(r_2) arccos{: (h_2)/sqrt(R^2-x^2) :} dx`,
		其中 `R = sqrt(h_1^2 + r_1^2) = sqrt(h_2^2 + r_2^2)`.
	</li>
</ol>

<ol class="solution">
	<li>令 `t = sqrt((a+x)/(b-x))`,
		则 `x = (bt^2-a) / (1+t^2)`,
		`dx = (2(a+b)t) / (1+t^2)^2 dt`.  于是
		<span class="formula">
			`I_1 = int (2(a+b)t dt)/( t|b-(bt^2-a)/(1+t^2)| (1+t^2)^2 )`
			`= 2 sgn(a+b) int dt / (1+t^2)`
			`= 2 sgn(a+b) * arctan sqrt((a+x)/(b-x)) + C`.
		</span>
	</li>
	<li>令 `u = (x cot phi) / sqrt(R^2-x^2)`,
		则 `x = (Ru) / sqrt(u^2 + cot^2 phi)`.
		记 `r = sqrt(R^2 - h^2)`, 于是
		<span class="formula">
			`I_2 = [(Ru arccos u)/sqrt(u^2+cot^2 phi)]_((h cot phi)//r)^1
			+ R/2 int_((h cot phi)//r)^1 ("d"(u^2))
			/ sqrt( (cot^2 phi + u^2)(1-u^2) )`.
		</span>
		由 1,
		<span class="formula">
			`I_2 = -h arccos{: (h cot phi)/r :}
				+ R[ arctan sqrt((cot^2 phi + u^2) / (1-u^2)) ]
				_((h cot phi)//r)^1`
			`= - h arccos{: (h cot phi)/r :}
				+ R(pi/2-arctan{:(R cot phi) / sqrt(r^2-h^2 cot^2 phi):})`
			`= R arccos{: (R cos phi)/r :} - h arccos{: (h cot phi)/r :}`.
		</span>
	</li>
	<li>令 `t = sqrt((a^2x-b^2)/(1-x))`,
		则 `x = (b^2+t^2)/(a^2+t^2)`,
		`dx = (2t(a^2-b^2)) / (a^2+t^2)^2 dt`.  于是
		<span class="formula">
			`I_3 = int t * (a^2+t^2) / (b^2+t^2)
				* (2t(a^2-b^2)) / (a^2+t^2)^2 dt`
			`= 2 int ( a^2/(a^2 + t^2) - b^2 / (b^2 + t^2) ) dt`
			`= 2 ( a arctan{:t/a:} - b arctan{:t/b:} ) + C`.
		</span>
		再将 `t` 代回, 即得最终结果.
	</li>
	<li>令 `u = h_2/sqrt(R^2-x^2)`,
		则 `x = sqrt( R^2 - (h_2/u)^2 )`.  于是
		<span class="formula">
			`I_4 = [ sqrt( R^2 - (h_2/u)^2 ) arccos u ]_(h_2//r_1)^1
				+ int_(h_2//r_1)^1 sqrt( R^2 - (h_2/u)^2 )
				("d"u) / sqrt(1-u^2)`
			`=	- h_1 arccos {:h_2/r_1:}
				+ 1/2 int_(h_2//r_1)^1 sqrt( (R^2u^2 - h_2^2) / (1-u^2) )
				( "d"(u^2) ) / u^2`.
		</span>
		由 3 知, 上式第二项等于
		<span class="formula">
			`[R arctan{:1/R:} sqrt((R^2u^2 - h_2^2)/(1-u^2))
				- h_2 arctan{:1/h_2:}
				sqrt((R^2u^2 - h_2^2)/(1-u^2)) ]_(h_2//r_1)^1`
			`= pi/2 (R-h_2)
				- (R arctan{:(h_1 h_2)/(R sqrt(r_1^2 - h_2^2)):}
				- h_2 arctan{:h_1/sqrt(r_1^2 - h_2^2):} )`
			`= R arccos{:(h_1 h_2)/(r_1 r_2):} - h_2 arccos{:h_1/r_2:}`.
		</span>
		故
		<span class="formula">
			` I_4 = R arccos{:(h_1 h_2)/(r_1 r_2):}
			- h_1 arccos{:h_2/r_1:}
			- h_2 arccos{:h_1/r_2:}`.
		</span>
	</li>
</ol>

<p class="example">
    `int_(-pi)^pi (x sin x * arctan "e"^x) / (1+cos^2 x) dx`
</p>

<p class="solution">
    区间再现. 用 `-x` 代替 `x`, 原式等于
    <span class="formula">
        `int_(-pi)^pi (x sin x * arctan "e"^-x) / (1+cos^2 x) dx`
        `= pi/4 int_(-pi)^pi (x sin x)/(1+cos^2 x) dx`
        `= pi/2 int_0^pi (x sin x)/(1+cos^2 x) dx`.
    </span>
    再次区间再现. 用 `pi-x` 代替 `x`, 上式等于
    <span class="formula">
        `pi/2 int_0^pi ((pi-x) sin x)/(1+cos^2 x) dx`
        `= pi^2/4 int_0^pi (sin x dx)/(1+cos^2 x)`
        `= -pi^2/4 int_1^(-1) dx/(1+x^2) = pi^3/8`.
    </span>
</p>

<p class="example">
	`int_0^(2pi) (1-cos t)^2 (t-sin t) dt`.
</p>

<p class="solution">
	因为不定积分 `int (1-cos t)^2 sin t dt` 的结果是 `cos t` 的多项式,
	周期是 `2pi`, 所以这一项在 `[0, 2pi]` 上的积分等于零.
	<span class="formula">
		原式 `= int_0^(2pi) (1-cos t)^2 t dt`
		`= int_0^(2pi) (2 sin^2{:t/2:})^2 t dt`
		`= 16 int_0^pi u sin^4 u "d" u`
		`= 16 int_0^pi (pi-u) sin^4 u "d"u`
		`= 8 pi int_0^pi sin^4 u "d"u`
        `= 16 pi int_0^(pi/2) sin^4 u "d"u`
        `= 16 pi * 3/4 * 1/2 * pi/2`
		`= 3 pi^2`.
	</span>
</p>

<ol class="example">
  [来自 刀哥]
  `n` 为正整数, 证明:
  <li>`int_0^(pi/2) (sin (2n-1)x)/sin x dx = pi/2` (Dirichlet 核);</li>
  <li>`int_0^(pi/2) ((sin n x)/sin x)^2 dx = (n pi)/2` (费耶核).</li>
</ol>

<ol class="proof">
  <li>
    只需验证 `n = 1` 时结论成立, 且有
    <span class="formula">
      `int_0^(pi/2) (sin (2n+1)x - sin(2n-1)x)/sin x dx`
      `= int_0^(pi/2) 2 cos 2n x dx = 0`.
    </span>
  </li>
  <li>
    只需验证 `n = 1` 时结论成立, 且由 1. 有
    <span class="formula align">
      `int_0^(pi/2) (sin^2 (n+1) x - sin^2 n x) dx/(sin^2 x)`<br/>
      `= int_0^(pi/2) (sin (n+1) x + sin n x)(sin (n+1) x - sin n x) dx/(sin^2 x)`<br/>
      `= 4 int_0^(pi/2) sin(n+1/2)x cos{:x/2:} cos(n+1/2)x sin{:x/2:} dx/(sin^2 x)`<br/>
      `= int_0^(pi/2) (sin(2n+1)x)/sin x dx = pi/2`.<br/>
    </span>
  </li>
</ol>

<p class="proof">
  1. 的又一证明: 由
  <span class="formula">
    `2 sin x sum_(k=1)^n cos 2k x = sin(2n+1)x - sin x`
  </span>
  知,
  <span class="formula">
    `(sin(2n+1)x)/sin x = 1 + 2 sum_(k=1)^n cos 2k x`.
  </span>
  因此积分为 `pi/2`.
</p>

<p class="example">
  [来自 暗恋你的高中生]
  `int_0^1 f(2x sqrt(1-x^2)) dx = int_0^1 f(1-x^2) dx`.
</p>

<p class="proof">
  左边等于
  <span class="formula">
    `int_0^(pi/2) f(sin 2x) cos x dx`
    `= int_0^(pi/4) + int_(pi/4)^(pi/2)`
    `= int_0^(pi/4) f(sin 2x) (sin x+cos x) dx`
    `= int_0^(pi/4) f(1 - (sin x - cos x)^2) "d"(sin x - cos x)`
  </span>
  等于右边.
</p>

<p class="example">
  `int_0^1 ln (1-x) dx`.
</p>

<p class="solution">
  如果直接分部积分:
  <span class="formula">
    `int_0^1 ln(1-x) dx`
    `= {:x ln (1-x)|_0^1 + int_0^1 (x dx)/(1-x)`
    `= -oo + (+oo)`,
  </span>
  得不到任何信息!
</p>

<p class="solution">
  先区间再现, 再分部积分, 利用 `lim_(x to 0^+) x ln x = 0`:
  <span class="formula">
    `int_0^1 ln (1-x) dx`
    `= int_0^1 ln x dx`
    `= {: x ln x|_0^1 - int_0^1 x/x dx`
    `= 0 - 1 = -1`.
  </span>
</p>

<p class="example" id="exp-pi-ln2">
  记 `p(x) = -ln|x|`,
  则以下每个积分的值均为 `pi ln 2`:
  <span class="formula">
    `int_0^pi p(sin x) dx`,
		`int_0^pi p(cos x) dx`,
    `int_0^pi p(1+-cos x) dx`,<br>
    `int_(-1)^1 (p(x))/sqrt(1-x^2) dx`,
		`int_(-pi/2)^(pi/2) x cot x dx`,
		`int_(-1)^1 (arcsin x)/x dx`.
  </span>
</p>

<ol class="solution">
	<li>`x to 0` 时 `ln sin x ~ ln x`,
		由 `int_0^(pi/2) |ln x| dx` 收敛知, 瑕积分
    <span class="formula">
      `I = int_0^(pi/2) ln sin x dx` `= int_0^(pi/2) ln cos x dx`
    </span>
    在 `0` 处收敛.  注意到 `[0, pi]` 是 `sin x` 的对称区间, 有
		<span class="formula">
			`2I`
      `= int_0^pi ln sin x dx`
      `= int_0^(pi/2) ln sin 2x "d"(2x)`
      `= 2 int_0^(pi/2) (ln 2 + ln sin x + ln cos x) dx`
      `= pi ln 2 + 4 I`,
		</span>
		故 `-2I = pi ln 2`.
	</li>
  <li>只证加号的情形:
    <span class="formula">
      `int_0^pi ln(1+cos x) dx`
      `= int_0^pi ln(2 cos^2{:x/2:}) dx`
      `= pi ln 2 + 2 int_0^pi ln cos{:x/2:} dx`
      `= pi ln 2 + 4 int_0^(pi/2) ln cos x dx`
      `= - pi ln 2`.
    </span>
  </li>
	<li>直接令 `t = sin x` 有:
		<span class="formula">
			`int_0^(pi/2) ln sin x dx = int_0^1 (ln t)/sqrt(1-t^2)`.
		</span>
		另一方面, 若先分部积分,
		<span class="formula">
			`int_0^(pi/2) ln sin x dx = - int_0^(pi/2) x cot x dx`,
		</span>
		这时令 `t = sin x`, 有:
		<span class="formula">
			`int_0^(pi/2) x cot x dx = int_0^1 (arcsin t)/t dt`.
		</span>
	</li>
</ol>

<p class="example">
  [来自 我是萌萌的數心]
  求 `I(m, n) = int_0^(pi/2) cos^m x cos n x dx`, `m, n` 为非负整数.
</p>

<p class="solution">
  先证 `I(m, n) = m/(m+n) I(m-1, n-1)`. 这是因为由积化和差
  <span class="formula">
    `2 I(m, n) = I(m-1, n-1) + I(m-1, n+1)`,
  </span>
  另一方面, 分部积分得
  <span class="formula">
    `I(m, n) = m/n int_0^(pi/2) cos^(m-1) x sin x sin n x dx`
    `= m/(2n) (I(m-1, n-1) - I(m-1, n+1))`.
  </span>
  两式联立消去 `I(m-1, n+1)` 得 `I(m, n) = m/(m+n) I(m-1, n-1)`.<br>
  下证
  <span class="formula">
    `I(m, m + 2n + 1) = (-1)^n (2^m m! (2n)! (m+n)!)/(n! (2m+2n+1)!)`.
  </span>
  这只需验证 `I(0, 2n+1) = (-1)^n/(2n+1)`, 假设命题对 `m-1` 成立, 则
  <span class="formula">
    `I(m, m+2n+1)`
    `m/(2m+2n+1) I(m-1, m+2n)`
    `= m/(2m+2n+1) (-1)^n (2^(m-1) (m-1)! (2n)! (m+n-1)!)/(n! (2m+2n-1)!)`
    `= (-1)^n (2^m m! (2n)! (m+n)!)/(n! (2m+2n+1)!)`.
  </span>
  最后, 因为 `I(0, 2n) = {pi/2, if n = 0; 0, otherwise:}`,
  所以 `I(m, m+2n) = { pi/2^(m+1), if n = 0; 0, otherwise :}`.
</p>

<p class="example">
  [来自 我是萌萌的數心] 求`I_n = int_(-oo)^oo  dx/(x^2+2ax+b)^n`, 其中 `Delta = 4(a^2-b) lt 0`.
</p>

<p class="solution">
  令 `x+a = sqrt(b-a^2) tan u`,
  <span class="formula align">
    `I_n = int_(-pi/2)^(pi/2) sqrt(b-a^2)/cos^2 u ("d"u)/((b-a^2)^n(1+tan^2 u)^n)`<br>
    `= (b-a^2)^(1/2-n) int_(-pi/2)^(pi/2) cos^(2n-2) u "d"u`<br>
    `= (b-a^2)^(1/2-n) pi ((2n-3)!!)/((2n-2)!!)`<br>
    `= (b-a^2)^(1/2-n) pi ((2n-2)!)/({:(n-1)!:}^2 2^(2n-2))`<br>
    `= (b-a^2)^(1/2-n) pi/2^(2n-2) (2n-2;n-1)`.
  </span>
</p>

<p class="example">
  [来自 (Almost) Impossible Integrals, Sums, and Series]
  <span class="formula">
    `int_0^(pi//2) dx/(1 + sin x cos y) = y/(sin y)`, `quad y in (0, pi)`.
  </span>
</p>

<div class="p proof">
  记 `u = cos y`, 利用万能代换, 原式等于
  <span class="formula">
    `int_0^1 (2 dt)/(1 + t^2 + 2 t u)`
    `= 2 int_0^1 dt/((t+u)^2 + 1 - u^2)`
    `= 2/sqrt(1-u^2) arctan((t+u)/sqrt(1-u^2)) |_(t=0)^1`
    `= (arccos u)/sqrt(1-u^2)`.
  </span>
  最后一个等式由画图得到.
  <div class="img md">
    <img src="../img/7-atan2acos.png" alt="">
  </div>
</div>

<p class="example">
  <b>Poisson 积分</b>
  [来自 菲赫金哥尔茨]
  `I(r) = int_0^pi ln(1+r^2 - 2 r cos x) dx`.
</p>

<p class="solution">
  `r != 1` 时, 被积函数连续, 积分存在.
  利用定积分定义,
  <span class="formula">
    `I(r) = lim_(n to oo) pi/n sum_(k=1)^n ln (1+r^2 - 2 r cos{:(k pi)/n:})`
    `= lim_(n to oo) pi/n ln prod_(k=1)^n (r-"e"^(k pi "i"//n))(r-"e"^(-k
    pi "i"//n))`
    `= lim_(n to oo) pi/n ln[(r+1)/(r-1) prod_(k=1)^(2n) (r-"e"^(k pi
    "i"//n))]`
    `= lim_(n to oo) pi/n ln[(r+1)/(r-1) (r^(2n)-1)]`.
  </span>
  若 `|r| lt 1`, 上式 `to 0`; 若 `|r| gt 1`, 上式化为
  <span class="formula">
    `lim_(n to oo) pi/n ln[(r+1)/(r-1) (r^(2n)-1)/r^(2n)] + pi/n * 2n * ln |r|`
    `= 2 pi ln |r|`.
  </span>
</p>

<p class="solution">
  应用区间再现知 `I(-r) = I(r)`. 于是
  <span class="formula">
    `I(r) = 1/2(I(r) + I(-r)`
    `= 1/2 int_0^pi ln (1+r^2+2r cos x)(1+r^2-2r cos x) dx`
    `= 1/2 int_0^pi ln ((1+r^2)^2 - 4r^2 cos^2 x) dx`
    `= 1/2 int_0^pi ln (1+r^4 - 2 r^2 cos 2x) dx`
    `= 1/2 I(r^2)`.
  </span>
  由
  <span class="formula">
    `(1-|r|)^2 le 1 + r^2 - 2 r cos x le (1+|r|)^2`
  </span>
  两边取对数再积分得
  <span class="formula">
    `2 pi ln(1-|r|) le I(r) le 2 pi ln(1+|r|)`,
  </span>
  因此 `lim_(r to 0) I(r) = 0`.
  现在若 `|r| lt 1`, 则 `I(r) = I(r^(2^n))//2^n`, 令 `n to oo` 而得到
  `0`; 若 `|r| gt 1`, 则
  <span class="formula">
    `I(r) = int_0^pi[ ln(1+1/r^2 - 2/r cos x) + 2 ln |r| ]dx`
    `= I(1/r) + 2 pi ln |r|`
    `= 2 pi ln |r|`.
  </span>
</p>

<h2>定积分的极限</h2>

<p class="example">
  <b>用级数估计积分</b>
  [来自群友 群句号、刀哥]<br/>
  求极限 `lim_(n to oo) int_pi^(2pi) |sin n x + cos n x|/x dx`.
</p>

<p class="solution">
  极限符号下的式子等于
  <span class="formula">
    `int_pi^(2pi) |sqrt 2 sin(n x+pi/4)|/x dx`
    `= sqrt 2 int_(n pi)^(2n pi) |sin(x + pi/4)|/x dx`
    `= sqrt 2 sum_(n le k lt 2n) int_(k pi)^((k+1)pi) |sin(x + pi/4)|/x dx`.
    <span class="label">`(**)`</span>
  </span>
  利用不等式
  <span class="formula">
    `1/((k+1)pi) int_(k pi)^((k+1)pi) f(x) dx`
    `le int_(k pi)^((k+1)pi) f(x)/x dx`
    `le 1/(k pi) int_(k pi)^((k+1)pi) f(x) dx`,
  </span>
  以及 `int_(k pi)^((k+1)pi) |sin(x+pi/4)| dx = 2`, 得
  <span class="formula">
    `(2sqrt 2)/pi sum_(n le k lt 2n) 1/(k+1)`
    `le (**)`
    `le (2sqrt 2)/pi sum_(n le k lt 2n) 1/k`.
  </span>
  令 `n to oo`, 应用两边夹得到原式等于 `(2sqrt 2)/pi ln 2`.
</p>

<p class="example">
  <b>周期函数的平均值</b>
  设 `f` 周期为 `T`, 在 `[0, T]` 上可积, 则
  <span class="formula">
    `lim_(x to +oo) 1/x int_0^x f(t) dt = 1/T int_0^T f(t) dt`.
  </span>
  等号右边称为这个周期函数的<b>平均值</b>.
  例如有 `lim_(x to +oo) 1/x int_0^x |sin t| dt = 2/pi`.
  注意洛必达法则对这个极限失效.
</p>

<p class="proof">
  记 `I = int_0^T f(t) dt`, `x = n T + y` (`y lt T`), 则
  <span class="formula">
    `1/x int_0^x f(t) dt`
    `= (n I + int_0^y f(t)dt)/(n T + y)`.
  </span>
  `int_0^y f(t) dt` 和 `y` 均为有界量, 当 `n to oo` 时上式趋于 `I//T`.
</p>

<script src="../../js/note.js?type=math"></script>
</body>
</html>
