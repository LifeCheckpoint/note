<!DOCTYPE html>
<html lang="zh-cn">

<head>

<title>定积分</title>
<meta charset="utf-8" />

<link rel="stylesheet" type="text/css" href="../css/note.css" />

</head>

<body>

<h2>实用的定积分公式</h2>

<ul>
	设下面的各个 `f` 在积分区间上有定义且可积.
	<li>反向积分. 作变元替换 `x = a+b-t`, 有
		<span class="formula">
			`int_a^b f(x) dx = int_a^b f(a+b-t) dt`.
		</span>
		这个公式的一个推论是, 对任意使得 `f(sin x), f(cos x)` 可积的函数
		`f`,
		<span class="formula">
			`int_0^(pi/2) f(sin x) dx = int_0^(pi/2) f(cos x) dx`.
		</span>
	</li>
	<li>如果 `f` 有对称轴 `x = u`, 即 `f(x) = f(2u-x)`,
		那么
		<span class="formula">
			`int_(u-a)^u f(x) dx = int_u^(u+a) f(x) dx`.
		</span>
		特别若 `f` 是偶函数, 则
		<span class="formula">
			`int_(-a)^a f(x) dx = 2 int_0^a f(x) dx`.
		</span>
		如果 `f` 关于 `x = (a+b)//2` 对称, 利用反向积分有
		<span class="formula">
			`int_a^b x f(x) dx`
			`= int_a^b (a+b-x) f(x) dx`
			`= (a+b)/2 int_a^b f(x) dx`.
		</span>
		例如
		<span class="formula">
			`int_0^pi x f(sin x) dx = pi/2 int_0^pi f(sin x) dx`.
		</span>
	</li>
	<li>如果 `f` 有对称中心 `(u, v)`, 即 `f(x) = 2v - f(2u-x)`,
		那么
		<span class="formula">
			`int_(u-a)^u f(x) dx + int_u^(u+a) f(x) dx = 2va`.
		</span>
		特别若 `f` 是奇函数, 则
		<span class="formula">
			`int_(-a)^a f(x) dx = 0`.
		</span>
	</li>
	<li>如果 `f` 是以 `T` 为周期的周期函数, 则对任意常数 `a`,
		<span class="formula">
			`int_a^(a+T) f(x) dx = int_0^T f(x) dx`.
		</span>
		且 `int_a^x f(t) dt` 以 `T` 为周期当且仅当 `int_0^T f(t) dt = 0`.
	</li>
</ul>

<ol class="proof">
	<li></li>
	<li></li>
	<li></li>
	<li>结论一: 由周期性,
		<span class="formula">
			`int_T^(a+T) f(x) dx`
			`= int_0^a f(y+T) dy`
			`= int_0^a f(y) dy`.
		</span>
		因此
		<span class="formula">
			`int_a^(a+T) = int_a^0 + int_0^T + int_T^(a+T)`
			`= int_a^0 + int_0^T + int_0^a`
			`= int_0^T`.
		</span>
		事实上, 若 `f` 连续, 则
		<span class="formula">
			`"d"/("d"a) int_a^(a+T) f(x) dx`
			`= f(a+T) - f(a) = 0`,
		</span>
		这说明 `int_a^(a+T) f(x) dx` 与 `a` 的取值无关.
		下证结论二.
		<span class="formula">
			`int_a^(x+T) f(t) dt = int_a^x f(t) dt`
			`iff int_x^(x+T) f(t) dt = 0`
			`iff int_0^T f(t) dt = 0`.
		</span>
	</li>
</ol>

<h2>杂例</h2>

<ol class="example">
	<li>`I_1 = int dx / sqrt((a+x)(b-x))`;</li>
	<li>`I_2 = int_h^(R sin phi)
			arccos{: (x cot phi) / sqrt(R^2-x^2) :} dx`,
		`0 lt h lt R sin phi`, `phi in [0, pi/2)`;
	</li>
	<li>`I_3 = int sqrt((a^2x-b^2) / (1-x)) dx/x`;</li>
	<li>`I_4 = int_(h_1)^(r_2) arccos{: (h_2)/sqrt(R^2-x^2) :} dx`,
		其中 `R = sqrt(h_1^2 + r_1^2) = sqrt(h_2^2 + r_2^2)`.
	</li>
</ol>

<ol class="solution">
	<li>令 `t = sqrt((a+x)/(b-x))`,
		则 `x = (bt^2-a) / (1+t^2)`,
		`dx = (2(a+b)t) / (1+t^2)^2 dt`.  于是
		<span class="formula">
			`I_1 = int (2(a+b)t dt)/( t|b-(bt^2-a)/(1+t^2)| (1+t^2)^2 )`
			`= 2 sgn(a+b) int dt / (1+t^2)`
			`= 2 sgn(a+b) * arctan sqrt((a+x)/(b-x)) + C`.
		</span>
	</li>
	<li>令 `u = (x cot phi) / sqrt(R^2-x^2)`,
		则 `x = (Ru) / sqrt(u^2 + cot^2 phi)`.
		记 `r = sqrt(R^2 - h^2)`, 于是
		<span class="formula">
			`I_2 = [(Ru arccos u)/sqrt(u^2+cot^2 phi)]_((h cot phi)//r)^1
			+ R/2 int_((h cot phi)//r)^1 ("d"(u^2))
			/ sqrt( (cot^2 phi + u^2)(1-u^2) )`.
		</span>
		由 1,
		<span class="formula">
			`I_2 = -h arccos{: (h cot phi)/r :}
				+ R[ arctan sqrt((cot^2 phi + u^2) / (1-u^2)) ]
				_((h cot phi)//r)^1`
			`= - h arccos{: (h cot phi)/r :}
				+ R(pi/2-arctan{:(R cot phi) / sqrt(r^2-h^2 cot^2 phi):})`
			`= R arccos{: (R cos phi)/r :} - h arccos{: (h cot phi)/r :}`.
		</span>
	</li>
	<li>令 `t = sqrt((a^2x-b^2)/(1-x))`,
		则 `x = (b^2+t^2)/(a^2+t^2)`,
		`dx = (2t(a^2-b^2)) / (a^2+t^2)^2 dt`.  于是
		<span class="formula">
			`I_3 = int t * (a^2+t^2) / (b^2+t^2)
				* (2t(a^2-b^2)) / (a^2+t^2)^2 dt`
			`= 2 int ( a^2/(a^2 + t^2) - b^2 / (b^2 + t^2) ) dt`
			`= 2 ( a arctan{:t/a:} - b arctan{:t/b:} ) + C`.
		</span>
		再将 `t` 代回, 即得最终结果.
	</li>
	<li>令 `u = h_2/sqrt(R^2-x^2)`,
		则 `x = sqrt( R^2 - (h_2/u)^2 )`.  于是
		<span class="formula">
			`I_4 = [ sqrt( R^2 - (h_2/u)^2 ) arccos u ]_(h_2//r_1)^1
				+ int_(h_2//r_1)^1 sqrt( R^2 - (h_2/u)^2 )
				("d"u) / sqrt(1-u^2)`
			`=	- h_1 arccos {:h_2/r_1:}
				+ 1/2 int_(h_2//r_1)^1 sqrt( (R^2u^2 - h_2^2) / (1-u^2) )
				( "d"(u^2) ) / u^2`.
		</span>
		由 3 知, 上式第二项等于
		<span class="formula">
			`[R arctan{:1/R:} sqrt((R^2u^2 - h_2^2)/(1-u^2))
				- h_2 arctan{:1/h_2:}
				sqrt((R^2u^2 - h_2^2)/(1-u^2)) ]_(h_2//r_1)^1`
			`= pi/2 (R-h_2)
				- (R arctan{:(h_1 h_2)/(R sqrt(r_1^2 - h_2^2)):}
				- h_2 arctan{:h_1/sqrt(r_1^2 - h_2^2):} )`
			`= R arccos{:(h_1 h_2)/(r_1 r_2):} - h_2 arccos{:h_1/r_2:}`.
		</span>
		故
		<span class="formula">
			` I_4 = R arccos{:(h_1 h_2)/(r_1 r_2):}
			- h_1 arccos{:h_2/r_1:}
			- h_2 arccos{:h_1/r_2:}`.
		</span>
	</li>
</ol>

<p class="example">
	`int_0^(2pi) (1-cos t)^2 (t-sin t) dt`.
</p>

<p class="solution">
	因为不定积分 `int (1-cos t)^2 sin t dt` 的结果是 `cos t` 的多项式,
	周期是 `2pi`, 所以这一项在 `[0, 2pi]` 上的积分等于零.
	<span class="formula">
		原式 `= int_0^(2pi) (1-cos t)^2 t dt`
		`= int_0^(2pi) (2 sin^2{:t/2:})^2 t dt`
		`= 16 int_0^pi u sin^4 u "d" u`
		`= 16 int_0^pi (pi-u) sin^4 u "d"u`
		`= 8 pi int_0^pi sin^4 u "d"u`
		`= pi int_0^pi (3 - 4 cos 2u + cos 4 u) "d"u`
		`= 3 pi^2`.
	</span>
</p>

<h2>积分余项的 Taylor 公式</h2>

<p class="theorem">
	设 `R_n(x) = 1/(n!) int_(x_0)^x (x-t)^n f^((n+1))(t) dt`.
	分部积分,
	<span class="formula">
		`R_n(x) = 1/(n!) [(x-t)^n f^((n))(t)]_(x_0)^x`
		`+ 1/((n-1)!) int_(x_0)^x (x-t)^(n-1) f^((n))(t) dt`
		`= - (f^((n))(x_0))/(n!) (x-x_0)^n + R_(n-1)(x)`.
	</span>
	于是
	<span class="formula">
		`f(x) - f(x_0) = R_0(x)`
		`= sum_(k=1)^n (R_(k-1)(x) - R_k(x)) + R_n(x)`
		`= sum_(k=1)^n (f^((k))(x_0))/(k!) (x-x_0)^k + R_n(x)`.
	</span>
</p>

<h2>含参积分</h2>

<ol class="example">
	<li>`int_0^1 (ln(1+x))/(1+x^2) dx`;</li>
	<li>`int_(-oo)^oo "e"^(-x^2)/(1+x^2) dx`;</li>
</ol>

<ol class="solution">
	<li>令 `I(s) = int_0^1 (ln(1+s x))/(1+x^2) dx`, 积分号下求导,
		<span class="formula">
			`I(1) = int_0^1 I'(s) "d"s`
			`= int_0^1 (int_0^1 x/(1+x^2) dx/(1+s x) dx) "d"s`
			`= int_0^1 ((ln 2)/2 1/(1+s^2) + pi/4 s/(1+s^2)
			- (ln(1+s))/(1+s^2) ) "d"s`
			`= pi/4 ln 2 - I(1)`.
		</span>
		所以 `I(1) = pi/8 ln 2`.
	</li>
	<li>令 `I(s) = int_0^oo "e"^(-s x^2)/(1+x^2) dx`, 积分号下求导,
		<span class="formula">
			`I'(s) = int_0^oo (-x^2 "e"^(-s x^2))/(1+x^2) dx`
			`= I(s) - int_0^oo "e"^(-s x^2) dx`
			`= I(s) - 1/2 sqrt(pi/s)`.
		</span>
		上述常微分方程通解为 `I(s) = sqrt pi "e"^s int_s^c "e"^(-y^2) dy`.
		代入 `I(0) = pi/2` 知 `c = +oo`. 因此 `I(1) = sqrt pi "e"
		int_1^oo "e"^(-y^2) dy`, 原式等于
		<span class="formula">
			`2 I(1) = pi "e" 2/sqrt pi int_1^oo "e"^(-y^2) dy`
			`= pi "e"\ "erfc"(1)`.
		</span>
	</li>
</ol>

<script src="../js/note.js?type=math"></script>

</body>

</html>
