<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8" />
    <title>椭圆函数</title>
    <link rel="stylesheet" type="text/css" href="../../css/note.css" />
</head>
<body>

<h2>Jacobi 椭圆函数</h2>

[<a href="https://zhuanlan.zhihu.com/p/130428825">原文来自知乎</a>]

<p class="proposition">
	<b>第一类完全椭圆积分</b>
	<span class="formula">
		`K(z) := int_0^(pi/2) ("d"theta)/sqrt(1-z^2 cos^2 theta)`
		`= int_0^(pi/2) ("d"varphi)/sqrt(1+z^2-2z cos 2 varphi)`,
		`quad "Re"(z) lt 1`.
	</span>
</p>

<p class="proof">
	令 `t = cos theta`, 左边等于
	<span class="formula">
		`int_0^1 dt/(sqrt(1-t^2) sqrt(1-z^2 t^2)`,
	</span>
	设 `k' = (1-z)/(1+z) = sqrt(1 - k^2)`, 有
	<span class="formula">`{:
		,1 + z^2 - 2 z cos 2 varphi;
		=, (1+z)^2 - 2 z(1 + cos 2 varphi);
		=, (1+z)^2 (1 - (4 z)/(1+z)^2 cos^2 varphi);
		=, (1+z)^2 [1 - (1 - (1-z)^2/(1+z)^2) cos^2 varphi];
		=, (1+z)^2 (1 - k^2 cos^2 varphi).
	:}` </span>
	令 `s = cos varphi`, 则右边等于
	<span class="formula">
		`1/(1+z) int_0^1 ("d"s)/(sqrt(1-s^2) sqrt(1-k^2 s^2))`.
	</span>
	下面来证 `K(k) = (1+z) K(z)`.  利用朗登型变换
	<span class="formula">
		`t = (1+k') (s sqrt(1-s^2))/sqrt(1-k^2 s^2)`,
	</span>
	求微分,
	<span class="formula">
		`dt = (1+k')/sqrt(1-s^2)
		(1-2s^2 + k^2 s^4)/(1-k^2 s^2)^(3//2) "d"s`,
	</span>
	又
	<span class="formula">
		`1-k^2 s^2 - (1+-k')^2 s^2 (1-s^2)`
		`= 1 - k^2 s^2 + (s^4 - s^2) (1 + k'^2 +- 2 k')`
		`= 1 - 2(1+-k') s^2 + (1+-k')^2 s^4`
		`= [1 - (1+-k') s^2]^2`,
	</span>
	有
	<span class="formula">
		`sqrt(1-t^2) = (1 - (1+k') s^2)/sqrt(1-k^2 s^2)`,
		`quad sqrt(1-z^2 t^2) = (1 - (1-k') s^2)/sqrt(1-k^2 s^2)`.
	</span>
	当 `t = 0` 时, 相应的 `s = 0` 或 `1`;
	当 `t = 1` 时, 解二次方程知, 相应的 `s = 1/sqrt(1+k')`. 于是
	<span class="formula">
		`int_0^1 dt/(sqrt(1-t^2) sqrt(1-z^2 t^2))`
		`= (1+k') int_0^(1//sqrt(1+k')) ("d"s)/(sqrt(1-s^2) sqrt(1-k^2 s^2))`
		`= (1+k') int_(1//sqrt(1+k'))^1 ("d"s)/(sqrt(1-s^2) sqrt(1-k^2 s^2))`
		`= (1+k')/2 int_0^1 ("d"s)/(sqrt(1-s^2) sqrt(1-k^2 s^2))`
		`= 1/(1+z) int_0^1 ("d"s)/(sqrt(1-s^2) sqrt(1-k^2 s^2))`.
	</span>
</p>

<p class="proposition">
	<b>Euler 变换</b>
	<span class="formula">
		`K("i"x) = 1/sqrt(1+x^2) K(sqrt(x^2/(1+x^2)))`.
	</span>
</p>

<p class="proof">
	利用 `K(z)` 的第一形式,
	<span class="formula">
		`K("i"x) = int_0^(pi/2) ("d"theta)/sqrt(1+x^2 cos^2 theta)`,<br/>
		`1/sqrt(1+x^2) K(sqrt(x^2/(1+x^2)))`
		`1/sqrt(1+x^2) int_0^(pi/2) ("d"theta)/sqrt(1-x^2/(1+x^2) cos^2
		theta)`
		`= int_0^(pi/2) ("d"theta)/sqrt(1+x^2-x^2 cos^2 theta)`
		`= int_0^(pi/2) ("d"theta)/sqrt(1+x^2 sin^2 theta)`.
	</span>
	因此左右两边相等.
</p>

<p class="proposition">
	椭圆积分
	<span class="formula">
		`M(a, b)
		:= int_0^(pi/2)("d"theta)/sqrt(a^2 cos^2 theta+b^2 sin^2 theta)`
		`= int_0^(pi/2)("d"theta)/sqrt(a^2 sin^2 theta+b^2 cos^2 theta)`.
	</span>
	则
	<span class="formula">
		`M((a+b)/2, sqrt(a b)) = 2/(a+b) K((a-b)/(a+b)) = M(a, b)`.
	</span>
</p>

<p class="proof">
	首先
	<span class="formula">
		`a^2 cos^2 theta + b^2 sin^2 theta`
		`= b^2 + (a^2-b^2) cos^2 theta`,
	</span>
	故
	<span class="formula">
		`((a+b)/2)^2 cos^2 theta + a b sin^2 theta`
		`= a b + ((a-b)/2)^2 cos^2 theta`.
	</span>
	利用 `K(z)` 的第一形式,
	<span class="formula">
		`M((a+b)/2, sqrt(a b))`
		`= int_0^(pi/2) ("d"theta)/sqrt(a b + ((a-b)/2)^2 cos^2 theta)`
		`= 1/sqrt(a b) K((a-b)/(2sqrt(a b)) "i")`.
	</span>
	因为
	<span class="formula">
		`1 + ((a-b)/2)^2 1/(a b)`
		`= ((a+b)/2)^2 1/(a b)`,
	</span>
	利用 Euler 变换得
	<span class="formula">
		`1/sqrt(a b) K((a-b)/(2sqrt(a b)) "i")`
		`= 2/(a+b) K((a-b)/(a+b))`.
	</span>
	这就证明了第一个等号. 接下来利用 `K(z)` 的第二形式,
	<span class="formula">
		`2/(a+b) K((a-b)/(a+b))`
		`= 1/(a+b) int_0^pi [1 + ((a-b)/(a+b))^2 - 2(a-b)/(a+b) cos
		theta]^(-1/2) "d"theta`
		`= int_0^pi [(a+b)^2 + (a-b)^2 - 2(a-b)(a+b) cos theta]^(-1/2)
		"d"theta`
		`= int_0^pi [a^2(1-cos theta) + b^2(1+cos theta)]^(-1/2) ("d"theta)/sqrt 2`
		`= int_0^pi (a^2 sin^2{:theta/2:} + b^2 cos^2{:theta/2:})^(-1/2)
		("d"theta)/2`
		`= M(a, b)`.
	</span>
	这就证明了第二个等号.
</p>

<p class="theorem">
	<b>(Gauss, 1799)</b>
	设数列 `{a_n}`, `{b_n}` 满足: `0 lt b_0 lt a_0`, 且
	<span class="formula">
		`a_(n+1) = (a_n + b_n)/2`, `quad b_(n+1) = sqrt(a_n b_n)`,
		`quad n ge 0`,
	</span>
	则两数列收敛到同一极限. 此极限称为
	`a_0` 与 `b_0` 的<b>算术几何平均值</b> `AGM(a_0, b_0)`, 我们有
	<span class="formula">
		`AGM(a_0, b_0) M(a_0, b_0) = pi/2`.
	</span>
</p>

<ol class="proof">
	<li>先证极限存在.
		由均值不等式,
		<span class="formula">
			`b_n lt sqrt(a_n b_n) lt (a_n+b_n)/2 lt a_n`,
		</span>
		故 `{[b_n, a_n]}` 形成一组闭区间套, 且
		<span class="formula">
			`|a_(n+1) - b_(n+1)| lt 1/2|a_n - b_n|`.
		</span>
		因此闭区间套的长度趋于零. 由闭区间套定理知, 两数列的极限为
		<span class="formula">
			`A = nnn_n [b_n, a_n]`.
		</span>
	</li>
	<li>注意椭圆积分 `M(a, b)` 的值在此数列的迭代下保持不变, 有
		<span class="formula">
			`M(a_0, b_0) = M(a_1, b_1) = cdots = M(A, A) = pi/(2 A)`.
		</span>
	</li>
</ol>

<p class="proposition">
	<b>Gauss 常数</b>
	<span class="formula">
		`G = AGM(1, sqrt 2)^-1 = (Gamma^2(1/4))/(2pi)^(3/2)`.
	</span>
</p>

<p class="proposition">
	`K(z) = pi/2 sum_(n ge 0) [((2n-1)!!)/((2n)!!) z^n]^2`.
</p>

<script src="../../js/note.js?type=math"></script>
</body>
</html>
